<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="generator" content="WordPress 2.7" /> <!-- leave this for stats -->

<link rel="stylesheet" href="http://blog.codahale.com/wp-content/themes/justacog/style.css" type="text/css" media="screen" />
<link rel="alternate" type="application/rss+xml" title="codahale.com | Feed" href="http://blog.codahale.com/feed/" />

<link rel="openid.server" href="http://openid.claimid.com/server" />
<link rel="openid.delegate" href="http://openid.claimid.com/codahale" />

<title>Time For A Grown-Up Server: Rails, Mongrel, Apache, Capistrano and You | Archives | codablog | Coda Hale</title>

<link rel="pingback" href="http://blog.codahale.com/xmlrpc.php" />

<link rel="shortcut icon" href="http://blog.codahale.com/favicon.ico" />
<link rel="icon" href="http://blog.codahale.com/favicon.ico" />

<style type="text/css" media="screen">
	body { background: url("http://blog.codahale.com/wp-content/themes/justacog/images/background-cogs.jpg") no-repeat top left; }
  blockquote { background: #E6E9DC url("http://blog.codahale.com/wp-content/themes/justacog/images/blockquote.png") no-repeat 5px top; }
	a.post-comments { background: url("http://blog.codahale.com/wp-content/themes/justacog/images/comments.gif") no-repeat; display: inline; padding-left: 25px;	}
	div.sideitem ul li {	list-style-image: url("http://blog.codahale.com/wp-content/themes/justacog/images/arrow.png"); }
	div.sideitem ul.categories li { list-style-image: url("http://blog.codahale.com/wp-content/themes/justacog/images/post.png"); }
	div.sideitem ul.archives li { list-style-image: url("http://blog.codahale.com/wp-content/themes/justacog/images/archive.png"); }
	div.sideitem ul.comments li { list-style-image: url("http://blog.codahale.com/wp-content/themes/justacog/images/comment.png"); }
	div.sideitem ul.posts li {	list-style-image: url("http://blog.codahale.com/wp-content/themes/justacog/images/post.png"); }
	div.sideitem ul.categories li { list-style-image: url("http://blog.codahale.com/wp-content/themes/justacog/images/category.png"); }
  div.sideitem ul.links li { list-style-image: url("http://blog.codahale.com/wp-content/themes/justacog/images/link.png"); }
  div.sideitem ul.pages li { list-style-image: url("http://blog.codahale.com/wp-content/themes/justacog/images/page.png"); }
  
  #goals-list { width: 150px; }
  #goals-list h3 { margin-top: 5px; margin-left: 5px; }
  #goals { list-style: none; padding-left: 0; }
  #goals li { text-align: center; padding-left: 0; list-style-image: none; }
  #goals li a { border-bottom: none; }
  #wesabe-link { font-size: 80%; }
</style>

<script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-248257-1";
urchinTracker();
</script>

	<link rel='archives' title='July 2008' href='http://blog.codahale.com/2008/07/' />
	<link rel='archives' title='December 2007' href='http://blog.codahale.com/2007/12/' />
	<link rel='archives' title='July 2007' href='http://blog.codahale.com/2007/07/' />
	<link rel='archives' title='June 2007' href='http://blog.codahale.com/2007/06/' />
	<link rel='archives' title='May 2007' href='http://blog.codahale.com/2007/05/' />
	<link rel='archives' title='April 2007' href='http://blog.codahale.com/2007/04/' />
	<link rel='archives' title='March 2007' href='http://blog.codahale.com/2007/03/' />
	<link rel='archives' title='February 2007' href='http://blog.codahale.com/2007/02/' />
	<link rel='archives' title='January 2007' href='http://blog.codahale.com/2007/01/' />
	<link rel='archives' title='December 2006' href='http://blog.codahale.com/2006/12/' />
	<link rel='archives' title='November 2006' href='http://blog.codahale.com/2006/11/' />
	<link rel='archives' title='August 2006' href='http://blog.codahale.com/2006/08/' />
	<link rel='archives' title='July 2006' href='http://blog.codahale.com/2006/07/' />
	<link rel='archives' title='June 2006' href='http://blog.codahale.com/2006/06/' />
	<link rel='archives' title='May 2006' href='http://blog.codahale.com/2006/05/' />
	<link rel='archives' title='April 2006' href='http://blog.codahale.com/2006/04/' />
	<link rel='archives' title='March 2006' href='http://blog.codahale.com/2006/03/' />
	<link rel='archives' title='February 2006' href='http://blog.codahale.com/2006/02/' />
	<link rel='archives' title='January 2006' href='http://blog.codahale.com/2006/01/' />
	<link rel='archives' title='December 2005' href='http://blog.codahale.com/2005/12/' />
	<link rel='archives' title='November 2005' href='http://blog.codahale.com/2005/11/' />
	<link rel='archives' title='October 2005' href='http://blog.codahale.com/2005/10/' />
	<link rel='archives' title='September 2005' href='http://blog.codahale.com/2005/09/' />
<link rel='stylesheet' href='http://blog.codahale.com/wp-content/plugins/defensio-anti-spam/styles/defensio_2.7.css?ver=2.7' type='text/css' media='' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://blog.codahale.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://blog.codahale.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 2.7" />

<script src='http://www.codahale.com/mint/?js' type='text/javascript' language='javascript'></script>

</head>
<body>
<!-- ukey="75092103" -->
	<h1 id="title"><a href="http://blog.codahale.com"><span class="titlefirst">coda</span><span class="titlelast">hale.com</span><span class="titlediddle">&#1645;</span><span class="titlename">blog</span></a></h1>
	
<div id="description">

  This is my old blog. My current writing is here: <a href="http://codahale.com">codahale.com</a>

  </div>

	<div id="body">

      <div class="post" id="post-113">
        <div class="post-body">
          <h2 class="post-title"><a href="http://blog.codahale.com/2006/06/19/time-for-a-grown-up-server-rails-mongrel-apache-capistrano-and-you/" rel="bookmark" title="Permanent Link to Time For A Grown-Up Server: Rails, Mongrel, Apache, Capistrano and You">Time For A Grown-Up Server: Rails, Mongrel, Apache, Capistrano and You</a></h2>
          <p>More and more Rails developers are finding out that deploying a Rails application isn&#8217;t as simple as upload and rename; Rails apps work best when running all the time, and many Rails programmers are moving from traditional, shared hosts, like <a href="http://www.dreamhost.com">Dreamhost</a>, to virtual private servers, like <a href="http://www.rimuhosting.com">Rimuhosting</a>, which allow them full control (and responsibility) of production servers.</p>
<p>Given this freedom, there are now a huge number of options available for deploying a Rails application, which is rare for such a new technology. So what to use? Apache + FastCGI? Lighttpd + FastCGI? SCGI? Apache 2? Litespeed? Mongrel? In what configuration? So many questions, so few answers. Here&#8217;s what I&#8217;ve been deleriously happy with, and how to do it yourself: Mongrel, Apache 2.2, and mod_proxy_balancer, using Capistrano to keep everything at your fingertips.</p>
<h3>What the hell is Mongrel?</h3>
<p><a href="http://mongrel.rubyforge.org/">Mongrel</a> is the hot new kid on the block. It&#8217;s a hybrid Ruby/C HTTP server designed to be small, fast, and brutally secure. It&#8217;s written by Zed Shaw, who is easily one of the most <a href="http://lists.rubyonrails.org/pipermail/rails/2006-May/037763.html">entertaining</a> and <a href="http://www.oreillynet.com/ruby/blog/2006/05/post.html">delightfully</a> <a href="http://www.zedshaw.com/blog/programming/programmer_stats.html">cranky</a> <a href="http://www.zedshaw.com/blog/programming/indirection_is_not_abstraction.html">programmers</a> I&#8217;ve ever read. (Zed, if you&#8217;re ever in the Bay Area, I owe you a pint.) While it&#8217;s a general purpose library, Mongrel is shaping up to be an amazing application server for Rails.</p>
<h3>Sounds sweet. What&#8217;s Apache got to do with it?</h3>
<p>Well, horses for courses. Mongrel is awesome at being a tight little application server for Rails, but when it comes to configurability, speed serving static files, and stability, Apache 2.2 beats the pants off Mongrel. But the main reason is that Rails does not play well with concurrency, and unless your code somehow magically gets around this, it will eat flaming death if it tries to do two things at the same time. So just Mongrel by itself would be slow at serving up static content like images, CSS files, etc., and it would necessarily be limited to a single request at a time, unless the main point of your Rails application was to publicly eat flaming death. (&#8221;It&#8217;s a feature!&#8221;)</p>
<p>So we&#8217;re going to be using Apache 2.2 as the front-end for Mongrel, which allows us to both serve up static content like it&#8217;s going out of style, but also to use a huge wealth of modules, like mod_deflate, which will improve your site&#8217;s responsiveness and download time. We&#8217;ll run a cluster of Mongrel servers locally, and route requests through Apache&#8217;s mod_proxy_balancer, which uses a sophisticated algorithm to make sure all the Mongrel servers feel equally loved.</p>
<h3>Why not (Lighty|Pound|Litespeed|A Large Begonia)?</h3>
<p>Apache is the heavy-weight in the web server world, and for good reason. It&#8217;s stable, fast, extensible, free as in Beery Speech, and all sorts of enterprisey. It&#8217;s gotten a bad rap in the Rails world, though, mainly due to its patchy FastCGI performance. It&#8217;s true, Apache + FastCGI is a horrible, horrible solution, unless your problem is &#8220;how can I waste my time on a dodgy server config?&#8221; in which case you shouldn&#8217;t be using the Intarweb while drunk. Finally, Apache currently has a great proxy balancer, which is why we&#8217;re using it.</p>
<p>This is not to speak ill of other front-end web servers, and you should feel free to use whatever you&#8217;re comfortable with. This article, though, is about how to set up what I&#8217;ve got set up, because I can vouch for it being awesome. Chip in on the comments if you&#8217;ve got a Mongrel band with a different lead singer and let us know how it&#8217;s going for you.</p>
<h3>Okay, so what do I need?</h3>
<p>I&#8217;m going to assume you&#8217;ve got Apache 2.2, Ruby 1.8.4, Subversion, and whatever database backend you need installed. That all depends on your operating system. Personally, I&#8217;ve had a great experience with Fedora Core 5, but I won&#8217;t make fun of you if you use Gentoo, Ubuntu, <abbr title="Red Hat Enterprise Linux">RHEL</abbr>, Debian, FreeBSD, or whatever. Just make sure you can install and easily maintain your various pieces of software. Also, make sure you&#8217;ve got all the various low-level development tools, like a compiler or two, and the development packages for Ruby and such.</p>
<p>Your application has to be using either ActiveRecordStore, SQLSessionStore, or MemCached to keep track of session data. Files are the worst possible way to deal with sessions, and when you have more than one server reading and writing from the same file-based session store it&#8217;s gonna blow up big.</p>
<p>You should have a Capistrano script which will at least run the setup tasks correctly. If you need help with that, there are many blog articles and even a full-blown, if slightly outdated, <a href="http://manuals.rubyonrails.org/read/book/17">manual</a> on the damn thing.</p>
<p>Finally, none of this is going to work without root access (or an impossibly permissive server), and you&#8217;ll just piss off your admins if you try otherwise.</p>
<p>At this point you should have an Apache 2.2 &#8220;Welcome to Apache&#8221; style installation, and your Rails application should work just fine in WEBrick mode. If that doesn&#8217;t work, you&#8217;ve got problems which are best dealt with by tech support, IRC vets, or Friends Who Owe You Favors. If you aren&#8217;t at that stage yet, bookmark this page and get to work. I&#8217;ll wait until you&#8217;re ready.</p>
<p>Ready? Go!</p>
<h3>1. Install Mongrel &#038; Friends.</h3>
<p>Because otherwise, the rest of this how-to is just going to be super awkward:</p>
<pre><code>[server]$ sudo gem install daemons gem_plugin mongrel mongrel_cluster --include-dependencies</code></pre>
<p>This will download, compile, and install Mongrel and its dependencies, daemons, a library which allows Mongrel to curl up at your server&#8217;s feet like a good little poochy poozle, and gem_plugin, which allows folks like yourself to write gem-based, module add-ons to Mongrel. It will also install mongrel_cluster, which contains a few tools which make managing a cluster of Mongrel servers easier.</p>
<p><del datetime="2006-08-03T14:59:00+00:00">Finally, it installs sendfile. I&#8217;ve already said that Mongrel is slow for static content, and it&#8217;s true. However, it&#8217;s a smart pup (and Zed&#8217;s a smart, smart man). In a proxying configuration, Mongrel will use sendfile, if it&#8217;s installed, to send Apache a <em>reference</em> to a file instead of reading it from disk and farting it out to Apache over a local HTTP configuration. This allows Mongrel to do the heavy lifting required of man&#8217;s best friend&#8211;running your Rails application&#8211;without getting bogged down in the minutae of CSS files, images, and Javascript files. Long story short: your site is faster. <em>Many people skip installing sendfile, or don&#8217;t know about it, and because of this, they usally write Apache+Mongrel off as slow.</em> Sendfile is the secret ingredient which allows Apache+Mongrel to be blazing fast.</del></p>
<p><ins datetime="2006-08-03T14:59:00+00:00">I used to advise installing sendfile, but it doesn&#8217;t help&#8211;Apache serves the static content, so the 20%-or-so boost on static files is never seen&#8211;and it can even cause some pretty severe stability issues. So. No sendfile, and if you&#8217;ve got it installed, uninstall it, pronto. (This comes straight from Zed, who would know such things.)</ins></p>
<p>Be sure to install at least mongrel_cluster (and thus, Mongrel) on your workstation&#8211;deployment via Capistrano will be complicated, otherwise, since you&#8217;ll have to reimplement all the code they&#8217;ve thoughtfully laid out for you already.</p>
<p>At this point you&#8217;re ready to get your Mongrel configuration on.</p>
<h3>2. Mongrel: Sit! Lay! Restart!</h3>
<p>First, you need to figure out how much memory you&#8217;ve got to spare, how much traffic you&#8217;re expecting, and how much money you&#8217;re willing to expend. An average Mongrel process can use between 15MiB and 40MiB of memory, depending on what your application does, and you need to figure out how many you can stuff into your server without popping it at the seams. Right now I&#8217;m running a decently-sized application with Apache, MySQL, and a cluster of three Mongrel servers in a 128MiB virtual private server with a bit of padding on top to keep the lid on. My advice is to start with two or three and build up to it. As you&#8217;ll see later, adding more clusters is stupid-easy. For now, we&#8217;ll assume that a cluster of three will do nicely.</p>
<h4>Configuring the cluster</h4>
<p>Pop open a terminal window, amble on over to your Rails project directory on your workstation, and crank out a cluster config file:</p>
<pre><code>[workstation]$ mongrel_rails cluster::configure -e production \\
  -p 8000 \\
  -a 127.0.0.1 \\
  -N 3 \\
  -c /path/to/your/capistrano/setup's/current</code></pre>
<p>This will add a file, <tt>mongrel_cluster.yml</tt>, to your config directory, which, when run, will launch a cluster of three Mongrel servers, starting on port 8000, listening on the local interface (and not to evil meanies on the internet).</p>
<p>Before we get to using it, however, we&#8217;ll need to make one small change for testing purposes. Open up <tt>mongrel_cluster.yml</tt>, and comment out the line with <tt>address: 127.0.0.1</tt> on it (it&#8217;s YAML, so just add a hash at the beginning of the line). We&#8217;ll add this back in later, but for now we&#8217;ll want to make sure our cluster is behaving properly. Add <tt>mongrel_cluster.yml</tt> to Subversion, and check it in.</p>
<h4>Configuring Capistrano</h4>
<p>Mongrel_cluster comes with some drop-in replacements for Capistrano&#8217;s restart and spinner tasks. Open your <tt>deploy.rb</tt> and add the following to the top:</p>
<pre><code>require 'mongrel_cluster/recipes'</code></pre>
<p>Now add the following to your <tt>deploy.rb</tt> settings:</p>
<pre><code>set :mongrel_conf, "#{current_path}/config/mongrel_cluster.yml"</code></pre>
<p>Make sure you don&#8217;t have any old code in your <tt>deploy.rb</tt> obscuring the dark, shining beauty of mongrel_cluster. Also be sure you add the <tt>:mongrel_conf</tt> statement <em>after</em> setting <tt>:deploy_to</tt>. Otherwise, as Jesse Clark notes in the comments below, you&#8217;re in for some weirdness.</p>
<h4>Configuring the services</h4>
<p>Finally, we need to register your Mongrel cluster as a system-level service, which will allow us to make sure it pops back up when your server reboots.</p>
<p>First, open a terminal window in your server&#8217;s services script directory. For most of you, this will be <tt>/etc/init.d/</tt>. Link the <tt>mongrel_cluster</tt> script from the gem directory to the services directory:</p>
<pre><code>[server]$ sudo ln -s /usr/lib/ruby/gems/1.8/gems/mongrel_cluster-0.1.3/resources/mongrel_cluster mongrel_cluster
[server]$ sudo chmod +x mongrel_cluster</code></pre>
<p>Those you on Red Hat-based systems should add <tt>mongrel_cluster</tt> as a recognized service:</p>
<pre><code>[server]$ sudo /sbin/chkconfig --level 345 mongrel_cluster on</code></pre>
<p>If you&#8217;re running a Debian flavor, Ben Curtis assures me this works:</p>
<pre><code>[server]$ sudo /usr/sbin/update-rc.d mongrel_cluster defaults</code></pre>
<p>Those of you using otherwise will have to fend for yourselves. (Let me know how!)</p>
<p>Finally, link your <tt>mongrel_cluster.yml</tt> from your app&#8217;s <tt>config</tt> directory to <tt>/etc/mongrel_cluster</tt>:</p>
<pre><code>[server]$ sudo mkdir -p /etc/mongrel_cluster
[server]$ sudo ln -s /your/rails/app/config/mongrel_cluster.yml /etc/mongrel_cluster/yourapp.yml</code></pre>
<p>At this point, your server is rarin&#8217; and ready to go.</p>
<h4>Testing your cluster</h4>
<p>Well, time to deploy, eh? Almost.</p>
<p>Before you begin, make sure your server can access your Subversion repository. Capistrano unfortunately doesn&#8217;t allow you to enter a password when Subversion prompts you for one, so go to a temporary directory and check out the entirety of your application. Subversion will remember your passwords once you&#8217;ve entered them.</p>
<p>Got your server playing well with Subversion? Then you&#8217;re ready to go!</p>
<p>In a loud voice, say something profound and memorable (&#8221;That&#8217;s one small step for Rails&#8230;&#8221;), and deploy that bastard:</p>
<pre><code>[workstation]$ cap cold_deploy</code></pre>
<p>This should checkout the latest version of your code, set up all the symlinks and other fun stuff, and finally start the Mongrel cluster. If it doesn&#8217;t, try running it with <code>--trace</code> and see what&#8217;s going on. Nine times out of ten, it&#8217;s some fiddly bit you forgot about in your haste to get this thing up and running.</p>
<p>If all went well (or was fixed after you let the magic smoke out), you should have three web servers running on your server:</p>
<ul>
<li><tt>http://myserver.com:8000</tt></li>
<li><tt>http://myserver.com:8001</tt></li>
<li><tt>http://myserver.com:8002</tt></li>
</ul>
<p>Visit each one in your web browser, and make sure everything works. Fix all the problems you see until each works fine.</p>
<h4>Closing up the cluster</h4>
<p>Once everything is to your satisfaction, open <tt>config/mongrel_cluster.yml</tt> back up again, and uncomment the <tt>address: 127.0.0.1</tt> line. Save and check in your changes, and re-deploy:</p>
<pre><code>[workstation]$ cap deploy</code></pre>
<p>Everything should go smoothly. Make sure the three 800x ports on your web server are no longer accessible&#8211;the only public entrance to your web site should be through Apache!</p>
<p>Now your cluster backend is done! Congrats. Go get a beer, or whatever refreshing beverage the grown-ups let you have. Time to get to work on the front-end.</p>
<h3>3. Putting The <abbr title="What, no Superfriends fans in the house? No, there usually aren't.">Inukchuk</abbr> In Apache</h3>
<p>First, find out where your Apache config files are. If your distro isn&#8217;t a total crazy-pants, it&#8217;ll be something like <tt>/etc/httpd/</tt> or <tt>/etc/apache2</tt>. Within that directory should be <tt>conf.d</tt>, which is where all of your server-specific config files go. We&#8217;re going to take a <abbr title="Don't Repeat Yourself">DRY</abbr> approach to all this, and try to reuse as many bits of our config files as possible, to avoid the all-too-common problems associated with overlapping anything. Now, all files in the <tt>conf.d</tt> directory which end in <tt>.conf</tt> will be automatically included. Keep that in mind.</p>
<h4>Removing the cruft</h4>
<p>Your Apache installation no doubt includes a certain amount of cruft. Some of that you will need to remove immediately, like config files which block what we&#8217;re trying to do, and some of it you&#8217;ll want to remove later, like modules you don&#8217;t need.</p>
<p>In my installation, at least, the &#8216;Welcome to Fedora Core 5&#8242; page that every URL produced was created by a default file, <tt>welcome.conf</tt>. It&#8217;s in the way, so out it goes:</p>
<pre><code>[server]$ sudo mv welcome.conf welcome.conf.disabled</code></pre>
<p>Let&#8217;s lay out the file structure I&#8217;ve been using to keep my config files sane:</p>
<dl>
<dt><tt>myapp.common</tt></dt>
<dd>The common portions of our configuration. Refactoring this out makes it easier to add additional VirtualHosts down the road (e.g., SSL) while still maintaining exactly the same configuration.</dd>
<dt><tt>myapp.conf</tt></dt>
<dd>The main entry, tying everything together to produce a working Rails app.</dd>
<dt><tt>myapp.proxy_cluster.conf</tt></dt>
<dd>A proxy balancer with which to interface with the Mongrel cluster.</dd>
<dt><tt>myapp.proxy_frontend.conf</tt></dt>
<dd>An (optional) HTTP front-end for managing the proxy load balancing configuration on the fly.</dd>
</dl>
<p>Feel free to replace &#8216;app&#8217; with the actual name of your application.</p>
<p>And now, for the meat.</p>
<h4>myapp.common</h4>
<p>The common bits of configuration. This links a Directory or VirtualHost with the proxy-balancer, includes the proper mod_rewrite configuration for Rails, adds support for Capistrano&#8217;s <tt>enable_web</tt> and <tt>disable_web</tt> commands, and enables mod_deflate for most compressible formats.</p>
<pre><code>  ServerName myapp.com
  DocumentRoot /var/rails/myapp.com/current/public

  &lt;Directory "/var/rails/myapp.com/current/public"&gt;
    Options FollowSymLinks
    AllowOverride None
    Order allow,deny
    Allow from all
  &lt;/Directory&gt;

  RewriteEngine On

  # Make sure people go to www.myapp.com, not myapp.com
  RewriteCond %{HTTP_HOST} ^myapp\.com$ [NC]
  RewriteRule ^(.*)$ http://www.myapp.com$1 [R=301,L]
  # Yes, I've read no-www.com, but my site already has much Google-Fu on
  # www.blah.com. Feel free to comment this out.

  # Uncomment for rewrite debugging
  #RewriteLog logs/myapp_rewrite_log
  #RewriteLogLevel 9 

  # Check for maintenance file and redirect all requests
  RewriteCond %{DOCUMENT_ROOT}/system/maintenance.html -f
  RewriteCond %{SCRIPT_FILENAME} !maintenance.html
  RewriteRule ^.*$ /system/maintenance.html [L]

  # Rewrite index to check for static
  RewriteRule ^/$ /index.html [QSA] 

  # Rewrite to check for Rails cached page
  RewriteRule ^([^.]+)$ $1.html [QSA]

  # Redirect all non-static requests to cluster
  RewriteCond %{DOCUMENT_ROOT}/%{REQUEST_FILENAME} !-f
  RewriteRule ^/(.*)$ balancer://mongrel_cluster%{REQUEST_URI} [P,QSA,L]

  # Deflate
  AddOutputFilterByType DEFLATE text/html text/plain text/xml application/xml application/xhtml+xml text/javascript text/css
  BrowserMatch ^Mozilla/4 gzip-only-text/html
  BrowserMatch ^Mozilla/4\.0[678] no-gzip
  BrowserMatch \\bMSIE !no-gzip !gzip-only-text/html

  # Uncomment for deflate debugging
  #DeflateFilterNote Input input_info
  #DeflateFilterNote Output output_info
  #DeflateFilterNote Ratio ratio_info
  #LogFormat '"%r" %{output_info}n/%{input_info}n (%{ratio_info}n%%)' deflate
  #CustomLog logs/myapp_deflate_log deflate</code></pre>
<h4>myapp.conf</h4>
<p>This is pretty simple, it just ties the settings in <tt>myapp.common</tt> to a VirtualHost on port 80.</p>
<pre><code>&lt;VirtualHost *:80&gt;
  Include /etc/httpd/conf.d/myapp.common

  ErrorLog logs/myapp_errors_log
  CustomLog logs/myapp_log combined
&lt;/VirtualHost&gt;</code></pre>
<h4>myapp.proxy_cluster.conf</h4>
<p>This is loaded by Apache to configure a mod_proxy_balancer cluster mapped to the internal Mongrel servers.</p>
<pre><code>&lt;Proxy balancer://mongrel_cluster&gt;
  BalancerMember http://127.0.0.1:8000
  BalancerMember http://127.0.0.1:8001
  BalancerMember http://127.0.0.1:8002
&lt;/Proxy&gt;</code></pre>
<h4>myapp.proxy_frontend.conf</h4>
<p>This provides a front-end for the proxy load balancing, which you can access from inside your server at http://localhost:8080.</p>
<pre><code>Listen 8080
&lt;VirtualHost *:8080&gt;
  &lt;Location /&gt;
    SetHandler balancer-manager
    Deny from all
    Allow from localhost
  &lt;/Location&gt;
&lt;/VirtualHost&gt;
</code></pre>
<h3>4. Reboot And Go!</h3>
<p>Time to kick over httpd and see if everything worked.</p>
<pre><code>[server]$ sudo /sbin/service httpd restart</code></pre>
<p>If all goes well, your web server is now configured as a Mongrel cluster backend to an Apache 2.2/mod_proxy_balancer frontend. You should feel happy.</p>
<h3>5. Bonus Round! Secure server!</h3>
<p>This one will depend greatly on your distro, but it does contain one super-important tip for getting a TLS/SSL version of your Rails app working in this setup.</p>
<h4>Install mod_ssl, if you haven&#8217;t already</h4>
<pre><code>[server]$ sudo apt-get install mod_ssl</code></pre>
<h4>Replace the defaults in <tt>/etc/httpd/conf.d</tt></h4>
<p>My install added a file, <tt>ssl.conf</tt> to the <tt>conf.d</tt> directory. We&#8217;ll use this as a starting point, but let&#8217;s do it on our own terms:</p>
<pre><code>[server]$ sudo mv ssl.conf ssl.conf.original
[server]$ sudo cp ssl.conf.original myapp.secure.conf
</code></pre>
<p>Now open <tt>myapp.secure.conf</tt> in your favorite editor (<tt>vi</tt>, right?), and scroll down to the VirtualHost it adds on port 443 (with Fedora Core 5, this was line 81). Inside the VirtualHost, add this:</p>
<pre><code>Include /etc/httpd/conf.d/myapp.common

# This is required to convince Rails (via mod_proxy_balancer) that we're
# actually using HTTPS.
RequestHeader set X_FORWARDED_PROTO 'https'</code></pre>
<p>That last bit is super important, especially if you&#8217;re using the ssl_requirements plugin from 37signals (and why wouldn&#8217;t you?). Otherwise, the Mongrel servers won&#8217;t know if an incoming request came in secure or not, which means you&#8217;ll have no way of knowing if you really should be processing that credit card or not.</p>
<h4>Configure the certificates</h4>
<p>Now, either look up the <tt>SSLCertificateFile</tt> and <tt>SSLCertificateKeyFile</tt> entries in <tt>myapp.secure.conf</tt> and replace those files with your cert and key, respectively, or edit the entries to point to where you have your cert and key stored.</p>
<h4>Restart the server and test</h4>
<pre><code>[server]$ sudo /sbin/server httpd restart</code></pre>
<p>Now see if that puppy works!</p>
<h3>How well does this actually work?</h3>
<p>Personally, it&#8217;s worked incredibly well. My &#8220;banging tin pots together&#8221; benchmarking with httperf indicated that where the Apache1.3+FastCGI setup on Dreamhost could handle ~30 reqs/sec before it would start dropping connections, the Apache2.2+Mongrel setup on a 128MiB Rimuhosting VPS can handle ~90 reqs/sec before things get hinky. In addition, the amount of downtime due to lost worker threads or fudged FastCGI connections was nil. The only times the site went down could be directly traced to me cutting first and measuring second.</p>
<p>Apache+Mongrel is shaping up to be <em>the</em> preferred deployment platform for Rails applications. Recently, the official <a href="http://www.rubyonrails.org">Ruby On Rails</a> site <a href="http://weblog.rubyonrails.org/2006/6/11/rails-system-back-on-track">moved to Apache+Mongrel</a> for their <a href="http://weblog.rubyonrails.org">blog</a>, <a href="http://wiki.rubyonrails.org">wiki</a>, and <a href="http://manuals.rubyonrails.org">manuals</a> site, all of which are much more responsive and have much lower downtimes. <a href="http://railsmachine.com/">Rails Machines</a>, an exciting new &#8220;rapid application deployment&#8221; hosting service for Rails applications, is using Apache+Mongrel for all their services. Rick Olsen, Rails Core member, has been running both his <a href="http://weblog.techno-weenie.net/">blog</a> and <a href="http://rails.techno-weenie.net/">Rails Weenie</a> on <del datetime="2006-06-20T08:12:10+00:00">Apache</del>Litespeed+Mongrel recently, and some people like <a href="http://blog.innerewut.de/articles/2006/04/21/scaling-rails-with-apache-2-2-mod_proxy_balancer-and-mongrel">Jonathon Weiss</a> have moved large sites over to this architecture.</p>
<p>The great thing about this deployment architecture is that it leverages one of Rails&#8217; greatest strengths: share-nothing scaling. All you have to do is add more boxes, and Apache+Mongrel makes that as easy as changing your deployment recipe and your <tt>myapp.proxy_cluster.conf</tt> file, then restarting the services. Your Mongrel clusters can span boxes and networks, making scaling a simple matter of plugging in hardware.</p>
<p>Long story short: it&#8217;s golden.</p>
<h3>Thanks to&#8230;</h3>
<p>I cribbed much of the <a href="http://fluxura.com/articles/2006/05/19/apache-for-static-and-mongrel-for-rails-with-mod_deflate-and-capistrano-support">initial Apache configuration</a> and <a href="http://fluxura.com/articles/2006/05/01/mongrel_cluster-0-1-1-the-bird-dog-capistrano-support">Mongrel ideas</a> from <a href="http://fluxura.com/">Bradley Taylor&#8217;s Fluxura</a> blog, as well as <a href="http://blog.innerewut.de/articles/2006/04/21/scaling-rails-with-apache-2-2-mod_proxy_balancer-and-mongrel">Jonathan Weiss&#8217;s article</a>. Any errors I&#8217;m willing to acknowledge as my own, but leave a comment if you find something that doesn&#8217;t work for you! Finally, thanks to all the commenters with questions, corrections, and thanks. This article wouldn&#8217;t be nearly as accurate without you all. Thanks for trying to follow my instructions. ;-)</p>
<p>Enjoy!</p>
          <p class="postmetadata alt">
          <small>
            This entry was posted
                        on Monday, June 19th, 2006 at 11:36pm            and is filed under <a href="http://blog.codahale.com/category/programming/" title="View all posts in Programming" rel="category tag">Programming</a>,  <a href="http://blog.codahale.com/category/programming/ruby-and-rails/" title="View all posts in Ruby and Rails" rel="category tag">Ruby and Rails</a>.
            You can follow any responses to this entry through the <a href='http://blog.codahale.com/2006/06/19/time-for-a-grown-up-server-rails-mongrel-apache-capistrano-and-you/feed/'>RSS 2.0</a> feed.

                          Both comments and pings are currently closed.

            
          </small>
        </p>
        </div> <!-- end div.post-body -->
        <div class="post-meta">
          <span class="post-day">19th</span>
          <span class="post-monthyear">Jun 2006</span>
          <span class="post-time">11:36pm</span>
                    <span class="post-categories"><a href="http://blog.codahale.com/category/programming/" title="View all posts in Programming" rel="category tag">Programming</a>  <a href="http://blog.codahale.com/category/programming/ruby-and-rails/" title="View all posts in Ruby and Rails" rel="category tag">Ruby and Rails</a></span><br />
          <span class="post-tags"></span>
        </div> <!-- end div.post-meta -->
        <div class="post-footer">&nbsp;</div>
      </div> <!-- end div.post -->

	
<!-- You can start editing here. -->

	<h3 id="comments">261 Responses to &#8220;Time For A Grown-Up Server: Rails, Mongrel, Apache, Capistrano and You&#8221;</h3> 

	<ol class="commentlist">

	
		<li class="alt " id="comment-696">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=ff7f86eb0edc99c760fe228c9ecaf525&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Jim</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-696" title="">June 20th, 2006 at 12:56am</a> </small>

			<p>If I recall Rick is running litespeed on his blog and rails weenie.</p>

		</li>

	
	
		<li class=" " id="comment-697">
    <a href='http://townx.org/' title='Visit Elliot Smith'><img src='http://www.gravatar.com/avatar.php?gravatar_id=da378f64387e59e8c2cebded9d9048e8&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://townx.org/' rel='external nofollow' class='url'>Elliot Smith</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-697" title="">June 20th, 2006 at 1:36am</a> </small>

			<p>Coda, you are a Jedi master. Many thanks for this, most useful.</p>

		</li>

	
	
		<li class="alt " id="comment-698">
    <a href='http://ryandaigle.com' title='Visit Ryan Daigle'><img src='http://www.gravatar.com/avatar.php?gravatar_id=8eb7bf96dd877adca0cbd29bb2e47e38&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://ryandaigle.com' rel='external nofollow' class='url'>Ryan Daigle</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-698" title="">June 20th, 2006 at 5:52am</a> </small>

			<p>And I won&#8217;t make fun of you for using Fedora Core :)</p>
<p>Nice writeup, thanks!</p>

		</li>

	
	
		<li class=" " id="comment-699">
    <a href='http://www.bencurtis.com/' title='Visit Ben Curtis'><img src='http://www.gravatar.com/avatar.php?gravatar_id=db303dc84d03a992b33cd3ac978f89ae&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://www.bencurtis.com/' rel='external nofollow' class='url'>Ben Curtis</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-699" title="">June 20th, 2006 at 5:53am</a> </small>

			<p>Here&#8217;s the line to get Debian to set up the init script:</p>
<p>sudo /usr/sbin/update-rc.d mongrel_cluster defaults</p>

		</li>

	
	
		<li class="alt " id="comment-700">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d73914c0f3c7350b9fbc0790e1fc0412&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Bob</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-700" title="">June 20th, 2006 at 6:43am</a> </small>

			<p>Great article, when I&#8217;m ready to start experimenting I will be back&#8230;</p>
<p>Typo in the article if you are interested?<br />
&#8220;My advice is to start with two or three and build up to it. As you’ll see later, adding more clusters is stupid-easy. For more, we’ll assume that a cluster of three will do nicely.&#8221;</p>
<p>&#8220;For more,&#8221; probably should have been &#8220;For now,&#8221;</p>

		</li>

	
	
		<li class=" " id="comment-701">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=7a7777470c11f6c746e3236a1b3aa4db&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>steve enzer</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-701" title="">June 20th, 2006 at 12:34pm</a> </small>

			<p>Great article! Just what I was looking for.</p>
<p>I did notice what appears to be an error, in this section:</p>
<p> Now add the following to your deploy.rb settings:</p>
<p> set :mongrel_servers, 3<br />
 set :mongrel_port, 8000<br />
 set :mongrel_environment, &#8216;production&#8217;<br />
 set :mongrel_config, &#8220;#{current_path}/config/mongrel_cluster.yml&#8221;</p>
<p>I believe that the last line actually needs to be:</p>
<p> set :mongrel_conf, &#8220;#{cur&#8230;</p>
<p>or at least, using the current version of mongrel_cluster it does</p>

		</li>

	
	
		<li class="alt official" id="comment-702">
    <a href='http://blog.codahale.com' title='Visit Coda'><img src='http://www.gravatar.com/avatar.php?gravatar_id=87206f3bf53d403e16ec023c56e904c5&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://blog.codahale.com' rel='external nofollow' class='url'>Coda</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-702" title="">June 20th, 2006 at 12:47pm</a> </small>

			<p>Thanks a million, Steve! That bit of duplication always made my teeth itch, but I couldn&#8217;t get the config file to load on its own. Conf, not config. Awesome!</p>

		</li>

	
	
		<li class=" " id="comment-703">
    <a href='http://www.rubyinside.com/how-to-setup-a-tight-rails-deployment-server-with-apache-and-mongrel-107.html' title='Visit How to setup a tight Rails deployment server with Apache and Mongrel'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://www.rubyinside.com/how-to-setup-a-tight-rails-deployment-server-with-apache-and-mongrel-107.html' rel='external nofollow' class='url'>How to setup a tight Rails deployment server with Apache and Mongrel</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-703" title="">June 20th, 2006 at 4:29pm</a> </small>

			<p>[...] The unstoppable Coda Hale presents an amazing article about setting up a server with Mongrel, Apache, Capistrano, SSL support, etc. for solidly serving Rails applications. An extremely well written and solid guide. [...]</p>

		</li>

	
	
		<li class="alt " id="comment-704">
    <a href='http://zhesto.wordpress.com/2006/06/21/links-for-2006-06-21/' title='Visit Bloggitation &raquo; links for 2006-06-21'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://zhesto.wordpress.com/2006/06/21/links-for-2006-06-21/' rel='external nofollow' class='url'>Bloggitation &raquo; links for 2006-06-21</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-704" title="">June 20th, 2006 at 5:23pm</a> </small>

			<p>[...] Time For A Grown-Up Server: Rails, Mongrel, Apache, Capistrano and You (tags: ruby rails sysadmin mongrel) [...]</p>

		</li>

	
	
		<li class=" " id="comment-705">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=ad87b3869dc58ece9bc7b500067b340c&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Jesse Clark</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-705" title="">June 20th, 2006 at 5:29pm</a> </small>

			<p>Thanks for the resource, I found a couple things as I was going through it:</p>
<p>[workstation]$ mongrel_rails cluster::configure -e production \<br />
  -p 8000 \<br />
  -a 127.0.0.1 \<br />
  -N 3 \<br />
  -C /path/to/your/capistrano/setup&#8217;s/current</p>
<p>with this config command I get Errno::EISDIR. </p>
<p>Not having read the mongrel documentation (&#8230;) it took me a while to (incorrectly) assume that it was trying to write the config file to the path given to -C. </p>
<p>Much much later, I figured out that instead of giving it the path name to the config file, you might have meant to pass a lower case -c which would cause the mongrel_rails start commands to chdir to your deploy directory before executing which allows all the default paths to function correctly.</p>
<p>4 hours and one case change later, it was off to the races.</p>
<p>Another small point is that<br />
set :mongrel_conf, &#8220;#{current_path}/config&#8230;<br />
references current_path which references deploy_to and you&#8217;ll get odd results if you try to set mongrel_conf prior to deploy_to.</p>

		</li>

	
	
		<li class="alt official" id="comment-706">
    <a href='http://blog.codahale.com' title='Visit Coda'><img src='http://www.gravatar.com/avatar.php?gravatar_id=87206f3bf53d403e16ec023c56e904c5&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://blog.codahale.com' rel='external nofollow' class='url'>Coda</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-706" title="">June 20th, 2006 at 5:40pm</a> </small>

			<p>Ack! Sorry about wasting four of your hours, Jesse! That was my left pinky getting a little eager with the shift button. And good point on the <tt>:mongrel_conf</tt>.</p>

		</li>

	
	
		<li class=" " id="comment-707">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=7a7777470c11f6c746e3236a1b3aa4db&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>steve enzer</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-707" title="">June 20th, 2006 at 7:27pm</a> </small>

			<p>Coda, now that I&#8217;ve installed Apache 2.2 and configured the cluster, all I&#8217;m getting is a blank page with &#8216;It Works&#8217; writ across the top in large type &#8212; and I&#8217;m a bit at a loss as to what that means (or doesn&#8217;t mean), as I&#8217;d expect (or hope) to be seeing my app&#8230; any idea?</p>

		</li>

	
	
		<li class="alt official" id="comment-708">
    <a href='http://blog.codahale.com' title='Visit Coda'><img src='http://www.gravatar.com/avatar.php?gravatar_id=87206f3bf53d403e16ec023c56e904c5&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://blog.codahale.com' rel='external nofollow' class='url'>Coda</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-708" title="">June 20th, 2006 at 8:20pm</a> </small>

			<p>Hmmm&#8230; that sounds like the default configuration of Apache, which you&#8217;ll need to disable, so your own configuration can show up.</p>
<p>In your <tt>conf.d</tt> directory, there is probably something like <tt>welcome.conf</tt> which you&#8217;ll need to rename to something like <tt>welcome.conf.disabled</tt> or somesuch.</p>
<p>If this isn&#8217;t the case, then your distro packagers felt like tossing modularity to the wind, and stuffed that portion of code directly into <tt>httpd.conf</tt> in the <tt>conf</tt> directory.</p>
<p>Failing that, you may want to fall back on the advice of <tt>#apache</tt> on FreeNode.net.</p>

		</li>

	
	
		<li class=" " id="comment-709">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=2d8b1d444348889b37029644d54da31b&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Cyrus Farajpour</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-709" title="">June 20th, 2006 at 8:29pm</a> </small>

			<p>I&#8217;ve spent the past few days setting up a very similar hosting environment and was thinking about making a write up myself.  Now I see yours and I must say thank you.  Your setup points out flaws I didn&#8217;t even think of in my own and encompasses (SSL in particular) more than I would have.</p>
<p>This is a really kickass article.</p>
<p>~smoil</p>

		</li>

	
	
		<li class="alt " id="comment-710">
    <a href='http://www.mornography.de/2006/06/21/rails-mongrel-apache-capistrano-and-you/' title='Visit Rails, Mongrel, Apache, Capistrano and You &middot; mornography.de'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://www.mornography.de/2006/06/21/rails-mongrel-apache-capistrano-and-you/' rel='external nofollow' class='url'>Rails, Mongrel, Apache, Capistrano and You &middot; mornography.de</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-710" title="">June 21st, 2006 at 8:20am</a> </small>

			<p>[...] Coda Hale schl&#228;gt wieder zu: Time For A Grown-Up Server: Rails, Mongrel, Apache, Capistrano and You. Eine Rundum-Sorglos-Anleitung zum Aufsetzen einer Rails-Anwendung mit Mongrel und Apache 2.2. &#220;ber das wundervolle Capistrano. Boochakayaya! [...]</p>

		</li>

	
	
		<li class=" " id="comment-711">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=ad87b3869dc58ece9bc7b500067b340c&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Jesse Clark</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-711" title="">June 21st, 2006 at 8:56am</a> </small>

			<p>It would have taken me quite a bit longer to get this far without this guide you have provided. I don&#8217;t consider the four hours wasted at all and I&#8217;m glad that I could contribute in some small way to your excellent article.</p>

		</li>

	
	
		<li class="alt " id="comment-712">
    <a href='http://railsmachine.com' title='Visit Bradley Tayloy'><img src='http://www.gravatar.com/avatar.php?gravatar_id=fcaf7a918c19872baf5c3b2787415e8e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://railsmachine.com' rel='external nofollow' class='url'>Bradley Tayloy</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-712" title="">June 21st, 2006 at 10:11am</a> </small>

			<p>Nice writeup! Much of this is now automated using the railsmachine gem which I have released as open source. By default, the paths are configured to work with our server configurations, but you should be able to change the appropriate variables for your server. </p>
<p>To install:<br />
&#8220;gem install railsmachine&#8221;</p>
<p>Quick start guide:<br />
<a href="https://support.railsmachine.com/index.php?pg=kb.page&amp;id=12" rel="nofollow">https://support.railsmachine.com/index.php?pg=kb.page&amp;id=12</a></p>

		</li>

	
	
		<li class=" " id="comment-713">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=c694a032be7518a0d704318895f8fe1d&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Ben</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-713" title="">June 21st, 2006 at 10:49am</a> </small>

			<p>Coda,<br />
Thanks for the great blog and plugins all the time&#8230; I checked out Rimuhosting and they look like a good fit for what I do.  Are you hosting with them now?  If you are tell me what domain your hosting with them and you will get a $15 referring credit.<br />
Thanks,<br />
Ben</p>

		</li>

	
	
		<li class="alt official" id="comment-714">
    <a href='http://blog.codahale.com' title='Visit Coda'><img src='http://www.gravatar.com/avatar.php?gravatar_id=87206f3bf53d403e16ec023c56e904c5&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://blog.codahale.com' rel='external nofollow' class='url'>Coda</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-714" title="">June 21st, 2006 at 10:53am</a> </small>

			<p>Ben&#8211; I am indeed hosting with Rimuhosting, and their service has been flawless. Any and all downtime we&#8217;ve experienced with them has been strictly due to Sausagefingers McGunjumper (read: me, pushing buttons when I shouldn&#8217;t). If you want to toss me a credit, the domain is gpsgeek.com, but it&#8217;ll go to my employer, not me.</p>

		</li>

	
	
		<li class=" " id="comment-715">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=ad87b3869dc58ece9bc7b500067b340c&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Jesse Clark</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-715" title="">June 21st, 2006 at 11:10am</a> </small>

			<p>FYI mod_proxy_balancer was released with Apache 2.1 which is therefore the minimum apache requirement for this setup.</p>

		</li>

	
	
		<li class="alt " id="comment-716">
    <a href='http://nicolas-delsaux.is-a-geek.net/wordpress/index.php/archives/2006/links-for-2006-06-22/' title='Visit Le blog &raquo; links for 2006-06-22'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://nicolas-delsaux.is-a-geek.net/wordpress/index.php/archives/2006/links-for-2006-06-22/' rel='external nofollow' class='url'>Le blog &raquo; links for 2006-06-22</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-716" title="">June 21st, 2006 at 5:29pm</a> </small>

			<p>[...] Rails, mongrel and Apache Enfin un tutorial pour installer Rails d&#8217;une façon efficace et compatible avec Apache, pour m&#8217;éviter d&#8217;avoir de multiples serveurs web. Et, finallement, ça ressemble vachement à ce qu&#8217;on fait en Java. (tags: development hosting rails ruby server software tutorial web apple) [...]</p>

		</li>

	
	
		<li class=" " id="comment-717">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=630bf34923edde44c4936ce3e634412d&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Andi</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-717" title="">June 23rd, 2006 at 1:56am</a> </small>

			<p>Great post, thanks a lot for summing all this up. I wonder if this virtual hosting with 128MB ram is enough. I&#8217;ve been thinking of going virutal too, but was always scared by the low RAM they provide, especially with hungry Apache. Any problems with the size of the RAM? Machine must be swapping all the time&#8230;.?</p>

		</li>

	
	
		<li class="alt official" id="comment-718">
    <a href='http://blog.codahale.com' title='Visit Coda'><img src='http://www.gravatar.com/avatar.php?gravatar_id=87206f3bf53d403e16ec023c56e904c5&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://blog.codahale.com' rel='external nofollow' class='url'>Coda</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-718" title="">June 23rd, 2006 at 9:28am</a> </small>

			<p>You know, it&#8217;s not doing anything else but running Apache, Mongrel, and MySQL. It&#8217;s not the most roomy environment, but we honestly haven&#8217;t had any problems with it yet. Smaller sites can probably use two Mongrel processes, which would easily fit in a 96MiB VPS.</p>

		</li>

	
	
		<li class=" " id="comment-719">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=b219cf7373f8606c7a0ecc17e6ab8800&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>JGeiger</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-719" title="">June 23rd, 2006 at 9:42am</a> </small>

			<p>Please be sure to read On Boot Initialization Setup in <a href="http://mongrel.rubyforge.org/docs/mongrel_cluster.html" rel="nofollow">http://mongrel.rubyforge.org/docs/mongrel_cluster.html</a> as it contains information about copying your config files to where the startup script can find them. You might want to add this information into the post as well.</p>

		</li>

	
	
		<li class="alt official" id="comment-720">
    <a href='http://blog.codahale.com' title='Visit Coda'><img src='http://www.gravatar.com/avatar.php?gravatar_id=87206f3bf53d403e16ec023c56e904c5&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://blog.codahale.com' rel='external nofollow' class='url'>Coda</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-720" title="">June 23rd, 2006 at 9:55am</a> </small>

			<p>Crap, thanks JGeiger! I knew I forgot to write up a step.</p>

		</li>

	
	
		<li class=" " id="comment-723">
    <a href='http://livsey.org' title='Visit Richard Livsey'><img src='http://www.gravatar.com/avatar.php?gravatar_id=c004d67820a114e24ccf6f2ddaf5b236&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://livsey.org' rel='external nofollow' class='url'>Richard Livsey</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-723" title="">June 24th, 2006 at 8:00pm</a> </small>

			<p>Hi - thanks for the great tutorial. In combination with Ezra&#8217;s &#8216;perfect rails stack&#8217; article (http://www.brainspl.at/rails_stack.html) I nearly have my new dedicated server up and running.</p>
<p>I installed Apache2 from apt-get and all is good, except it doesn&#8217;t seem to include mod_proxy_balancer and I can&#8217;t seem to work out where to get it from. Any ideas on how to solve this last step would be greatly appreciated!</p>
<p>Thanks again.</p>

		</li>

	
	
		<li class="alt " id="comment-724">
    <a href='http://www.railshosting.org' title='Visit William'><img src='http://www.gravatar.com/avatar.php?gravatar_id=15f87f2fef8b0ffedfa127b42895f5a1&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://www.railshosting.org' rel='external nofollow' class='url'>William</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-724" title="">June 25th, 2006 at 3:19am</a> </small>

			<p>Coda - thank you.  A much needed article.  &#8216;Best arguments I&#8217;ve read thus far for the Apache2/Mongrel setup.  Looks like I need to rearrage a few things and dig in ASAP.  I&#8217;ll let you know how it goes.</p>

		</li>

	
	
		<li class=" " id="comment-725">
    <a href='http://livsey.org' title='Visit Richard Livsey'><img src='http://www.gravatar.com/avatar.php?gravatar_id=c004d67820a114e24ccf6f2ddaf5b236&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://livsey.org' rel='external nofollow' class='url'>Richard Livsey</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-725" title="">June 25th, 2006 at 8:53am</a> </small>

			<p>Ooops - Found out that the apt-get version of apache2 is 2.0 and not 2.2 which is the version which comes with mod_proxy_balancer!</p>
<p>Nuked the apt-get version and installed 2.2.2 from source and all works superbly now!</p>
<p>Thanks again for the great article :o)</p>

		</li>

	
	
		<li class="alt " id="comment-726">
    <a href='http://binrock.net/' title='Visit Dan McCormack'><img src='http://www.gravatar.com/avatar.php?gravatar_id=6cfd48437de1a9d21309031e414a6028&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://binrock.net/' rel='external nofollow' class='url'>Dan McCormack</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-726" title="">June 25th, 2006 at 11:35am</a> </small>

			<p>I set this all up today (I&#8217;d previously been running Apache 2.0 + FCGI) and I&#8217;m loving it. I ran into a problem though. My Rails app lives in a subdirectory of my site, so for example my ProxyPass lines look something like this:</p>
<p>ProxyPass /test/ balancer://mongrel_cluster/<br />
ProxyPassReverse /test/ balancer://mongrel_cluster/</p>
<p>That works, but the paths are all wrong because Rails thinks it&#8217;s at the root directory (which, as far as it&#8217;s concerned, it is), so it generates links to things like /controller/action instead of /test/controller/action, as it did when I was running it with FCGI. Does anyone have any idea how I might work around this issue? Maybe some clever mod_rewrite rules, or doing something with the routing, or somehow altering Mongrel&#8217;s configuration to place the Rails site in a subdirectory to match the Apache config? I&#8217;ll be experimenting with a few of these, but if someone has encountered this issue before I&#8217;d love to hear how you dealt with it.</p>

		</li>

	
	
		<li class=" " id="comment-727">
    <a href='http://www.milosmandic.com/' title='Visit Milos'><img src='http://www.gravatar.com/avatar.php?gravatar_id=2ec5e26d1b6ce5140395b8b2166dadee&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://www.milosmandic.com/' rel='external nofollow' class='url'>Milos</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-727" title="">June 25th, 2006 at 12:07pm</a> </small>

			<p>[…] A very accosting layout and a interesting discussion topic, do you provide any Web-based services to universities or students. […] - Sorry for the stupid question :-)</p>

		</li>

	
	
		<li class="alt " id="comment-728">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=2d8b1d444348889b37029644d54da31b&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Cyrus Farajpour</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-728" title="">June 25th, 2006 at 4:19pm</a> </small>

			<p>To: Dan McCormack</p>
<p>I solved this issue by using the reverse_proxy_fix plugin.</p>
<p>ruby script/plugin install <a href="http://svn.napcsweb.com/public/reverse_proxy_fix" rel="nofollow">http://svn.napcsweb.com/public/reverse_proxy_fix</a></p>
<p>Lemme know if this works for you.</p>
<p>~Cyrus</p>

		</li>

	
	
		<li class=" " id="comment-729">
    <a href='http://binrock.net/' title='Visit Dan McCormack'><img src='http://www.gravatar.com/avatar.php?gravatar_id=6cfd48437de1a9d21309031e414a6028&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://binrock.net/' rel='external nofollow' class='url'>Dan McCormack</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-729" title="">June 25th, 2006 at 7:58pm</a> </small>

			<p>Cyrus: Perfect! With a little modification, that solved my problem exactly. I love the internet. Thanks :)</p>

		</li>

	
	
		<li class="alt " id="comment-731">
    <a href='http://www.seebq.com/' title='Visit Charles Brian Quinn'><img src='http://www.gravatar.com/avatar.php?gravatar_id=e3eace5bb863c17ce1bb1c8bdd94a06c&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://www.seebq.com/' rel='external nofollow' class='url'>Charles Brian Quinn</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-731" title="">June 25th, 2006 at 10:41pm</a> </small>

			<p>Kudos, an excellent write-up indeed.  Here are my notes/additions:</p>
<p>in gentoo the startup is:</p>
<p>$ sudo rc-update add mongrel_cluster default</p>
<p>and if you symlink (your symlinked) mongrel_cluster config you don&#8217;t have to worry about changing that one sitting in /etc/mongrel_cluster:</p>
<p>$ ln -s /path/to/your/capistranoed/app/current/config/mongrel_cluster.yml /etc/mongrel_cluster/yourapp.yml</p>
<p>I just got done converting one of our boxen from a lighttpd + externally managed fastcgi over to apache 2.2 mod_proxy_balancer + mongrel_rails on a smokin&#8217; machine.  I used siege to load_test her, and will be posting the results soon!</p>
<p>It would be cool to be able to somehow tell apache&#8217;s mod_proxy_balancer how many mongrel_rails exist dynamically &#8212; the hacker in me says there&#8217;s a way to build up those lines &#8220;http://127.0.0.1:8000 &#8230;&#8221; based on your mongrel_cluster file.  Perhaps another day.  ;-)</p>
<p>Thanks a bunch for the great field notes!</p>

		</li>

	
	
		<li class=" " id="comment-745">
    <a href='http://antrover.com' title='Visit Dave'><img src='http://www.gravatar.com/avatar.php?gravatar_id=12be02204a4bcaeec2c6c369fe53a45b&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://antrover.com' rel='external nofollow' class='url'>Dave</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-745" title="">June 27th, 2006 at 8:45am</a> </small>

			<p>Hi there,</p>
<p>Great article! </p>
<p>I did run into a problem, and I&#8217;m not real sure what&#8217;s causing this. When I run &#8220;rake remote:cold_deply&#8221; cap freezes at the following line:</p>
<p>    [192.168.0.200] executing command<br />
 ** [out :: 192.168.0.200] Authentication realm:  swaydev<br />
 ** [out :: 192.168.0.200] Password for &#8216;dave&#8217;:<br />
 ** [out :: 192.168.0.200] subversion is asking for a password<br />
 ** [out :: 192.168.0.200] Authentication realm:  swaydev<br />
 ** [out :: 192.168.0.200] Username:</p>
<p>It won&#8217;t let me enter a username at this point. Everything just freezes.</p>
<p>Any ideas?</p>
<p>Thanks!<br />
Dave</p>

		</li>

	
	
		<li class="alt " id="comment-746">
    <a href='http://antrover.com' title='Visit Dave'><img src='http://www.gravatar.com/avatar.php?gravatar_id=12be02204a4bcaeec2c6c369fe53a45b&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://antrover.com' rel='external nofollow' class='url'>Dave</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-746" title="">June 27th, 2006 at 8:46am</a> </small>

			<p>Woops&#8230; I meant: </p>
<p>&#8220;rake remote:cold_deploy&#8221;</p>
<p>(forgot the &#8220;o&#8221;)</p>
<p>-Dave</p>

		</li>

	
	
		<li class=" official" id="comment-747">
    <a href='http://blog.codahale.com' title='Visit Coda'><img src='http://www.gravatar.com/avatar.php?gravatar_id=87206f3bf53d403e16ec023c56e904c5&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://blog.codahale.com' rel='external nofollow' class='url'>Coda</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-747" title="">June 27th, 2006 at 8:48am</a> </small>

			<p>Dave&#8211;that&#8217;s a little-known gotcha of Capistrano&#8217;s. You need to make sure the account you&#8217;re using with Capistrano can access your Subversion repository for each app server of yours. Log into each and <code>svn co your_repos</code> into a temp directory. It&#8217;ll prompt you for the username and password, and once you&#8217;ve entered it successfully, it&#8217;ll remember it. Then you&#8217;ll be able to deploy without any problems.</p>

		</li>

	
	
		<li class="alt " id="comment-749">
    <a href='http://antrover.com' title='Visit Dave'><img src='http://www.gravatar.com/avatar.php?gravatar_id=12be02204a4bcaeec2c6c369fe53a45b&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://antrover.com' rel='external nofollow' class='url'>Dave</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-749" title="">June 27th, 2006 at 2:11pm</a> </small>

			<p>Thanks Coda&#8230; I can&#8217;t believe I missed that!</p>
<p>-Dave</p>

		</li>

	
	
		<li class=" " id="comment-751">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=69700335771243f68a0587c2fa26d930&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Doug</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-751" title="">June 27th, 2006 at 4:52pm</a> </small>

			<p>Cluster works for me but not with Apache uhh!<br />
Using the most basic setup I can think of to get this running. Created a basic rails app structure and configured mongrel. Started mongrel and can access the riding rails page from a browser at <a href="http://localhost:8000" rel="nofollow">http://localhost:8000</a>, <a href="http://localhost:8001" rel="nofollow">http://localhost:8001</a>, etc.</p>
<p>Problem is when using appache at <a href="http://localhost" rel="nofollow">http://localhost</a> - it loads the riding rails page with no image, and when I click the &#8220;About your applictions environment&#8221; I get an Apache page: Service unavailable. Checking /etc/httpd/logs/myapp_errors_log shows: Permission denied: proxy: HTTP: attempt to connect to 127.0.0.1:8000 (127.0.0.1) failed</p>
<p>I&#8217;m transitioning (painfully) from a long Windows career to Linux so I&#8217;m sure I&#8217;m missing something silly here. Any ideas or places for me to look? I&#8217;ve checked all the directions in your post about 5 times and can&#8217;t find where I went wrong.</p>
<p>Thanks,<br />
-Doug</p>

		</li>

	
	
		<li class="alt official" id="comment-752">
    <a href='http://blog.codahale.com' title='Visit Coda'><img src='http://www.gravatar.com/avatar.php?gravatar_id=87206f3bf53d403e16ec023c56e904c5&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://blog.codahale.com' rel='external nofollow' class='url'>Coda</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-752" title="">June 27th, 2006 at 5:08pm</a> </small>

			<p>Doug&#8211;The &#8220;About your application&#8217;s environment&#8221; link will only work for local requests due to security reasons. In the production environment, none of the requests Mongrel receives from Apache will be considered local, and so Mongrel will issue a 403 error: permission denied. This seems like a likely source of your problem. You may want to add a controller to your Rails project and give it a simple <code>index</code> action.</p>
<p>If that doesn&#8217;t work, the problem probably lies in the way you have configured your proxy cluster in Apache. If you email me your config files for that, I&#8217;d be able to tell you more.</p>

		</li>

	
	
		<li class=" " id="comment-761">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=30c8a3557d931f3b95103b9637888081&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Jed Hurt</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-761" title="">June 28th, 2006 at 10:41am</a> </small>

			<p>Hey Coda, I have a Spry VPS with Apache 2.0.46 and I&#8217;m too scared to try to upgrade it. Does Apache 2.0.46 have the necessary components to complete this walkthrough?</p>

		</li>

	
	
		<li class="alt official" id="comment-763">
    <a href='http://blog.codahale.com' title='Visit Coda'><img src='http://www.gravatar.com/avatar.php?gravatar_id=87206f3bf53d403e16ec023c56e904c5&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://blog.codahale.com' rel='external nofollow' class='url'>Coda</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-763" title="">June 28th, 2006 at 6:38pm</a> </small>

			<p>Sorry, Jed. Only people with Apache 2.1 and up can play. You may want to talk to the folks in <tt>#apache</tt> about the advisability of compling Apache from scratch on your system. It may be easier than you think.</p>

		</li>

	
	
		<li class=" " id="comment-766">
    <a href='http://schwuk.com/articles/2006/06/29/daemonizing-mongrel' title='Visit schwuk.com'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://schwuk.com/articles/2006/06/29/daemonizing-mongrel' rel='external nofollow' class='url'>schwuk.com</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-766" title="">June 29th, 2006 at 8:07am</a> </small>

			<p><strong>Daemonizing Mongrel&#8230;</strong></p>
<p>I did have one minor niggle though. After restarting my server a couple of times during the aforementioned problems I had to restart Mongrel manually. I knew there was a better way to do it, but I didnt know how. Now I do</p>
<p>&#8230;</p>

		</li>

	
	
		<li class="alt " id="comment-768">
    <a href='http://www.top-ten-tutorials.com/story/546/' title='Visit '><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://www.top-ten-tutorials.com/story/546/' rel='external nofollow' class='url'>Anonymous</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-768" title="">June 30th, 2006 at 3:12pm</a> </small>

			<p><strong>Time For A Grown-Up Server: Rails, Mongrel, Apache, Capistrano and You&#8230;</strong></p>
<p>How to setup a web server, configured as a Mongrel cluster backend to an Apache 2.2/mod_proxy_balancer frontend&#8230;.</p>

		</li>

	
	
		<li class=" " id="comment-772">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=fc5cd6d3eb99d4b1378afe88af4ee601&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Paul King</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-772" title="">July 1st, 2006 at 3:40pm</a> </small>

			<p>Another thing worth noting is that you should probably configure apache to deny access to the .svn subdirectories.  Problem is that I can&#8217;t seem to get the information here to work: <a href="http://subversion.tigris.org/faq.html#website-auto-update" rel="nofollow">http://subversion.tigris.org/faq.html#website-auto-update</a> with this configuration.</p>
<p>Anyone been able to successfully block access to .svn directories, if so where do you put the DirectoryMatch directive?</p>
<p>Cheers</p>

		</li>

	
	
		<li class="alt " id="comment-830">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=68681ad8a05867995bbc19d3c0726ea4&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Michael</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-830" title="">July 7th, 2006 at 4:06am</a> </small>

			<p>Thanks a lot for this nice writeup, Coda, but there is one thing I don&#8217;t seem to get right. You mention that if you install the sendfile gem, mongrel won&#8217;t serve any static content but let apache do the work. So far so good, but shouldn&#8217;t the following rewrite rule from your myapp.common capture all static requests before mongrel even sees them?</p>
<p># Redirect all non-static requests to cluster<br />
  RewriteCond %{DOCUMENT_ROOT}/%{REQUEST_FILENAME} !-f<br />
  RewriteRule ^/(.*)$ balancer://mongrel_cluster%{REQUEST_URI} [P,QSA,L]</p>

		</li>

	
	
		<li class=" " id="comment-831">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=68681ad8a05867995bbc19d3c0726ea4&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Michael</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-831" title="">July 7th, 2006 at 5:39am</a> </small>

			<p>Regarding comment #44: You can set the variable :checkout to &#8220;export&#8221; in your deploy.rb and capistrano will perform an svn export instead of svn co, so you won&#8217;t get a working copy and thus no .svn directories at all on your server.</p>

		</li>

	
	
		<li class="alt official" id="comment-832">
    <a href='http://blog.codahale.com' title='Visit Coda'><img src='http://www.gravatar.com/avatar.php?gravatar_id=87206f3bf53d403e16ec023c56e904c5&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://blog.codahale.com' rel='external nofollow' class='url'>Coda</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-832" title="">July 7th, 2006 at 7:03am</a> </small>

			<p>Paul&#8211;I&#8217;m not sure if it&#8217;s the way I&#8217;ve got my routes mapped in my application, but my .svn directories aren&#8217;t publicly accessible. In terms of having Subversion automatically update things, you&#8217;re much better off using Capistrano.</p>
<p>Michael&#8211;two reasons: one, I&#8217;m pretty sure it helps with cached content, two, the Apache configuration still lets a few things slide. Regarding the first issue, I&#8217;m not positive, and regarding the second, fixing that is on my to-do list, and I&#8217;ll update this post when I fix that. In the meantime, it&#8217;s a very little bit of extra effort to make the worst-case scenario (Mongrel serving static content) a bit less worst-case.</p>

		</li>

	
	
		<li class=" " id="comment-843">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=2d6180b74022589155f0a3635e20a8b7&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Chad Westfall</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-843" title="">July 7th, 2006 at 2:01pm</a> </small>

			<p>In regards to Doug&#8217;s post on June 27th, 2006 at 4:52pm.  I was running into a similar issue:</p>
<p>(13)Permission denied: proxy: HTTP: attempt to connect to 127.0.0.1:8002 (127.0.0.1) failed</p>
<p>I found the issue to by SELinux.  My dedicated server host setup my box with SELinux enabled and it was causing an issue between mongrel and apache.  To disable SELinux temporarily, run the following command:</p>
<p>setenforce 0</p>
<p>Conversly, &#8220;sentenforce 1&#8243; will enable SELinux again.</p>

		</li>

	
	
		<li class="alt " id="comment-850">
    <a href='http://innig.net/' title='Visit Paul'><img src='http://www.gravatar.com/avatar.php?gravatar_id=ecdb231117dda838340bfcbb8873d28e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://innig.net/' rel='external nofollow' class='url'>Paul</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-850" title="">July 8th, 2006 at 10:07am</a> </small>

			<p>A minor thing &#8212; I believe the phrase is &#8220;a bad rap,&#8221; not &#8220;a bad wrap.&#8221;</p>

		</li>

	
	
		<li class=" " id="comment-851">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=b9638176195f247741cbbb85a2ab44c8&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Jens</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-851" title="">July 8th, 2006 at 11:22am</a> </small>

			<p>Hi all,</p>
<p>I would like to use the apache2.2 and the mongrel cluser to serve more than one rails app (the apps run under different VirtualHost configurations). Do I have to create 3 mongrel processes for each VirtualHost entry or can I share (say 6-8 mongrel processes - yep I have enough Ram) between the apps ?</p>
<p>Thanks a lot<br />
Great article BTW<br />
Jens Carroll</p>

		</li>

	
	
		<li class="alt " id="comment-852">
    <a href='http://iamrice.org/articles/2006/07/08/serving-rails-with-lighttpd-pound-and-mongrel' title='Visit Serving Rails with lighttpd, pound and mongrel'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://iamrice.org/articles/2006/07/08/serving-rails-with-lighttpd-pound-and-mongrel' rel='external nofollow' class='url'>Serving Rails with lighttpd, pound and mongrel</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-852" title="">July 8th, 2006 at 12:36pm</a> </small>

			<p>[...] Time For A Grown-Up Server: Rails, Mongrel, Apache, Capistrano and You | Archives | codablog | Coda Hale [...]</p>

		</li>

	
	
		<li class=" official" id="comment-853">
    <a href='http://blog.codahale.com' title='Visit Coda'><img src='http://www.gravatar.com/avatar.php?gravatar_id=87206f3bf53d403e16ec023c56e904c5&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://blog.codahale.com' rel='external nofollow' class='url'>Coda</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-853" title="">July 8th, 2006 at 2:51pm</a> </small>

			<p>Paul&#8211;Thanks!</p>
<p>Jens&#8211;You can point many vhosts at a single cluster, but a cluster can only run a single application. You&#8217;ll need at least one cluster per application.</p>

		</li>

	
	
		<li class="alt " id="comment-854">
    <a href='http://finotto.org' title='Visit Michele'><img src='http://www.gravatar.com/avatar.php?gravatar_id=8380a69b6a3119f8fae3b7c10d9a057b&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://finotto.org' rel='external nofollow' class='url'>Michele</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-854" title="">July 9th, 2006 at 4:03am</a> </small>

			<p>Thanks for the great tutorial!</p>
<p>A quick note for FreeBSD: Apache 2.2 should be installed with WITH_PROXY_MODULES=yes. i.e. cd /usr/ports/www/apache22 &amp;&amp; sudo make WITH_PROXY_MODULES=yes &amp;&amp; sudo make install .<br />
And these modules should be added to the ones added by default in /usr/local/etc/apache22/httpd.conf:<br />
LoadModule proxy_module libexec/apache22/mod_proxy.so<br />
LoadModule proxy_balancer_module libexec/apache22/mod_proxy_balancer.so<br />
LoadModule proxy_ftp_module libexec/apache22/mod_proxy_ftp.so<br />
LoadModule proxy_http_module libexec/apache22/mod_proxy_http.so<br />
LoadModule proxy_connect_module libexec/apache22/mod_proxy_connect.so</p>

		</li>

	
	
		<li class=" " id="comment-856">
    <a href='http://www.moneygroove.com' title='Visit ian'><img src='http://www.gravatar.com/avatar.php?gravatar_id=ece4294a75d4972102c40e6d53b18922&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://www.moneygroove.com' rel='external nofollow' class='url'>ian</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-856" title="">July 9th, 2006 at 9:21pm</a> </small>

			<p>One problem I have run into is that my static (cached) pages are correctly served through apache, but my assets like javascripts and css are still served through mongrel. </p>
<p>I think this has to do with all the requests automatically getting rewritten with a .html suffix ( RewriteRule ^([^.]+)$ $1.html [QSA]). </p>
<p>I am not enough of a mod_rewrite guru to figure out a solution, but I am sure someone else has.</p>

		</li>

	
	
		<li class="alt " id="comment-857">
    <a href='http://www.moneygroove.com' title='Visit ian'><img src='http://www.gravatar.com/avatar.php?gravatar_id=ece4294a75d4972102c40e6d53b18922&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://www.moneygroove.com' rel='external nofollow' class='url'>ian</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-857" title="">July 10th, 2006 at 9:22am</a> </small>

			<p>To follow up on my previous comment, I have resorted to adding the following lines to my config.</p>
<p>ProxyPass /images !<br />
ProxyPass /stylesheets !<br />
ProxyPass /javascripts !<br />
ProxyPass /favicon.ico !</p>
<p>This ensures that my static files get served from apache, and not delegated to mongrel.</p>
<p>I found this solution on the mongrel mailing list archives.</p>

		</li>

	
	
		<li class=" official" id="comment-863">
    <a href='http://blog.codahale.com' title='Visit Coda'><img src='http://www.gravatar.com/avatar.php?gravatar_id=87206f3bf53d403e16ec023c56e904c5&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://blog.codahale.com' rel='external nofollow' class='url'>Coda</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-863" title="">July 11th, 2006 at 12:19pm</a> </small>

			<p>Ian&#8211;Thanks a million for that. I was following some of the threads there myself, and I&#8217;ve added your suggestions to the article.</p>

		</li>

	
	
		<li class="alt " id="comment-870">
    <a href='http://blog.nanorails.com' title='Visit Pascal'><img src='http://www.gravatar.com/avatar.php?gravatar_id=615c3ad6684a2831d34bbc8b5d1d2015&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://blog.nanorails.com' rel='external nofollow' class='url'>Pascal</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-870" title="">July 11th, 2006 at 11:55pm</a> </small>

			<p>Great post Coda!   A lot of good ideas.  I was able to do an install Mac OS X Tiger (10.4.7) if someone&#8217;s interested.</p>
<p>Works greats so far.</p>
<p>Here&#8217;s the post: <a href="http://blog.nanorails.com/articles/2006/07/11/installing-rails-on-mac-os-x-tiger" rel="nofollow">http://blog.nanorails.com/articles/2006/07/11/installing-rails-on-mac-os-x-tiger</a></p>

		</li>

	
	
		<li class=" " id="comment-871">
    <a href='http://blog.nanorails.com/articles/2006/07/11/installing-rails-on-mac-os-x-tiger' title='Visit Installing Rails on Mac OS X Tiger'><img src='http://www.gravatar.com/avatar.php?gravatar_id=615c3ad6684a2831d34bbc8b5d1d2015&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://blog.nanorails.com/articles/2006/07/11/installing-rails-on-mac-os-x-tiger' rel='external nofollow' class='url'>Installing Rails on Mac OS X Tiger</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-871" title="">July 12th, 2006 at 12:33am</a> </small>

			<p>[...] If you are only looking for the basics, Locomotive is probably what you need, if you want a grown-up rails setup on Mac OS Tiger, read on. [...]</p>

		</li>

	
	
		<li class="alt " id="comment-872">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=20d9dc42111d67cd6ea1b58119c073fc&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Seth</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-872" title="">July 12th, 2006 at 12:34am</a> </small>

			<p>For those of us not yet on Capistrano, but just using a SCM like perforce&#8230;what&#8217;s the nice way to restart the mongrels after a server push?</p>

		</li>

	
	
		<li class=" official" id="comment-873">
    <a href='http://blog.codahale.com' title='Visit Coda'><img src='http://www.gravatar.com/avatar.php?gravatar_id=87206f3bf53d403e16ec023c56e904c5&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://blog.codahale.com' rel='external nofollow' class='url'>Coda</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-873" title="">July 12th, 2006 at 8:01am</a> </small>

			<p>Seth, you <em>really</em> should take the time to set up Capistrano. It&#8217;s maybe 30 minutes of work and <tt>cap deploy</tt> means never having to say sorry. Also, <a href="http://gemjack.com/gems/capistrano-1.1.0/classes/Capistrano/SCM/Perforce.html" rel="nofollow">it works with perforce</a>.</p>
<p>Besides that, if you&#8217;ve registered your Mongrel cluster as a service, the easiest way is to just restart that and let mongrel_cluster do its job.</p>
<p>On Redhat-ish Linuxes:</p>
<pre><code>server$ sudo /sbin/service mongrel_cluster stop
server$ sudo /sbin/service mongrel_cluster start</code></pre>
<p>On Debian-y Linuxes:</p>
<pre><code>server$ sudo /etc/init.d/mongrel_cluster stop
server$ sudo /etc/init.d/mongrel_cluster start</code></pre>
<p>Or if you haven&#8217;t been playing around with services, you can always use mongrel_cluster itself:</p>
<pre><code>server$ mongrel_rails cluster::stop -C /path/to/your/mongrel_cluster.yml
server$ mongrel_rails cluster::start -C /path/to/your/mongrel_cluster.yml</code></pre>
<p>But seriously&#8230; Capistrano.</p>

		</li>

	
	
		<li class="alt " id="comment-879">
    <a href='http://www.revoluser.com/2006/07/12/links-for-2006-07-12/' title='Visit revoluser.com - URLs will save the world'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://www.revoluser.com/2006/07/12/links-for-2006-07-12/' rel='external nofollow' class='url'>revoluser.com - URLs will save the world</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-879" title="">July 12th, 2006 at 10:45pm</a> </small>

			<p>[...] Time For A Grown-Up Server: Rails, Mongrel, Apache, Capistrano and You | Archives | codablog | Coda Hale Installing and deploying rails&#8230; (tags: rails rubyonrails webdev capistrano)   Technorati Tags: [...]</p>

		</li>

	
	
		<li class=" official" id="comment-881">
    <a href='http://blog.codahale.com' title='Visit Coda'><img src='http://www.gravatar.com/avatar.php?gravatar_id=87206f3bf53d403e16ec023c56e904c5&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://blog.codahale.com' rel='external nofollow' class='url'>Coda</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-881" title="">July 13th, 2006 at 3:51pm</a> </small>

			<p>Finally rolled in some of the advice on mongrel-users to choose the mod_rewrite [P] option over the ProxyPass directives. That way all the static content gets served by Apache, not Mongrel.</p>
<p>(Took me long enough, jeez.)</p>

		</li>

	
	
		<li class="alt " id="comment-896">
    <a href='http://devblog.famundo.com' title='Visit Guy Naor'><img src='http://www.gravatar.com/avatar.php?gravatar_id=cdc9615bf9cb6611a1e0a44dc12a1e8f&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://devblog.famundo.com' rel='external nofollow' class='url'>Guy Naor</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-896" title="">July 14th, 2006 at 4:51pm</a> </small>

			<p>One small note on deploying using svn.</p>
<p>My svn servers are all behind tightly controlled firewalls, and the only way to get at them is using ssh+svn using private/public key authentication (yes, I know, I&#8217;ve been called paranoid before). In addition, my servers get no access to the internet unless I manually poke a hole in the firewall temporarily - this help prevent downloading things into my machines even if there&#8217;s a security breach. This completely precludes using svn for deployment. But all is not lost!</p>
<p>The way I deploy is I changed the capistrano recipe for checking out the code to do a local export to a temp directory, tar.gz it, and copy it over ssh to the server. Then on the server it is untar.gz&#8217;d into the same directory a checkout would put it.</p>
<p>So all that changes is the update_code recipe, the rest is the same and you get a more secure setup.</p>

		</li>

	
	
		<li class=" official" id="comment-897">
    <a href='http://blog.codahale.com' title='Visit Coda'><img src='http://www.gravatar.com/avatar.php?gravatar_id=87206f3bf53d403e16ec023c56e904c5&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://blog.codahale.com' rel='external nofollow' class='url'>Coda</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-897" title="">July 14th, 2006 at 5:42pm</a> </small>

			<p>Guy, you&#8217;re paranoid. ;-)</p>
<p>(Also, you could probably use Subversion over SSL using client certificate authentication, but since you&#8217;ve gone to all that trouble&#8230; nice hack.)</p>

		</li>

	
	
		<li class="alt " id="comment-939">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=2d6180b74022589155f0a3635e20a8b7&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Chad</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-939" title="">July 18th, 2006 at 5:21pm</a> </small>

			<p>Coda,</p>
<p>I see you said you &#8220;rolled in some of the advice on mongrel-users to choose the mod_rewrite [P] option over the ProxyPass directives&#8221;  All I can tell is that you removed the ProxyPass directives.  I see the following in your myapp.common:</p>
<p># Redirect all non-static requests to clusterRewriteCond %{DOCUMENT_ROOT}/%{REQUEST_FILENAME} !-fRewriteRule ^/(.*)$ balancer://mongrel_cluster%{REQUEST_URI} [P,QSA,L]</p>
<p>So am I to assume that everything else is static and sendfile handles the handoff?  How can I see which files are being served by sendfile/apache?  The mongrel.log didn&#8217;t seem to tell me.  Any clarification of how this whole process works would be great!</p>

		</li>

	
	
		<li class=" " id="comment-947">
    <a href='http://nicolas-delsaux.is-a-geek.net/wordpress/index.php/archives/2006/debut-de-passage-a-ligthttpd/' title='Visit Le blog &raquo; Archive du blog &raquo; Début de passage à ligthttpd'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://nicolas-delsaux.is-a-geek.net/wordpress/index.php/archives/2006/debut-de-passage-a-ligthttpd/' rel='external nofollow' class='url'>Le blog &raquo; Archive du blog &raquo; Début de passage à ligthttpd</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-947" title="">July 19th, 2006 at 12:58am</a> </small>

			<p>[...] Comme j&#8217;ai envie de faire du Ruby chez moi, et que la solution Mongrel+Apache2 m&#8217;apparaît comme impossible à mettre en place sur mon Ubuntu, je suis en train de passer doucement à lighttpd et honnêtement, je suis séduit. Séduit par la simplicité apparente de la configuration et ses possibilités avancées (rha, le enhanced virtual hosting, ça m&#8217;a l&#8217;air génial, ça). Par contre, pour l&#8217;intégration de langages de scripts comme le PHP, ça me pose un petit souci, car il faudrait que j&#8217;installe PHP indépendament d&#8217;Apache, ce qui est difficle quand Synaptic se bloque automatiquement à chaque lancement. Mais ça, c&#8217;est un problème propre à la distribution que je travaille à résoudre. Tout ça pour dire quoi ? Simplement que le blog risque de devenir, pour un moment, un intermittent du web et que je m&#8217;en excuse. [...]</p>

		</li>

	
	
		<li class="alt " id="comment-1009">
    <a href='http://www.missiontomalawi.com' title='Visit Doug Johnston'><img src='http://www.gravatar.com/avatar.php?gravatar_id=8e2f776434e3b87f2e59509d968c70b7&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://www.missiontomalawi.com' rel='external nofollow' class='url'>Doug Johnston</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1009" title="">July 24th, 2006 at 12:09pm</a> </small>

			<p>Holy crap, that&#8217;s a great tutorial.  I&#8217;m ecstatic about my newly constructed Apache 2.2/Mongrel/Capistrano setup.  Thanks so much!</p>

		</li>

	
	
		<li class=" " id="comment-1014">
    <a href='http://blog.pomozov.info/posts/apache-mongrel-and-proxy-error.html' title='Visit Anatol Pomozov&#8217;s blog &raquo; Blog Archive &raquo; Apache, Mongrel and proxy error'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://blog.pomozov.info/posts/apache-mongrel-and-proxy-error.html' rel='external nofollow' class='url'>Anatol Pomozov&#8217;s blog &raquo; Blog Archive &raquo; Apache, Mongrel and proxy error</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1014" title="">July 25th, 2006 at 4:03am</a> </small>

			<p>[...] After reading this article I have became electric enough to try it on my current project that recently has gone to beta. [...]</p>

		</li>

	
	
		<li class="alt " id="comment-1033">
    <a href='http://blog.postpostmodern.com/' title='Visit Jason'><img src='http://www.gravatar.com/avatar.php?gravatar_id=0d98cde583585ab00b6fd6f1c69a4e7c&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://blog.postpostmodern.com/' rel='external nofollow' class='url'>Jason</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1033" title="">July 27th, 2006 at 3:57pm</a> </small>

			<p>Great article. My new CRAM setup works *almost* perfectly. Anyone know  why adding basic authentication into the Apache config doesn&#8217;t work? I get 404 errors for all static pages and no auth for the rails app.</p>

		</li>

	
	
		<li class=" " id="comment-1048">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=0bcc972918891ef358b0b3dfb4e7f18b&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Hammed</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1048" title="">July 29th, 2006 at 8:27am</a> </small>

			<p>I just got a VPS account on rimuhosting.com which has Debian Sarge installed which doesn&#8217;t have an apt package for apache2.2. Any tips on building it from source with mod_proxy_balancer?</p>

		</li>

	
	
		<li class="alt " id="comment-1051">
    <a href='http://anthonyeden.com/articles/2006/07/29/mongrel-cluster' title='Visit Mongrel Cluster'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://anthonyeden.com/articles/2006/07/29/mongrel-cluster' rel='external nofollow' class='url'>Mongrel Cluster</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1051" title="">July 29th, 2006 at 3:16pm</a> </small>

			<p>[...] I just completed switching over Pecuniarius to use mongrel cluster. It would have probably been easy except that I had Apache 2.0 installed so that meant I needed to upgrade, and naturally I took the long route to do that (build from source numerous times until I got it just right) but I finally got Apache 2.2 with modproxybalance installed and hooked it up to a brand spankin new mongrel cluster following the instructions on Code Hale&#8217;s blog (there is no way that&#8217;s a real name, but if it is its quite cool). This blog along with symphoniou.us are still running on single mongrel instances, but I&#8217;ll fix that soon. [...]</p>

		</li>

	
	
		<li class=" official" id="comment-1052">
    <a href='http://blog.codahale.com' title='Visit Coda'><img src='http://www.gravatar.com/avatar.php?gravatar_id=87206f3bf53d403e16ec023c56e904c5&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://blog.codahale.com' rel='external nofollow' class='url'>Coda</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1052" title="">July 29th, 2006 at 7:09pm</a> </small>

			<p>Chad&#8211;those are indeed the changes. To see who&#8217;s serving up what, you can crack open a terminal and type <code>curl -v (the URL) &gt; /dev/null</code> and it&#8217;ll print out the headers, which will include the server type. The general process is that Apache checks to see if the file exists on disk (if it doesn&#8217;t have a file extension, it assumes it&#8217;s .html). If it does, Apache serves it up. Otherwise, the request is proxied to Mongrel.</p>

		</li>

	
	
		<li class="alt official" id="comment-1053">
    <a href='http://blog.codahale.com' title='Visit Coda'><img src='http://www.gravatar.com/avatar.php?gravatar_id=87206f3bf53d403e16ec023c56e904c5&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://blog.codahale.com' rel='external nofollow' class='url'>Coda</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1053" title="">July 29th, 2006 at 7:18pm</a> </small>

			<p>Jason&#8211;I&#8217;m totally calling this setup CRAM from now on. Sounds much more aggressive than LAMP. No idea about your authentication issues&#8211;it works fine for me.</p>
<p>Hammed&#8211;Sorry, haven&#8217;t done that. You may want to ask the folks at RimuHosting if you can switch over to Ubuntu, which has 2.2 packaged. Failing that, I&#8217;m sure the folks in #apache or #debian would have some decent advice on the matter.</p>

		</li>

	
	
		<li class=" " id="comment-1069">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=0bcc972918891ef358b0b3dfb4e7f18b&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Hammed</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1069" title="">July 31st, 2006 at 7:18am</a> </small>

			<p>Thanks Coda, I was able to build Apache 2.2 from source - I had assumed it to be more complex than it turned out to be. Later I found instructions for the same in this post on the rimuhosthing forms:</p>
<p><a href="http://forums.rimuhosting.com/forums/showthread.php?t=230" rel="nofollow">http://forums.rimuhosting.com/forums/showthread.php?t=230</a></p>
<p>I&#8217;ve successfullly tested mongrel clusters on the server (yay!) but with capistrano and the same mongrel_cluster.yml, mongrel doesn&#8217;t start and complains</p>
<p>!!! Path to log file not valid: log/mongrel.log</p>
<p>It appears to be a simlink issue but I haven&#8217;t figured it out yet. Any ideas?</p>

		</li>

	
	
		<li class="alt " id="comment-1084">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=0bcc972918891ef358b0b3dfb4e7f18b&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Hammed</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1084" title="">August 1st, 2006 at 3:57am</a> </small>

			<p>guys, make sure to run</p>
<p>rake remote:setup</p>
<p>before</p>
<p>cap cold_deploy</p>
<p>or you&#8217;ll get the !!! Path to log file not valid: log/mongrel.log error I was getting. The shared/log folder is created by the setup task. Duh.</p>

		</li>

	
	
		<li class=" " id="comment-1097">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=82ee7078af672c28ac1f4909bdae7d4d&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Michael Cho</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1097" title="">August 1st, 2006 at 7:45pm</a> </small>

			<p>guys&#8230;i&#8217;m a 2-month old newbie to the web-programming world&#8230;but Rails been a blast to play with&#8230;thou I can&#8217;t say for the deployment part (yet)&#8230;</p>
<p>in any case, has anyone bump into this error while doing that &#8220;cap deploy&#8221; (i have a mongrel_rails restart task in my deploy.rb)?</p>
<p>** [out ] ** You have sendfile installed, will use that to serve files.<br />
 ** [out ] !!! PID file log/mongrel.pid does not exist. Not running?<br />
 ** [out ] restart reported an error. Use mongrel_rails restart -h to get help.</p>
<p>Is that because when I subversion the project I ignored and removed the log files (as per the &#8220;HowtoUseRailsWithSubversion&#8221; guide)?</p>
<p>Coda: thanks so much for the post! I&#8217;m learning alot going thro the steps! So u&#8217;r from Berkeley too? Did you go to that awesome kite festival over the weekend?</p>
<p>peace folks..</p>

		</li>

	
	
		<li class="alt official" id="comment-1100">
    <a href='http://blog.codahale.com' title='Visit Coda'><img src='http://www.gravatar.com/avatar.php?gravatar_id=87206f3bf53d403e16ec023c56e904c5&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://blog.codahale.com' rel='external nofollow' class='url'>Coda</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1100" title="">August 1st, 2006 at 10:11pm</a> </small>

			<p>Michael&#8211;You may want to check out Hammed&#8217;s comment right above yours. Either you need to create the <code>log</code> directory, you need to give write permissions on the <code>log</code> directory to the user account that&#8217;s running the Mongrel processes, or you&#8217;re trying to <code>cap deploy</code> when you should be running <code>cap cold_deploy</code> (or even <code>cap setup</code>).</p>
<p>(And yeah&#8211;I&#8217;m in Berkeley. Didn&#8217;t go to the kite festival, but I see them occasionally when I ride my bike along the bay to Richmond.)</p>

		</li>

	
	
		<li class=" " id="comment-1116">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=b0b8f3f28444a885f7ad6d61aad70225&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Armando</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1116" title="">August 3rd, 2006 at 2:21pm</a> </small>

			<p>Hey all &#8212; great tutorial so far, but I&#8217;ve hit a snag.  I&#8217;m in the &#8220;Testing your cluster&#8221; section, and when mongrel_cluster tries to start, I get (output from only one of the 3 / it&#8217;s repeated 3 times):<br />
&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8211;<br />
** Daemonized, any open files are closed.  Look at log/mongrel.8002.pid and log/mongrel.log for info.<br />
** Starting Mongrel listening at 127.0.0.1:8002<br />
** Starting Rails with production environment &#8230;<br />
/usr/lib/ruby/gems/1.8/gems/mongrel-0.3.13.3/lib/mongrel.rb:666:in `register&#8217;: undefined method `resolve&#8217; for nil:Mongrel::URIClassifier (NoMethodError)<br />
	from /usr/lib/ruby/gems/1.8/gems/mongrel-0.3.13.3/lib/mongrel.rb:850:in `uri&#8217;<br />
	from /usr/lib/ruby/gems/1.8/gems/mongrel-0.3.13.3/bin/mongrel_rails:112:in `cloaker_&#8217;<br />
	from /usr/lib/ruby/gems/1.8/gems/mongrel-0.3.13.3/lib/mongrel.rb:832:in `listener&#8217;<br />
	from /usr/lib/ruby/gems/1.8/gems/mongrel-0.3.13.3/bin/mongrel_rails:96:in `cloaker_&#8217;<br />
	from /usr/lib/ruby/gems/1.8/gems/mongrel-0.3.13.3/lib/mongrel.rb:750:in `initialize&#8217;<br />
	from /usr/lib/ruby/gems/1.8/gems/mongrel-0.3.13.3/bin/mongrel_rails:83:in `run&#8217;<br />
	from /usr/lib/ruby/gems/1.8/gems/mongrel-0.3.13.3/lib/mongrel/command.rb:199:in `run&#8217;<br />
	from /usr/lib/ruby/gems/1.8/gems/mongrel-0.3.13.3/bin/mongrel_rails:235<br />
	from /usr/bin/mongrel_rails:18<br />
&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8211;<br />
&#8230; so, I&#8217;m basically unable to continue.  Any thoughts?</p>
<p>- I noticed the comment about not using sendfile, so I&#8217;ve removed that<br />
- mongrel 0.3.13.3<br />
- mongrel_cluster 0.2.0<br />
- daemons 0.4.3<br />
- gem_plugin 0.2.1</p>
<p>I&#8217;ve inspected the code at /usr/lib/ruby/gems/1.8/gems/mongrel-0.3.13.3/lib/mongrel.rb line 666, and it looks like the classifier member isn&#8217;t getting initialized for some reason. :-\</p>

		</li>

	
	
		<li class="alt " id="comment-1118">
    <a href='http://www.jonsthoughtsoneverything.com' title='Visit Jon Maddox'><img src='http://www.gravatar.com/avatar.php?gravatar_id=366472c969c9754ae2b8079e42fed1ca&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://www.jonsthoughtsoneverything.com' rel='external nofollow' class='url'>Jon Maddox</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1118" title="">August 3rd, 2006 at 4:40pm</a> </small>

			<p>ouch, i just set up my first cluster last night. I&#8217;m glad i came back here to reference the post again. Sendfile goes from the secret sauce to a bad influence? yikes&#8230;</p>

		</li>

	
	
		<li class=" " id="comment-1120">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=b0b8f3f28444a885f7ad6d61aad70225&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Armando</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1120" title="">August 3rd, 2006 at 10:08pm</a> </small>

			<p>To clear up my comment #78 &#8230; I was completely stumped.  Then I recompiled ruby, and re-gem-installed all my gems, and then things worked.  I had a hard lock-up on my laptop a few weeks ago, so *maybe* some core ruby files got mangled.  Otherwise, I have not idea.  Anyways, thanks for the tutorial &#8212; it was quite helpful.</p>

		</li>

	
	
		<li class="alt " id="comment-1123">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=973791dff4fcac45370941640b15f3a1&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Otim</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1123" title="">August 4th, 2006 at 6:04pm</a> </small>

			<p>Coda,<br />
i&#8217;ve got the mongrels doing their thing.  its great.  but apache mucks up the whole things.  don&#8217;t think i have my virtualhosts right.  could you please post a sample config of apache setup using name based virtual hosting?</p>

		</li>

	
	
		<li class=" " id="comment-1140">
    <a href='http://blog.postpostmodern.com/2006/08/07/dog-days-of-an-indian-summer/' title='Visit [post]PostModern &raquo; Blog Archive &raquo; Dog Days of an Indian Summer'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://blog.postpostmodern.com/2006/08/07/dog-days-of-an-indian-summer/' rel='external nofollow' class='url'>[post]PostModern &raquo; Blog Archive &raquo; Dog Days of an Indian Summer</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1140" title="">August 7th, 2006 at 7:16pm</a> </small>

			<p>[...] I&#8217;m talking about Capistrano, Rails, Apache, Mongrel. Coda Hale wrote a great article on setting it up. I used his basic procedure, tailored it to my specific needs/personality, and voila! CRAM! [...]</p>

		</li>

	
	
		<li class="alt " id="comment-1143">
    <a href='http://blog.crispynews.com' title='Visit bathow'><img src='http://www.gravatar.com/avatar.php?gravatar_id=ce92171cc69cf04a5e360d6d13485b19&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://blog.crispynews.com' rel='external nofollow' class='url'>bathow</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1143" title="">August 7th, 2006 at 11:49pm</a> </small>

			<p>Mongrel is the way to go. after struggling with FastCGI and the mysterious hangs, we finally gave up and switched over. Aside from seeing Rails last year as the choice platform, this is the best decision we&#8217;ve made on the architecture side.</p>
<p>now <a href="http://www.crispynews.com" rel="nofollow">crispynews</a> is humming along beautifully</p>

		</li>

	
	
		<li class=" " id="comment-1160">
    <a href='http://www.greedymoney.com' title='Visit Ashish'><img src='http://www.gravatar.com/avatar.php?gravatar_id=ac49d279654f14339d1a790a610434ef&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://www.greedymoney.com' rel='external nofollow' class='url'>Ashish</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1160" title="">August 9th, 2006 at 6:49am</a> </small>

			<p>Hi Coda,</p>
<p>I am using Apache httpd 2.0.54 on Fedora Core 4.</p>
<p>I tried to follow your instructions as well as those from various websites.</p>
<p>However, getting Mongrel to run was a losing battle.</p>
<p>I tried to upgrade to httpd 2.2.x. I also tried to upgrade my Fedora installation to Fedora Core 5. But only managed to break everything else including Plesk.</p>
<p>Finally, I am back after a re-imaging of the server back at Fedora Core 4 with httpd 2.0.54.</p>
<p>Does Mongrel run with Apache 2.0.54?</p>
<p>If yes, can you please provide me with some help to setup Capistrano and SubVersion?</p>
<p>Currently I am running Rails using Apache+CGI.</p>
<p>Regards,</p>
<p>Ashish.</p>

		</li>

	
	
		<li class="alt " id="comment-1165">
    <a href='http://bryan.e4industries.com/2006/08/09/apache2-mongrel-tiger-and-proxy-loadhandling-install-guide/' title='Visit bryanthompson&#8217;s blog &raquo; Blog Archive &raquo; Apache2, Mongrel, Tiger, and proxy loadhandling install guide'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://bryan.e4industries.com/2006/08/09/apache2-mongrel-tiger-and-proxy-loadhandling-install-guide/' rel='external nofollow' class='url'>bryanthompson&#8217;s blog &raquo; Blog Archive &raquo; Apache2, Mongrel, Tiger, and proxy loadhandling install guide</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1165" title="">August 9th, 2006 at 1:38pm</a> </small>

			<p>[...] 3. Install mongrel (via <a href="http://blog.codahale.com/2006/06/19/time-for-a-grown-up-server-rails-mongrel-apache-capistrano-and-you/" rel="nofollow">http://blog.codahale.com/2006/06/19/time-for-a-grown-up-server-rails-mongrel-apache-capistrano-and-you/</a>): sudo gem install daemons gem_plugin mongrel mongrel_cluster &#8211;include-dependencies [...]</p>

		</li>

	
	
		<li class=" " id="comment-1178">
    <a href='http://weblog.thinksplat.com/?p=17' title='Visit ThinkSplat Blog &raquo; Apache + mongrel'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://weblog.thinksplat.com/?p=17' rel='external nofollow' class='url'>ThinkSplat Blog &raquo; Apache + mongrel</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1178" title="">August 11th, 2006 at 9:50am</a> </small>

			<p>[...] This post is heavily influenced by the Time For A Grown-Up Server web page. I highly recommend you read that web page too for a more in-depth commentary of why you would want to do this. [...]</p>

		</li>

	
	
		<li class="alt " id="comment-1189">
    <a href='http://www.faqqly.com' title='Visit steve dp'><img src='http://www.gravatar.com/avatar.php?gravatar_id=cd4f9ba2512f984481b5b00279cee69a&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://www.faqqly.com' rel='external nofollow' class='url'>steve dp</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1189" title="">August 13th, 2006 at 12:38am</a> </small>

			<p>Awesome stuff man!</p>

		</li>

	
	
		<li class=" " id="comment-1207">
    <a href='http://www.puneruby.com/forum/viewtopic.php?t=13' title='Visit Ashish Kulkarni'><img src='http://www.gravatar.com/avatar.php?gravatar_id=16f8e78694968a4838d3a47ca23839db&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://www.puneruby.com/forum/viewtopic.php?t=13' rel='external nofollow' class='url'>Ashish Kulkarni</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1207" title="">August 14th, 2006 at 2:34pm</a> </small>

			<p>Managed to finally get Rails to run with Fedora Core 4, Apache 2.0.54 and SCGI.</p>
<p><a href="http://www.puneruby.com/forum/viewtopic.php?t=13" rel="nofollow">Details of the configuration</a></p>

		</li>

	
	
		<li class="alt " id="comment-1226">
    <a href='http://www.alien8recordings.com' title='Visit Sean O'Hara'><img src='http://www.gravatar.com/avatar.php?gravatar_id=0747214fd9c3537493494b1612a686de&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://www.alien8recordings.com' rel='external nofollow' class='url'>Sean O'Hara</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1226" title="">August 15th, 2006 at 3:05pm</a> </small>

			<p>Is there any way to have specific directories point to something other than the mongrel cluster? For instance I have a /stats directory that I would like to maintain access to for web stats. But with the current setup it my Alias in apache for it is ignored. I tried adding ProxyPass /stats ! to my config but it doesn&#8217;t work. Any ideas?</p>

		</li>

	
	
		<li class=" " id="comment-1241">
    <a href='http://www.simplisticcomplexity.com' title='Visit Jon Maddox'><img src='http://www.gravatar.com/avatar.php?gravatar_id=366472c969c9754ae2b8079e42fed1ca&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://www.simplisticcomplexity.com' rel='external nofollow' class='url'>Jon Maddox</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1241" title="">August 17th, 2006 at 12:46am</a> </small>

			<p>Sean, I just resolved that problem today by just using a subdomain. My weblog is powered by mephisto, and i&#8217;m using mint for stats. I put mint on a subdomain and they&#8217;re living happily with each other.</p>

		</li>

	
	
		<li class="alt " id="comment-1299">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=db2175eb86669d396b8596d11478f5ef&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Cayce</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1299" title="">August 23rd, 2006 at 8:09am</a> </small>

			<p>I&#8217;m having a ton of trouble getting my rails app firing. If I run just my mongrel cluster I can see my rails app going to <a href="http://10.104.0.121/website/index" rel="nofollow">http://10.104.0.121/website/index</a>. I can also see the rolling on rails intro page at <a href="http://10.104.0.121" rel="nofollow">http://10.104.0.121</a>.</p>
<p>However, once I fire up Apache, I still get the rolling on rails intro page, but my app doesn&#8217;t fire. I get the following errors in my log:</p>
<p>[Wed Aug 23 11:03:29 2006] [error] [client 10.70.120.45] no authorization providers configured<br />
[Wed Aug 23 11:03:29 2006] [error] [client 10.70.120.45] File does not exist: /home/rails/prtrack/public/website</p>
<p>I don&#8217;t have the server dns setup yet, not sure if that has any impact. It just seems that Apache is not routing non-static requests to the cluster the right way.</p>
<p>I&#8217;d really appreciate any help, pointers or guidance in the right direction.<br />
c.</p>

		</li>

	
	
		<li class=" " id="comment-1312">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=db2175eb86669d396b8596d11478f5ef&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Cayce</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1312" title="">August 25th, 2006 at 2:25pm</a> </small>

			<p>I have narrowed the problem down to rewrite rules. I have my rails app firing now. I am getting log information on rewrites, so I know that mod_rewrite is operating. It appears, however, that rewrite rules in my railsapp/public/.htaccess file are overriding those in my .conf file(s). Never does the rule invoking the proxy get executed. I have tried setting AllowOverride All/None for various subdirectories in my .conf file to no avail - either the server comes back with &#8220;file not found&#8221; or it executes the rails app via apache &gt; dispatch.cgi and avoids the mongrel proxy.</p>
<p>Again, any assistance would be greatly appreciated.</p>

		</li>

	
	
		<li class="alt official" id="comment-1314">
    <a href='http://blog.codahale.com' title='Visit Coda'><img src='http://www.gravatar.com/avatar.php?gravatar_id=87206f3bf53d403e16ec023c56e904c5&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://blog.codahale.com' rel='external nofollow' class='url'>Coda</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1314" title="">August 25th, 2006 at 3:16pm</a> </small>

			<p>Cayce&#8211;You can uncomment the rewrite debugging levels in the configs and check the Apache logs for more possibilities. You may also want to check out the #apache channel on Freenode. They&#8217;re very helpful.</p>

		</li>

	
	
		<li class=" " id="comment-1319">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=db2175eb86669d396b8596d11478f5ef&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Cayce</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1319" title="">August 26th, 2006 at 6:59am</a> </small>

			<p>Turning on those logs is how I figured out what I have to this point. It&#8217;s very strange - I can see the various rewrite rules firing in the log file, but it&#8217;s only the ones from the rails app public/.htaccess file. It&#8217;s just never getting to/firing any of the rewrite rules from my .conf file(s) setup per your article.</p>
<p>In any event - it&#8217;s a problem with rewrite rules on my setup, not anything with your article, which successfully got me <i>almost</i> there. I appreciate the help. I&#8217;ll check out the freenode channel.</p>

		</li>

	
	
		<li class="alt " id="comment-1352">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=db2175eb86669d396b8596d11478f5ef&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Cayce</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1352" title="">August 28th, 2006 at 3:01pm</a> </small>

			<p>Just an update - put my app in a sub-folder, used ProxyPass as noted by Dan M. above with Cyrus&#8217; reverse_proxy_fix plug-in and everything is smooth sailing now.</p>

		</li>

	
	
		<li class=" " id="comment-1358">
    <a href='http://macnewbie.wordpress.com' title='Visit Dave'><img src='http://www.gravatar.com/avatar.php?gravatar_id=07e80e95e01f577c15e2fc50bb5f328a&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://macnewbie.wordpress.com' rel='external nofollow' class='url'>Dave</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1358" title="">August 30th, 2006 at 7:42am</a> </small>

			<p>I am probably missing something really simple here but I dont really understand what the -c parameter is pointing to in the cluster::configure command:</p>
<p>[workstation]$ mongrel_rails cluster::configure -e production \<br />
  -p 8000 \<br />
  -a 127.0.0.1 \<br />
  -N 3 \<br />
  -c /path/to/your/capistrano/setup&#8217;s/current</p>
<p>Path to my capistrano setup&#8217;s current what?</p>
<p>What path is that supposed to be pointing to? The path to my deploy.rb?</p>

		</li>

	
	
		<li class="alt " id="comment-1359">
    <a href='http://macnewbie.wordpress.com' title='Visit Dave'><img src='http://www.gravatar.com/avatar.php?gravatar_id=07e80e95e01f577c15e2fc50bb5f328a&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://macnewbie.wordpress.com' rel='external nofollow' class='url'>Dave</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1359" title="">August 30th, 2006 at 8:20am</a> </small>

			<p>Ohhhhh, I get it&#8230; path to my capistrano setup&#8217;s &#8220;current&#8221; folder&#8230;</p>
<p>Sorry, dumb of me</p>

		</li>

	
	
		<li class=" " id="comment-1361">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=8376c706e1ae9310e1385c5240cfd949&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Devin</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1361" title="">August 30th, 2006 at 3:28pm</a> </small>

			<p>During deploy capistrano is unable to locate my executables (svn, mongrel_cluster, etc.).  If I use<br />
set :svn, &#8220;/usr/local/subversion/bin/svn&#8221;<br />
in the deploy.rb file it executes the checkout fine, but still can&#8217;t find mongrel_cluster.  Is there a way to explicitly set the location of your ruby bin directory?  Or better yet, anyone know why capistrano is losing the path?  The locations are in the path when I log in via ssh with the same user set in deploy.rb. Why aren&#8217;t they found by capistrano?  I&#8217;m still a bit new to linux. Do scripts use a different path then the current user?  If so, where can I set it?</p>

		</li>

	
	
		<li class="alt " id="comment-1362">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=8376c706e1ae9310e1385c5240cfd949&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Devin</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1362" title="">August 30th, 2006 at 3:36pm</a> </small>

			<p>Just noticed a typo in my comment, mongrel_cluster should be read mongrel_rails.</p>
<p>if it helps the errors I&#8217;m getting from running cap cold_deploy:</p>
<p>  bash: line 2: svn: command not found</p>
<p>and then when I set :svn, “/usr/local/subversion/bin/svn” to get passed that error I get</p>
<p>  sudo: mongrel_rails: command not found</p>
<p>again, the commands causing the error run fine when I ssh with the user i&#8217;ve set in deploy.rb</p>

		</li>

	
	
		<li class=" " id="comment-1364">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=4aeb3254455abfbfff5969a1b032080d&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Erin</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1364" title="">August 31st, 2006 at 3:43am</a> </small>

			<p>Hi Code,</p>
<p>Thanks for the post, it was really helpful.</p>
<p>I have one small point which is that rewrite only checks for static files before the request is passed to Mongrel.  The following code checks for directories as well.</p>
<p><code><br />
  # Redirect all non-static requests to cluster<br />
  RewriteCond %{DOCUMENT_ROOT}/%{REQUEST_FILENAME} !-f<br />
  RewriteCond %{DOCUMENT_ROOT}/%{REQUEST_FILENAME} !-d<br />
  RewriteRule ^/(.*)$ balancer://mongrel_cluster%{REQUEST_URI}<br />
</code></p>
<p>Erin,</p>

		</li>

	
	
		<li class="alt " id="comment-1365">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=8376c706e1ae9310e1385c5240cfd949&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Devin</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1365" title="">August 31st, 2006 at 9:34am</a> </small>

			<p>Regarding my previous comments (98 &amp; 99):</p>
<p>I found creating symbolic links for the svn and mongrel_rails executables in /usr/bin works for now.  I&#8217;d rather not have to do it this way, but it got me up and running so it&#8217;s acceptable until I have more time to figure out a better way.</p>

		</li>

	
	
		<li class=" " id="comment-1366">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d85d44a0eca045f40e5a31449277c26c&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Ben Marini</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1366" title="">August 31st, 2006 at 2:18pm</a> </small>

			<p>Nice article, really crucial information that&#8217;s hard to figure out otherwise. Why isn&#8217;t this article on Mongrel&#8217;s <a href="http://mongrel.rubyforge.org/docs/apache.html" title="" rel="nofollow">Apache Best Deployment Documetation</a>?? It&#8217;s got my vote.</p>

		</li>

	
	
		<li class="alt " id="comment-1378">
    <a href='http://bryan.e4industries.com/2006/08/29/22/' title='Visit bryanthompson&#8217;s blog &raquo; Blog Archive &raquo; Apache 2.2 + Mongrel on Fedora Core 5 installation guide'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://bryan.e4industries.com/2006/08/29/22/' rel='external nofollow' class='url'>bryanthompson&#8217;s blog &raquo; Blog Archive &raquo; Apache 2.2 + Mongrel on Fedora Core 5 installation guide</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1378" title="">September 5th, 2006 at 6:59pm</a> </small>

			<p>[...] There is a lot more that can be done, especially in the ways of secure your server, blocking off access to the cluster from outside, this will be built upon. Thanks to the excellent Coda Hale guide, as well as Bryan&#8217;s guide from here. If you have any comments or suggestions, please leave them here or email <a href="mailto:kc0dxb@gmail.com">kc0dxb@gmail.com</a> [...]</p>

		</li>

	
	
		<li class=" " id="comment-1397">
    <a href='http://www.supersonicfeet.com/1999/11/30/cpanel-apache-22-mod_proxy_balancer-mongrel_cluster-hours-of-frustration-e2809cahhh-it-workse2809d/' title='Visit supersonic feet &raquo; cPanel + Apache 2.2 + mod_proxy_balancer + mongrel_cluster + hours of frustration = “ahhh, it works” Blog Archive'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://www.supersonicfeet.com/1999/11/30/cpanel-apache-22-mod_proxy_balancer-mongrel_cluster-hours-of-frustration-e2809cahhh-it-workse2809d/' rel='external nofollow' class='url'>supersonic feet &raquo; cPanel + Apache 2.2 + mod_proxy_balancer + mongrel_cluster + hours of frustration = “ahhh, it works” Blog Archive</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1397" title="">September 10th, 2006 at 4:22pm</a> </small>

			<p>[...] Time For A Grown-Up Server: Rails, Mongrel, Apache, Capistrano and You, by Coda Hale. I missed out the Capistrano bit here as I don’t use it yet, but if you do then clicky linky. [...]</p>

		</li>

	
	
		<li class="alt " id="comment-1399">
    <a href='http://www.michaelbuffington.com/articles/2006/09/11/mongrel-and-capistrano' title='Visit Mongrel and Capistrano'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://www.michaelbuffington.com/articles/2006/09/11/mongrel-and-capistrano' rel='external nofollow' class='url'>Mongrel and Capistrano</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1399" title="">September 11th, 2006 at 4:24pm</a> </small>

			<p>[...] I settled on a pretty clean setup today to make this kind of thing dead simple. I&#8217;m assuming you&#8217;re already familiar with how to setup mongrel clusters, and that you&#8217;ve got the balancer in Apache or whatever forward httpd server figured out and running. [...]</p>

		</li>

	
	
		<li class=" " id="comment-1422">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=c9924d40ef0292f06a45939d1b2a20b4&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Colin</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1422" title="">September 15th, 2006 at 7:36am</a> </small>

			<p>Coda,<br />
I suspect this may be a capistrano problem but maybe not since no one else seems to have ran into this:</p>
<p>I am trying to do a test deploy where my &#8220;server&#8221; is the same as my workstation is the same as my svn repository (host = tenfwd.mcmaster.ca). I followed your instructions and everything worked fine up to the &#8220;cap cold_deploy&#8221; step. Executing this I get:</p>
<blockquote><p>
&#8230;<br />
  * querying latest revision&#8230;<br />
  * executing &#8220;if [[ ! -d /tmp/cssdb/releases/20060915142450 ]]; then\n              svn co  -q -r5 <a href="http://tenfwd.mcmaster.ca/repos/css" rel="nofollow">http://tenfwd.mcmaster.ca/repos/css</a> /tmp/cssdb/releases/20060915142450 &amp;&amp;\n              (test -e /tmp/cssdb/revisions.log || touch /tmp/cssdb/revisions.log &amp;&amp; chmod 666 /tmp/cssdb/revisions.log) &amp;&amp; echo `date +\&#8221;%Y-%m-%d %H:%M:%S\&#8221;` $USER 5 20060915142450 &gt;&gt; /tmp/cssdb/revisions.log;\n            fi&#8221;<br />
    servers: ["tenfwd.mcmaster.ca"]<br />
Password:<br />
    [tenfwd.mcmaster.ca] executing command<br />
 ** [out :: tenfwd.mcmaster.ca] if: Expression Syntax.<br />
    command finished<br />
*** [update_code] transaction: rollback<br />
&#8230;<br />
rake aborted!<br />
command &#8220;if [[ ! -d /tmp/cssdb/releases/20060915142450 ]]; then\\\n              svn co  -q -r5 <a href="http://tenfwd.mcmaster.ca/repos/css" rel="nofollow">http://tenfwd.mcmaster.ca/repos/css</a> /tmp/cssdb/releases/20060915142450 &amp;&amp;\\\n              (test -e /tmp/cssdb/revisions.log || touch /tmp/cssdb/revisions.log &amp;&amp; chmod 666 /tmp/cssdb/revisions.log) &amp;&amp; echo `date +\&#8221;%Y-%m-%d %H:%M:%S\&#8221;` $USER 5 20060915142450 &gt;&gt; /tmp/cssdb/revisions.log;\\\n            fi&#8221; failed on tenfwd.mcmaster.ca
</p></blockquote>
<p>This seems to be telling me there is a syntax error in the &#8220;if&#8221; command but I have no idea where to find that particular command.</p>
<p>Help, please!</p>

		</li>

	
	
		<li class="alt " id="comment-1423">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=c9924d40ef0292f06a45939d1b2a20b4&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Colin</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1423" title="">September 15th, 2006 at 10:49am</a> </small>

			<p>Re: post 106</p>
<p>Nevermind. After much gnashing of teeth and googling of web found out it was my shell: I use tcsh. Had to create another id that uses bash and add &#8217;set :user, &#8220;username&#8221;&#8216; to deploy.rb.</p>
<p>Thanks for the article.</p>

		</li>

	
	
		<li class=" " id="comment-1442">
    <a href='http://faqqly.com' title='Visit steve'><img src='http://www.gravatar.com/avatar.php?gravatar_id=cd4f9ba2512f984481b5b00279cee69a&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://faqqly.com' rel='external nofollow' class='url'>steve</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1442" title="">September 19th, 2006 at 1:27am</a> </small>

			<p>There is an issue with mod_rewrite when it finally passes the request along to the balancer&#8230;</p>
<p>If you have any escaped question marks (%3F) in your request, mod_rewrite will unescape them for you, so the balancer then parses what&#8217;s after the now-unescaped question mark as a query string (which is what you don&#8217;t want).  Say for example you goto yoursite.com/users/user_name_with_a_%3F_in_it , that won&#8217;t work because rails will only see /users/user_name_with_a_ and the rest will be part of the query string&#8230;</p>
<p>I googled for a while and found a few places mentioning this problem.  You can use:<br />
<code><br />
RewriteMap escape int:escape<br />
</code><br />
and then use the function ${escape:$some_var} to re-escape the un-escaped URI in your RewriteRule&#8230; but I haven&#8217;t been able to figure it out yet.</p>
<p>I tried a lot of things including ${escape:%{REQUEST_URI}} and none of them seemed to work.</p>
<p>Anyone have any ideas?</p>
<p>two helpful links:<br />
<a href="http://mail-archives.apache.org/mod_mbox/httpd-users/200510.mbox/%3C8C29B2F93BAE9047A906EF6D6F9C5D439EFD77@exchange2k301.gaia.fr%3E" rel="nofollow">http://mail-archives.apache.org/mod_mbox/httpd-users/200510.mbox/%3C8C29B2F93BAE9047A906EF6D6F9C5D439EFD77@exchange2k301.gaia.fr%3E</a><br />
<a href="http://www.cherrypy.org/wiki/BehindApache" rel="nofollow">http://www.cherrypy.org/wiki/BehindApache</a></p>

		</li>

	
	
		<li class="alt " id="comment-1447">
    <a href='http://woss.name/2006/09/19/setting-up-an-amazon-ec2-server-with-fedora-core-5/' title='Visit Setting up an Amazon EC2 server with Fedora Core 5 at Notes from a messy desk'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://woss.name/2006/09/19/setting-up-an-amazon-ec2-server-with-fedora-core-5/' rel='external nofollow' class='url'>Setting up an Amazon EC2 server with Fedora Core 5 at Notes from a messy desk</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1447" title="">September 19th, 2006 at 11:19am</a> </small>

			<p>[...] OK, so it&#8217;s not a huge step, but we&#8217;re all agile around here, aren&#8217;t we? Hopefully now you&#8217;re comfortable with creating your own AMI and confident with the fact that the new image will boot. The next instalment will involve setting up a reusable Apache, mongrel and rails setup, much like is described in time for a grown up server since that&#8217;s pretty much my favourite rails deployment recipe. And we&#8217;ll create an AMI for that so that deploying a new rails app, with a little trickery from capistrano, is a turnkey solution. [...]</p>

		</li>

	
	
		<li class=" " id="comment-1448">
    <a href='http://woss.name/2006/09/19/setting-up-an-amazon-ec2-server-with-fedora-core-5/' title='Visit Setting up an Amazon EC2 server with Fedora Core 5 at Notes from a messy desk'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://woss.name/2006/09/19/setting-up-an-amazon-ec2-server-with-fedora-core-5/' rel='external nofollow' class='url'>Setting up an Amazon EC2 server with Fedora Core 5 at Notes from a messy desk</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1448" title="">September 19th, 2006 at 11:19am</a> </small>

			<p>[...] OK, so it&#8217;s not a huge step, but we&#8217;re all agile around here, aren&#8217;t we? Hopefully now you&#8217;re comfortable with creating your own AMI and confident with the fact that the new image will boot. The next instalment will involve setting up a reusable Apache, mongrel and rails setup, much like is described in time for a grown up server since that&#8217;s pretty much my favourite rails deployment recipe. And we&#8217;ll create an AMI for that so that deploying a new rails app, with a little trickery from capistrano, is a turnkey solution. [...]</p>

		</li>

	
	
		<li class="alt " id="comment-1450">
    <a href='http://leancode.com/2006/09/20/site-monitoring-shared-host-vs-dedicated/' title='Visit leancode.com &raquo; Archives &raquo; Site Monitoring Shared Host vs Dedicated'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://leancode.com/2006/09/20/site-monitoring-shared-host-vs-dedicated/' rel='external nofollow' class='url'>leancode.com &raquo; Archives &raquo; Site Monitoring Shared Host vs Dedicated</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1450" title="">September 19th, 2006 at 6:25pm</a> </small>

			<p>[...] Another related change that happed at the same time: on the shared host I was running the rails app under lighttpd. In setting up the dedicated server, I switched to the hot new thang: apache mod_proxy_cache + mongrel. [...]</p>

		</li>

	
	
		<li class=" " id="comment-1488">
    <a href='http://blog.labratz.net/articles/2006/09/27/capistrano-rimuhosting-super-delicious' title='Visit Capistrano + Rimuhosting = Super Delicious'><img src='http://www.gravatar.com/avatar.php?gravatar_id=9f173c578c2ff435a41d448e25d62870&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://blog.labratz.net/articles/2006/09/27/capistrano-rimuhosting-super-delicious' rel='external nofollow' class='url'>Capistrano + Rimuhosting = Super Delicious</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1488" title="">September 27th, 2006 at 2:57am</a> </small>

			<p>[...] Finally took the plunge to use Capistrano &amp; Rimuhosting. Tried to do this with Dreamhost but it was all fubared beyond repair. Hence the disappearance of this blog as well. Most of you have no doubt read Coda Hale&#8217;s excellent write up. [...]</p>

		</li>

	
	
		<li class="alt " id="comment-1514">
    <a href='http://blog.gwikzone.org/articles/2006/10/02/easy-setup-a-mongrel-cluster-with-apache-2-2-on-mac-os-x' title='Visit Easy setup a Mongrel cluster with Apache 2.2 on Mac OS X'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://blog.gwikzone.org/articles/2006/10/02/easy-setup-a-mongrel-cluster-with-apache-2-2-on-mac-os-x' rel='external nofollow' class='url'>Easy setup a Mongrel cluster with Apache 2.2 on Mac OS X</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1514" title="">October 2nd, 2006 at 5:47am</a> </small>

			<p>[...] Create 4 files for your new application. (adapted from codahale blog) $ sudo touch myapp.common myapp.conf myapp.cluster.conf myapp.yml [...]</p>

		</li>

	
	
		<li class=" " id="comment-1519">
    <a href='http://b2blogic.net' title='Visit Ryan'><img src='http://www.gravatar.com/avatar.php?gravatar_id=3b87f1ad86f6a44241832314873e8d54&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://b2blogic.net' rel='external nofollow' class='url'>Ryan</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1519" title="">October 2nd, 2006 at 12:02pm</a> </small>

			<p>Hi am having the save problem as Dave had in post 96 + 97</p>
<blockquote cite=""><p>
I am probably missing something really simple here but I dont really understand what the -c parameter is pointing to in the cluster::configure command:</p>
<p>[workstation]$ mongrel_rails cluster::configure -e production \<br />
-p 8000 \<br />
-a 127.0.0.1 \<br />
-N 3 \<br />
-c /path/to/your/capistrano/setup’s/current</p>
<p>Path to my capistrano setup’s current what?</p>
<p>What path is that supposed to be pointing to? The path to my deploy.rb? </p></blockquote>
<p>. I have set up  capistrano according to the agile rails development book (beta) but have no clue what setup folder you are reffering to.</p>
<p>Thanks!</p>

		</li>

	
	
		<li class="alt " id="comment-1522">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d9e2373e02d17a49738e5af1de5d2434&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Paul rogers</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1522" title="">October 3rd, 2006 at 1:34pm</a> </small>

			<p>I had problems using web services with this. Here is my thoughts on why, and how to fix:</p>
<p>When a connection is made, the wsdl contains the address and port to use for future communications( my speculation, I dont know much about webservices)<br />
if you use 127.0.0.1:8001 as your balancer/proxy url, this is what gets sent on the wsdl. Now thats ip is your client machine, so you get Host actively refused the connection.</p>
<p>So I think you need to use a server name or the external IP of the machine.</p>
<p>ie your server is on 192.168.0.1</p>
<p>use this for your balancer</p>
<p>BalancerMember <a href="http://192.168.0.1:8000" rel="nofollow">http://192.168.0.1:8000</a><br />
BalancerMember <a href="http://192.168.0.1:8001" rel="nofollow">http://192.168.0.1:8001</a><br />
BalancerMember <a href="http://192.168.0.1:8002" rel="nofollow">http://192.168.0.1:8002</a></p>

		</li>

	
	
		<li class=" " id="comment-1529">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=122c72e8c3318b7232c703c96caed6f2&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Jamie Brown</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1529" title="">October 4th, 2006 at 11:01am</a> </small>

			<p>It takes a little bit of time and effort to learn Capistrano&#8217;s functions, but once everything is working and you type in <code>rake deploy</code> for the first time and your application is automatically updated as if by magic, you&#8217;ll never be able to do without it again. There&#8217;s also a compact one-page <a href="http://dizzy.co.uk/cheatsheets" rel="nofollow">Capistrano cheat sheet here</a> that you can download in PDF format which contains all the standard tasks, syntax examples, shell commands and directory structure which is VERY useful.</p>

		</li>

	
	
		<li class="alt " id="comment-1577">
    <a href='http://www.ksbenefits.com' title='Visit BigBair'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d0496cc470b63f50ca38a3161b406814&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://www.ksbenefits.com' rel='external nofollow' class='url'>BigBair</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1577" title="">October 8th, 2006 at 10:25pm</a> </small>

			<p>I am new to the web server business, to make this new phase of my life interesting my company has decided to cut back in my department; To counter this cut back I have hired a ruby developer with the notion that this new sleek fast language will be the answer to my prayers. This adds some new kinks to my life. First I must keep my Microsoft SQL data base so that means my best hope is to keep this all running in windows. That being said I was hoping that you might have some insight to deploy the above mentioned technologies in windows. Thanks for any help you might offer. </p>
<p>Thanks </p>
<p>Barry Chapman</p>

		</li>

	
	
		<li class=" " id="comment-1609">
    <a href='http://www.warmroom.com/' title='Visit Ray Baxter'><img src='http://www.gravatar.com/avatar.php?gravatar_id=39cbcb6fffcf5b6320e35bc2529b02bb&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://www.warmroom.com/' rel='external nofollow' class='url'>Ray Baxter</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1609" title="">October 9th, 2006 at 3:28am</a> </small>

			<p>For the deflate configuration, I don&#8217;t know how or where this is established, but my server gives javascript files the mime type application/x-javascript. It is worth adding that type to the AddOutputFilterByType directive, especially for a Rails application. </p>
<p>The prototype library is large, but you can reduce it to less than 25% of its uncompressed size. Here is the output from uncommenting the deflate logging.</p>
<p><code><br />
"GET /javascripts/prototype.js?1160376830 HTTP/1.1" 12449/55149 (22%)<br />
"GET /javascripts/effects.js?1160376830 HTTP/1.1" 7197/32871 (21%)<br />
"GET /javascripts/dragdrop.js?1160376830 HTTP/1.1" 7085/29453 (24%)<br />
"GET /javascripts/controls.js?1160376830 HTTP/1.1" 7230/28036 (25%)<br />
</code></p>
<p>While I was at it, I added image/bmp, since the page I was testing had a bitmap on it for some reason. </p>
<p>Thanks for the really nice and complete walkthrough. I&#8217;m running a mogrel cluster, oh yeah.</p>

		</li>

	
	
		<li class="alt " id="comment-1682">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=3cb5aadfd1626e37759e987c7184e372&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Brendon Muir</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1682" title="">October 10th, 2006 at 6:18pm</a> </small>

			<p>Hi Coda, I&#8217;ve found a couple of problems with this setup, the first one being much more complex than the second! :)</p>
<p>1) If anyone is using imagemagick_tag to modify any of their images in realtime before displaying them on the page, they&#8217;ll get problems with Apache dropping the request for the modified image and calling it 404 without even giving the rewrite rules a go at sorting it out. Here is an example of one of the crude url&#8217;s that imagemagick_tag spits out:</p>
<p>As you can see, i think it&#8217;s trying to get around having to set up a custom route by encoding the path characters after the imagemagick method. Mongrel doesn&#8217;t mind this, but apache will just balk. Do you know of any way around this? It could affect quite a few people :)</p>
<p>2) Say your app stores images in a subdir of /public (like file_column does). Everytime you do a remote:deploy it wipes out the files that have been uploaded in the web interface because it&#8217;s symlinking a new version of the code (complete with an empty or sparse /public). Again, any thoughts on this problem?</p>
<p>Cheers,</p>
<p>Brendon</p>

		</li>

	
	
		<li class=" " id="comment-1696">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=b8e26753e9254ce82ad87178c1069e10&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Boni</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1696" title="">October 12th, 2006 at 1:38pm</a> </small>

			<p>Hello Guys! After setting up everything that was mentioned above my index.html gets rendered properly but when i remove it. I got a 403 error:</p>
<p>Forbidden</p>
<p>You don&#8217;t have permission to access / on this server.</p>
<p>Additionally, a 403 Forbidden error was encountered while trying to use an ErrorDocument to handle the request.</p>
<p>Does anybody has any idea why is this?</p>

		</li>

	
	
		<li class="alt " id="comment-1706">
    <a href='http://b2blogic.net' title='Visit Ryan'><img src='http://www.gravatar.com/avatar.php?gravatar_id=3b87f1ad86f6a44241832314873e8d54&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://b2blogic.net' rel='external nofollow' class='url'>Ryan</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1706" title="">October 13th, 2006 at 12:24pm</a> </small>

			<p>Hi Everyone,</p>
<p>Thanks for the great walkthrough. I now have my server up and running, but have a few questions.</p>
<p>Has anyone been able to get this configuration running with multiple sites (both rails and others?). From my understanding whatever I place in the conf.d folder that has the extension of conf, will be included into the httpd.conf. From what I can see this becomes a problem with the files myapp.proxy_cluster.conf and myapp.proxy_frontend.conf . If i duplicate each of these files, for each virtual host, they will be run outside of the virtual host tag. For example, with the myapp.proxy_cluster.conf file, which points to each of the mongrel servers, if I have 2 clusters of 3 each, appache will hand off to each of the different mongrel clusters randomly, and therefore break the virtual hosting.</p>
<p>Would it be proper to rename these files, and then include them in the myapp.conf file, like we did with the myapp.common file? Or am I going about this all wrong?</p>
<p>Thanks Again!</p>

		</li>

	
	
		<li class=" " id="comment-1717">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=3cb5aadfd1626e37759e987c7184e372&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Brendon Muir</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1717" title="">October 15th, 2006 at 2:26pm</a> </small>

			<p>OK, after a week of struggling I&#8217;ve found out this important info regarding what Apache does when passing url&#8217;s to the cluster.</p>
<p>Firstly, if for some reason your app encodes slashes in the URL (imagemagick_tag) does this to hide the path to the image that it&#8217;s going to manipulate from the rails routing, then you&#8217;re stuffed if you use the Apache proxy option. Apache will either say 404 straight away (as encoding slashes is a security problem), or if you add this option to your virtual host: AllowEncodedSlashes On, it will unencode the slashes before it passes it to mongrel so it will still break as your routes won&#8217;t know what to do with the strange URL.</p>
<p>Secondly, Apache will also unencode an encoded + symbol (that is, in imagemagick_tag, when telling it what commands to apply to your image, it links the commands together with plus&#8217;s which it then encodes). Unfortunatley either apache or mongrel convert the + to a space, so your commands break. </p>
<p>To work around all of this I had to:</p>
<p>Change the way I used imagemagick_tag so that I could embed critical path information to my images in the URL string. I then had to create a special route for this new URL. I used the imagemagick_tag after_filter to then grab the file off the filesystem and output it as a text blob which imagemagick_tag then grabbed and made changes to.</p>
<p>To work around the + problem, I had to just use one command and then un-DRY the commands in the code by combining them in all the possible combinations that I had used in my views.</p>
<p>So yea, not an overly perfect solution but it works. I&#8217;d be interested to see if anyone else has encountered this kind of thing with apps that don&#8217;t quite fit the status quo.</p>

		</li>

	
	
		<li class="alt " id="comment-1738">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=6753004fd5d6de121627e92bff0617f7&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Marc Love</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1738" title="">October 18th, 2006 at 11:25am</a> </small>

			<blockquote cite="Brendon Muir"><p>2) Say your app stores images in a subdir of /public (like file_column does). Everytime you do a remote:deploy it wipes out the files that have been uploaded in the web interface because it’s symlinking a new version of the code (complete with an empty or sparse /public). Again, any thoughts on this problem?</p></blockquote>
<p>Brendon, Capistrano creates a folder: &#8220;/<i>app_root</i>/shared/system&#8221;</p>
<p>Each time you deploy, the path &#8220;/<i>app_root</i>/current/public/system&#8221; is symlinked to that folder.  So in other words, the system folder in your public folder stays the same from deployment to deployment.  This is where you put any cross-deployment files, such as non-interface-related images or documents.</p>

		</li>

	
	
		<li class=" " id="comment-1741">
    <a href='http://dictabrain.com' title='Visit Vlad Jebelev'><img src='http://www.gravatar.com/avatar.php?gravatar_id=625e330269d38c8e5ff22daac72579e3&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://dictabrain.com' rel='external nofollow' class='url'>Vlad Jebelev</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1741" title="">October 18th, 2006 at 6:55pm</a> </small>

			<p>There is a typo in your Apache config.</p>
<p>The following line:<br />
BrowserMatch bMSIE !no-gzip !gzip-only-text/html</p>
<p>must be written as<br />
BrowserMatch \bMSIE !no-gzip !gzip-only-text/html</p>
<p>That is there must be a backward slash right before &#8216;bMSIE&#8217;.</p>
<p>The effect of this typo is that files that are not caught by previously listed rules, such as all *.css and *.js files are never deflated for MSIE users.</p>

		</li>

	
	
		<li class="alt official" id="comment-1745">
    <a href='http://blog.codahale.com' title='Visit Coda'><img src='http://www.gravatar.com/avatar.php?gravatar_id=87206f3bf53d403e16ec023c56e904c5&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://blog.codahale.com' rel='external nofollow' class='url'>Coda</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1745" title="">October 19th, 2006 at 8:09am</a> </small>

			<p>Thanks, Vlad. It was actually that way from the get-go (and is that way on my servers), but WordPress tends to eat leading slashes instead of, y&#8217;know, publishing what I wrote. Thanks for the heads up!</p>

		</li>

	
	
		<li class=" " id="comment-1973">
    <a href='http://opengrc.org' title='Visit jason'><img src='http://www.gravatar.com/avatar.php?gravatar_id=4d2c56d1611794f0abaef05fa71a0c80&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://opengrc.org' rel='external nofollow' class='url'>jason</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1973" title="">October 30th, 2006 at 8:43am</a> </small>

			<p>Hi<br />
Problem with capistrano starting mongrel.  I have the .yml file in [app]/shared/config.  However, capistrano tries to start with -C [app]/current/config/mongrel_cluster.yml.  This, of course, doesn&#8217;t exist, since that folder simply symlinks to latest release.</p>

		</li>

	
	
		<li class="alt " id="comment-1975">
    <a href='http://opengrc.org' title='Visit jason'><img src='http://www.gravatar.com/avatar.php?gravatar_id=4d2c56d1611794f0abaef05fa71a0c80&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://opengrc.org' rel='external nofollow' class='url'>jason</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1975" title="">October 30th, 2006 at 9:13am</a> </small>

			<p>Well, I&#8217;d been trying to fix for ages, then &#8230;<br />
My error was to create a &#8216;current&#8217; directory manually.  I deleted the whole directory structure redid setup, and heh presto current is a symlink - makes more sense that way!</p>

		</li>

	
	
		<li class=" " id="comment-1986">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=40db9e75b3f5899258e3bdc0c9210154&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Conrad</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1986" title="">October 30th, 2006 at 6:53pm</a> </small>

			<p>Hi, I&#8217;m trying to get things going on Mac OS X.  Thus, I was wondering, what&#8217;s the best practice for setting up your local svn repository because Capistrano doesn&#8217;t work with <strong>file:///</strong> from the documentation?</p>
<p>Thanks,</p>
<p>-Conrad</p>

		</li>

	
	
		<li class="alt official" id="comment-1988">
    <a href='http://blog.codahale.com' title='Visit Coda'><img src='http://www.gravatar.com/avatar.php?gravatar_id=87206f3bf53d403e16ec023c56e904c5&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://blog.codahale.com' rel='external nofollow' class='url'>Coda</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-1988" title="">October 30th, 2006 at 7:41pm</a> </small>

			<p>Conrad: The server that you&#8217;re deploying to must be able to contact the machine on which your SVN repository resides. Your SVN repository appears to be on your workstation, which means that if you&#8217;re deploying to another machine, it has to be able to access your workstation. I&#8217;d suggest looking into the svn+ssh protocol, which allows Subversion to SSH into your machine and access the repository locally.</p>

		</li>

	
	
		<li class=" " id="comment-2271">
    <a href='http://podium.sociocampus.net/2006/10/20/links-for-2006-10-21/' title='Visit My Podium &raquo; Blog Archive &raquo; links for 2006-10-21'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://podium.sociocampus.net/2006/10/20/links-for-2006-10-21/' rel='external nofollow' class='url'>My Podium &raquo; Blog Archive &raquo; links for 2006-10-21</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-2271" title="">November 8th, 2006 at 6:34pm</a> </small>

			<p>[...] Time For A Grown-Up Server: Rails, Mongrel, Apache, Capistrano and You (tags: ruby) [...]</p>

		</li>

	
	
		<li class="alt " id="comment-2574">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=8d80038769765b19666abea6f416613c&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Nick</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-2574" title="">November 16th, 2006 at 10:01am</a> </small>

			<p>This is a great post! (but you know this already!)</p>
<p>I&#8217;m getting multiple (11) mysqld processes running and I can&#8217;t work out why. I think it would open more but i&#8217;m out of memory.</p>
<p>I&#8217;m running apache 2.2. httpd.conf doesn&#8217;t say anything about the mysql server configuration. should it?</p>
<p>I don&#8217;t know where/how to configure this. Can anyone help? Thanks</p>

		</li>

	
	
		<li class=" " id="comment-2624">
    <a href='http://whitt.wordpress.com/2006/11/17/debian-ruby-on-rails-mongrel-setup/' title='Visit Debian + Ruby on Rails + Mongrel setup &laquo; brain dump of an entrepreneur'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://whitt.wordpress.com/2006/11/17/debian-ruby-on-rails-mongrel-setup/' rel='external nofollow' class='url'>Debian + Ruby on Rails + Mongrel setup &laquo; brain dump of an entrepreneur</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-2624" title="">November 17th, 2006 at 3:59pm</a> </small>

			<p>[...] <a href="http://blog.codahale.com/2006/06/19/time-for-a-grown-up-server-rails-mongrel-apache-capistrano-and-you/" rel="nofollow">http://blog.codahale.com/2006/06/19/time-for-a-grown-up-server-rails-mongrel-apache-capistrano-and-you/</a> [...]</p>

		</li>

	
	
		<li class="alt " id="comment-2665">
    <a href='http://webreakstuff.com' title='Visit Tiago Maceddo'><img src='http://www.gravatar.com/avatar.php?gravatar_id=17fd339dc782f5adc7f57437e653d2cd&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://webreakstuff.com' rel='external nofollow' class='url'>Tiago Maceddo</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-2665" title="">November 19th, 2006 at 8:49am</a> </small>

			<p>You should also add</p>
<p>ProxyPreserveHost On</p>
<p>otherwise certain things such as the endpoint in a wsdl definition (using actionwebservice) will be broken</p>

		</li>

	
	
		<li class=" " id="comment-2699">
    <a href='http://www.theblatherskite.com' title='Visit TheBlatherskite'><img src='http://www.gravatar.com/avatar.php?gravatar_id=5b91ab3a3a795f3014a28adc8ca092ea&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://www.theblatherskite.com' rel='external nofollow' class='url'>TheBlatherskite</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-2699" title="">November 20th, 2006 at 6:48pm</a> </small>

			<p>Excellent, as usual. </p>
<blockquote><p>Chip in on the comments if you’ve got a Mongrel band with a different lead singer and let us know how it’s going for you.</p></blockquote>
<p>I&#8217;m still playing around with the initial install, but <a href="http://www.theblatherskite.com/articles/2006/11/20/pounding-mongrel-light-tpd-ly" rel="nofollow">Lighttpd + Mongrel + Pound</a> seems to be working well for me.</p>

		</li>

	
	
		<li class="alt " id="comment-2856">
    <a href='http://www.froot.co.uk' title='Visit Gary Rowe'><img src='http://www.gravatar.com/avatar.php?gravatar_id=232628cea0e6482f1afb285a92ebe6f7&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://www.froot.co.uk' rel='external nofollow' class='url'>Gary Rowe</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-2856" title="">November 28th, 2006 at 10:02am</a> </small>

			<p>Great article Coda - really helped me to get my Rails project off the ground. I&#8217;d just like to say that I had real problems getting the reverse_proxy_fix plugin to work for me (being a Rails noob and all). I looked through the comments posted here (thanks everyone) and ended up with the following change to my apache configuration (assuming an application called depot):<br />
<code># Send the request (but do not allow access to the dispatcher or the cluster)<br />
# Note the use of trailing / this allows the mongrel_cluster prefix to work<br />
ProxyPass /depot/ <a href="http://depot_mongrel_cluster:8001/depot/" rel="nofollow">http://depot_mongrel_cluster:8001/depot/</a><br />
ProxyPass /depot <a href="http://depot_mongrel_cluster:8001/depot/" rel="nofollow">http://depot_mongrel_cluster:8001/depot/</a><br />
ProxyPassReverse /depot/ <a href="http://depot_mongrel_cluster:8001/depot/" rel="nofollow">http://depot_mongrel_cluster:8001/depot/</a> </code></p>
<p>In addition, modifying the mongrel_cluster.yml as follows made everything burst into life:<br />
<code> prefix: /depot</code></p>
<p>Thanks again for the great article!</p>

		</li>

	
	
		<li class=" " id="comment-3123">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=600459391a15ba6cc2d09dabb67cae60&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Robert</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-3123" title="">December 13th, 2006 at 6:57am</a> </small>

			<p>Hi,</p>
<p>I&#8217;m a bit lost with Capistrano here, I followed the instructions word by word but what I get is the following: <a href="http://pastebin.ca/277665" rel="nofollow">http://pastebin.ca/277665</a></p>
<p>Any idea about what to do?</p>
<p>Regards,<br />
Robert</p>

		</li>

	
	
		<li class="alt " id="comment-3126">
    <a href='http://www.gitarreninstitut.com' title='Visit Gitarreninstitut'><img src='http://www.gravatar.com/avatar.php?gravatar_id=057ac4d51f42f892da4b5237282d37ec&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://www.gitarreninstitut.com' rel='external nofollow' class='url'>Gitarreninstitut</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-3126" title="">December 13th, 2006 at 11:12am</a> </small>

			<p>Capistrano is very perfect for me and my work^</p>

		</li>

	
	
		<li class=" official" id="comment-3127">
    <a href='http://blog.codahale.com' title='Visit Coda'><img src='http://www.gravatar.com/avatar.php?gravatar_id=87206f3bf53d403e16ec023c56e904c5&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://blog.codahale.com' rel='external nofollow' class='url'>Coda</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-3127" title="">December 13th, 2006 at 12:13pm</a> </small>

			<p>Robert: It looks like you&#8217;re passing the update_code task some weird parameters, including :desc.</p>
<p>This is wrong:</p>
<pre><code>task :update_code, :desc =&gt; "Blah blah" do
...</code></pre>
<p>This is right:</p>
<pre><code>desc "Blah blah"
task :update_code do
...</code></pre>

		</li>

	
	
		<li class="alt " id="comment-3146">
    <a href='http://www.boboroshi.com' title='Visit John Athayde'><img src='http://www.gravatar.com/avatar.php?gravatar_id=0ab8e48dbc6cb962e9145ac526522784&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://www.boboroshi.com' rel='external nofollow' class='url'>John Athayde</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-3146" title="">December 14th, 2006 at 2:42pm</a> </small>

			<p>Some bumps I hit that might help others: </p>
<p>On FreeBSD, I had to change a line in the capistrano gem on my workstation because it was not recognizing [[ as test. I changed line 34 to</p>
<p><code>if test ! -d #{configuration.release_path} ; then</code></p>
<p>Also, ensure that your user is part of the wheel group and wheel is allowed in the sudoers file in /usr/local/etc/sudoers</p>
<p>Thanks very much!</p>

		</li>

	
	
		<li class=" " id="comment-3174">
    <a href='http://www.libre-acces.fr/blog/?p=18' title='Visit Le blog du Libre Accès &raquo; Archive du blog &raquo; Time For A Grown-Up Server: Rails, Mongrel, Apache, Capistrano and You | Archives | codablog | Coda Hale'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://www.libre-acces.fr/blog/?p=18' rel='external nofollow' class='url'>Le blog du Libre Accès &raquo; Archive du blog &raquo; Time For A Grown-Up Server: Rails, Mongrel, Apache, Capistrano and You | Archives | codablog | Coda Hale</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-3174" title="">December 16th, 2006 at 7:00am</a> </small>

			<p>[...] Time For A Grown-Up Server: Rails, Mongrel, Apache, Capistrano and You | Archives | codablog | Coda Hale [...]</p>

		</li>

	
	
		<li class="alt " id="comment-3176">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=331dd0703712a87f7fa0139d5d0bb76f&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Mohammad Ali</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-3176" title="">December 16th, 2006 at 7:51am</a> </small>

			<p>it might be a little off-topic but does any one knows of a benchmarking tool for comparing efficency of differrent combo&#8217;s????? </p>
<p>I can off course see the response times in  firefox&#8217;s fasterfox  to compare individual loads to check on mongrel+Apache(thanks to this article) and the lightpd+FastCGI(previous) combo, but that&#8217;s too  simplistic &amp; leaves lot of questions unanswered.</p>

		</li>

	
	
		<li class=" " id="comment-3188">
    <a href='http://www.rubyrobot.org/' title='Visit Rubyrobot'><img src='http://www.gravatar.com/avatar.php?gravatar_id=c9b9f83a5a7a5c88b6ea3d652450918a&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://www.rubyrobot.org/' rel='external nofollow' class='url'>Rubyrobot</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-3188" title="">December 17th, 2006 at 8:09am</a> </small>

			<p>If your server&#8217;s linux distro doesn&#8217;t feature the required Apache version for makin a Mongrel cluster, have a look at <a href="http://www.rubyrobot.org/article/mongrel-apache-load-balancing-ruby-on-rails" rel="nofollow">http://www.rubyrobot.org/article/mongrel-apache-load-balancing-ruby-on-rails</a> for instructions on building Apache 2.2.3 with proxy and load balancing enabled.</p>

		</li>

	
	
		<li class="alt " id="comment-3196">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d4d84187dc5510e2301b87a8b701fd75&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Cyrille</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-3196" title="">December 17th, 2006 at 6:10pm</a> </small>

			<p>I am trying to build fro ma Windows XP workstation and I can&#8217;t install mongrel_cluster. I get the following error:</p>
<p>&#8220;Failed to build gem native extension&#8221;</p>
<p>(as far as I understand, mongrel_cluster doesn&#8217;t exist for Win32).</p>
<p>But it looks like a don&#8217;t really need mongrel_cluster: only the recipes for Capistrano.</p>
<p>So, my two questions:</p>
<p>1) is it possible to build from a Windows workstation?<br />
2) can I fake a mongrel_cluster installation by copying the recipes somewhere?</p>

		</li>

	
	
		<li class=" " id="comment-3199">
    <a href='http://sublog.subimage.com/articles/2006/12/18/upgrading-to-debian-etch-for-rails-mongrel-hosting' title='Visit sublog : Upgrading to Debian Etch for Rails Mongrel Hosting'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://sublog.subimage.com/articles/2006/12/18/upgrading-to-debian-etch-for-rails-mongrel-hosting' rel='external nofollow' class='url'>sublog : Upgrading to Debian Etch for Rails Mongrel Hosting</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-3199" title="">December 18th, 2006 at 6:08am</a> </small>

			<p>[...] I went through the steps outline here to get Mongrel up, running and configured. Again, another problem. I had configured everything properly (I thought), but I kept getting &#8216;403 Forbidden&#8217; errors when trying to access my sites. [...]</p>

		</li>

	
	
		<li class="alt " id="comment-3272">
    <a href='http://www.nickhodge.com/blog/archives/1764' title='Visit www.nickhodge.com | mungenet &raquo; Blog Archive &raquo; Frankinstall Tweaking Ruby Mongrels'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://www.nickhodge.com/blog/archives/1764' rel='external nofollow' class='url'>www.nickhodge.com | mungenet &raquo; Blog Archive &raquo; Frankinstall Tweaking Ruby Mongrels</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-3272" title="">December 22nd, 2006 at 8:35pm</a> </small>

			<p>[...] As I planned to deploy behind Mongrel and Apache; I had to upgrade to Apache 2.2 (to get proxy_balancer), Ruby 1.8.5 (to get the latest Mongrel 0.3.13.4 with Mongrel_cluster 0.2.1) and Capistrano for remote deployment. Apart from the source, the best resource for all this text file tweaking is at Coda Hale&#8217;s site, with some extra double-cross checking from Rimuhosting&#8217;s wiki. [...]</p>

		</li>

	
	
		<li class=" " id="comment-3516">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d0496cc470b63f50ca38a3161b406814&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Studentbair</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-3516" title="">January 4th, 2007 at 9:29am</a> </small>

			<p>Cyrille - Good luck i am 99% sure that Capistrano will not work with windows I have successful set up Apache 2.2 running a Mongrel Pack (mongrel Cluster) but I could not find any nice or easy setups. You will have to do it all manually. But it I am actually running it on Windows 2003 R2 *(on a virtual server) and it runs GREAT!!! I am still having a few issues with ProxyPass and images but i am will figure it out.</p>

		</li>

	
	
		<li class="alt " id="comment-3517">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d0496cc470b63f50ca38a3161b406814&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Studentbair</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-3517" title="">January 4th, 2007 at 10:03am</a> </small>

			<p>Cyrille-<br />
sorry i did not read your questions yes you can mimic a cluster *(i am a newbie ) so forgive me if i do not use the correct ruby terms but i believe you use Apache load balancer and then what the way i am faking a mongrel pack is with a little app called firedeamon it allows you to run an exe as a service **( i know it can be done with rails or a number of other ways but i found them to be flaky) with this app i set up 8 single instances but it works well and sort of mimics the whole pack my config for the firedeamon app is<br />
Short name   	  = 	Railsapp1<br />
Display Name 	  = 	Railsapp1<br />
Description       =	Mongrel Pack #1<br />
Executalbe:  	  =	c:\ruby\bin\ruby.exe<br />
Working Directory =	c:\web\App1<br />
Parameters:	  = 	c:\ruby\bin\mongrel_rails start -d -e development -p 6000</p>
<p>I have ironed out most of the kinks and it seems to be a solid set up.</p>

		</li>

	
	
		<li class=" " id="comment-3554">
    <a href='http://fatpenguinblog.com/?p=827' title='Visit Intarweb while drunk: Rails, Mongrel, Apache, Capistrano and You :: Fat Penguin'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://fatpenguinblog.com/?p=827' rel='external nofollow' class='url'>Intarweb while drunk: Rails, Mongrel, Apache, Capistrano and You :: Fat Penguin</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-3554" title="">January 6th, 2007 at 9:53pm</a> </small>

			<p>[...] I&#8217;m currently putting together a Rails, Mongrel, Apache configuration (maybe capistrano&#8230;.). I was glad to find this article while looking how to use apache, with mod_proxy_balancer, and Mongrel instances. [...]</p>

		</li>

	
	
		<li class="alt " id="comment-3590">
    <a href='http://www.danger.com' title='Visit Tony Rose'><img src='http://www.gravatar.com/avatar.php?gravatar_id=96caa7f5e7c9fbca90e43e147914e501&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://www.danger.com' rel='external nofollow' class='url'>Tony Rose</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-3590" title="">January 9th, 2007 at 12:47pm</a> </small>

			<p>Hi - </p>
<p>Just got this all working with a perforce repository, and FC6.  Tookl about 4 hours, but have my first scaffolded table running&#8230; weee :) &#8230;</p>
<p>There were a few hiccups, this article and everyones feedback helped out a great deal.  On FC6 out of the box I had to modify the setenforce for SELinnux (Security Enhanced Linux) in order to allow apache to talk to mongrels.  I found the easy way to do this is and preserve on reboot was to modify /etc/selinix/config to SELINUX=permissive.  There are probably more secure ways to do it, but this box is behind all types of firewalls so not too worried.</p>
<p>Thanks for the great article!</p>
<p>Tony</p>

		</li>

	
	
		<li class=" " id="comment-3623">
    <a href='http://www.stoneageblog.com/articles/2007/01/10/debian-on-rails-apache-2-2-mysql-ruby-rails-php-mongrel-mongrel_cluster-subversion-trac-capistrano' title='Visit Debian On Rails : Apache 2.2 + MySQL + Ruby + Rails + PHP + Mongrel + Mongrel_cluster + Subversion + Trac + Capistrano'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://www.stoneageblog.com/articles/2007/01/10/debian-on-rails-apache-2-2-mysql-ruby-rails-php-mongrel-mongrel_cluster-subversion-trac-capistrano' rel='external nofollow' class='url'>Debian On Rails : Apache 2.2 + MySQL + Ruby + Rails + PHP + Mongrel + Mongrel_cluster + Subversion + Trac + Capistrano</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-3623" title="">January 11th, 2007 at 8:33am</a> </small>

			<p>[...] Time For A Grown-Up Server: Rails, Mongrel, Apache, Capistrano and You [...]</p>

		</li>

	
	
		<li class="alt " id="comment-3845">
    <a href='http://richarddcrowley.org/' title='Visit Richard Crowley'><img src='http://www.gravatar.com/avatar.php?gravatar_id=0757965da1525a4d01b58489acdd34b0&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://richarddcrowley.org/' rel='external nofollow' class='url'>Richard Crowley</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-3845" title="">January 17th, 2007 at 9:30am</a> </small>

			<p>Great article, Coda.  I probably owe you a pint once I move to the Bay Area.  I <a href="http://richarddcrowley.org/blog/view/101" rel="nofollow">documented</a> my setup process for this type of Apache / Mongrel cluster on Ubuntu following most of your steps.  Where I lost you is in what exactly Capistrano does.  Does it just do the heavy lifting of pushing what&#8217;s in your Subversion out to some production server?  If so, nifty, if not, confusing.  Thanks again,<br />
Richard</p>

		</li>

	
	
		<li class=" " id="comment-3847">
    <a href='http://www.stoneageblog.com/articles/2007/01/11/debian-on-rails-apache-2-2-mysql-ruby-rails-php-mongrel-mongrel_cluster-subversion-trac-capistrano/' title='Visit Stoneageblog.com &raquo; Blog Archive &raquo; Debian On Rails : Apache 2.2 + MySQL + Ruby + Rails + PHP + Mongrel + Mongrel_cluster + Subversion + Trac + Capistrano'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://www.stoneageblog.com/articles/2007/01/11/debian-on-rails-apache-2-2-mysql-ruby-rails-php-mongrel-mongrel_cluster-subversion-trac-capistrano/' rel='external nofollow' class='url'>Stoneageblog.com &raquo; Blog Archive &raquo; Debian On Rails : Apache 2.2 + MySQL + Ruby + Rails + PHP + Mongrel + Mongrel_cluster + Subversion + Trac + Capistrano</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-3847" title="">January 17th, 2007 at 10:47am</a> </small>

			<p>[...] Time For A Grown-Up Server: Rails, Mongrel, Apache, Capistrano and You [...]</p>

		</li>

	
	
		<li class="alt " id="comment-3931">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=68663ebaaa2c1be4ee5768d40ad84120&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Giuseppe</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-3931" title="">January 19th, 2007 at 3:51pm</a> </small>

			<p>Great article, Coda.</p>
<p>however, um, I am sort of stuck here:</p>
<p>&gt; Finally, link your mongrel_cluster.yml from your<br />
&gt; app’s config directory to /etc/mongrel_cluster:</p>
<p>how can I create a link to a file that does not exist yet? Isn&#8217;t the whole app tree going to be put by capistrano inside a directory named like YYYYMMDDHHMMSS upon deployment (which is the next step in the process)?</p>
<p>So, what should I replace <code>/your/rails/app</code> with in the following:</p>
<p><code>sudo ln -s /your/rails/app/config/mongrel_cluster.yml /etc/mongrel_cluster/yourapp.yml</code></p>
<p>I must be missing something obvious&#8230; sorry in advance.<br />
Giuseppe</p>

		</li>

	
	
		<li class=" " id="comment-3992">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d30d99522fb67556d0a099710ae38898&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Richard</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-3992" title="">January 24th, 2007 at 7:18pm</a> </small>

			<p>This is a great article and has helped me setup my site, but has anyone else noticed a 15 second proxy timeout when the Mongrel servers are busy or slow?  I am using this same setup except I&#8217;m using Apache 2.0 and a hardware load balancer instead of mod_proxy_balancer.  I&#8217;ve tried setting ProxyTimeout and that never works either.  I&#8217;m just wondering any of you guys have seen this also.</p>

		</li>

	
	
		<li class="alt " id="comment-4044">
    <a href='http://abc.com' title='Visit Mike'><img src='http://www.gravatar.com/avatar.php?gravatar_id=9531beb337bc9a23d94d41a8cac71f29&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://abc.com' rel='external nofollow' class='url'>Mike</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-4044" title="">January 27th, 2007 at 7:08pm</a> </small>

			<p>you can pass you svn project&#8217;s password into cap (and thereby avoid having to do a gratuitous svn co  on each server) by adding it to the &#8220;checkout&#8221; variable.</p>
<p>Heres an example (I use export instead of co) in the deploy.rb file under the OPTIONAL VARIABLES section:</p>
<p><code>set :checkout, "export --password 'passwordgoeshere'"</code></p>

		</li>

	
	
		<li class=" " id="comment-4091">
    <a href='http://www.chargehard.com' title='Visit Tony Rose'><img src='http://www.gravatar.com/avatar.php?gravatar_id=2a7c2c6849b5e0a543aac8b704d0c94f&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://www.chargehard.com' rel='external nofollow' class='url'>Tony Rose</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-4091" title="">January 29th, 2007 at 7:04pm</a> </small>

			<p>I was inspired to actually create a blog for myself so I could post the instructions for how to host multiple rails apps under a single domain with Apache2.2 and Mongrel.  I looked and looked and did not find anyone had written up how to do it so here you go! &#8230; It took a while to figure out, but was pretty simple once I understood all the moving parts. That seems to be a common theme in RoR!</p>
<p><a href="http://tonyrose023.blogspot.com/2007/01/multiple-rails-apps-with-mongrel.html" rel="nofollow">http://tonyrose023.blogspot.com/2007/01/multiple-rails-apps-with-mongrel.html</a></p>

		</li>

	
	
		<li class="alt " id="comment-4234">
    <a href='http://blog.rsynnott.com/setting-up-ruby-on-rails-app-on-a-creaky-old-debian-stable-box-quick-guide.html' title='Visit Robert Synnott &raquo; Blog Archive &raquo; Setting up Ruby on Rails app on a creaky old Debian Stable box - quick guide'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://blog.rsynnott.com/setting-up-ruby-on-rails-app-on-a-creaky-old-debian-stable-box-quick-guide.html' rel='external nofollow' class='url'>Robert Synnott &raquo; Blog Archive &raquo; Setting up Ruby on Rails app on a creaky old Debian Stable box - quick guide</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-4234" title="">February 4th, 2007 at 10:13am</a> </small>

			<p>[...] with Apache 2.0.x. Now, at some point, I realise, I should upgrade to Apache 2.2.x and do the whole Mongrel/mod_proxy_balance thing, or else use lighttpd. But for the moment, I have a slightly exotic Apache config that I [...]</p>

		</li>

	
	
		<li class=" " id="comment-4360">
    <a href='http://www.brianmcquay.com/goodbye-notsofastcgi-hello-mongrel/81' title='Visit An Adventure into Industry'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://www.brianmcquay.com/goodbye-notsofastcgi-hello-mongrel/81' rel='external nofollow' class='url'>An Adventure into Industry</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-4360" title="">February 9th, 2007 at 2:09pm</a> </small>

			<p><strong>Goodbye (notso)fastcgi, Hello Mongrel&#8230;</strong></p>
<p>I&#8217;ve just started using Mongrel instead of fastcgi for my Rails apps. Its only been a few days but I&#8217;m already loving the difference. Its so much faster than before. It wasn&#8217;t hard setting up either. Now Apache just proxies requests t&#8230;</p>

		</li>

	
	
		<li class="alt " id="comment-4436">
    <a href='http://bark.metacasa.net/2007/02/11/nginx-at-10000-feet/' title='Visit The Bark Blog &raquo; Nginx at 10,000 Feet'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://bark.metacasa.net/2007/02/11/nginx-at-10000-feet/' rel='external nofollow' class='url'>The Bark Blog &raquo; Nginx at 10,000 Feet</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-4436" title="">February 12th, 2007 at 10:20am</a> </small>

			<p>[...] &#8220;Time For A Grown-Up Server: Rails, Mongrel, Apache, Capistrano and You&#8221; by Coda Hale [...]</p>

		</li>

	
	
		<li class=" " id="comment-4439">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d5b88d0d1b1490337393891d88c817a1&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>koolb</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-4439" title="">February 12th, 2007 at 4:03pm</a> </small>

			<p>Ok got things running with a mix of railsmachine and capistrano and some research. </p>
<p>I saw a previous post where 403 Forbidden errors were popping up. It took me a while of digging and finally found the solution:<br />
for those on Apache2.2 go to the mods-available/ directory under apache2 config. The file is proxy.conf and you will want to change the &#8216;Deny from all&#8217; line to &#8216;Allow from all&#8217;. Be sure ProxyRequests are off or else I think you become an open proxy for anyone on the internet &#8212; which is bad.</p>
<p>I also added the following line to the  &#8220;check for static&#8221; section of the Rewrite rules:</p>
<p>RewriteRule ^/(stylesheets|images|javascripts|favicon.ico)   /$1 [QSA]</p>
<p>Not an apache2 guru but this may save someone the hair-pulling I went thru. </p>
<p>One final note: I have configured apache2 so that I can use appname.mydomain.dyndns.org and the railsmachine gem will add an application to my dyndns domain which is very nice (all I need to do is select a different start port, eg 8010, 8020 for each app). </p>
<p>Railsmachine will even configure an /etc/mongrel_cluster/myapp.conf for each set of clusters and a unique id, eg, &#8216;balancer://myapp1_cluster&#8217;, keyword in the apache2 configurarion). I am not too fond of the mydomain/app1 mydomain/app2 paradigm. </p>
<p>No need to purchase a monthly contract with anyone for your own apps - you will need to provide your own fault-tolerance tho.</p>
<p>Thanks for the great info. Been a while (1.3) since I have configured apache and it was a challenge since I knew very little about proxys and load balancing. Also a rails noob but liking it a lot, comming from C++, Perl, Python and living thru PHP programming hell.</p>

		</li>

	
	
		<li class="alt " id="comment-4603">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=c9274ed35a8ea3bcb373b318e177db1f&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>David</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-4603" title="">February 20th, 2007 at 1:29pm</a> </small>

			<p>A problem I ran into:  I have a couple of environment variables that were not getting set when the mongrel_cluster was starting thus my pages were not being served correctly.</p>
<p>Solution:  I added the environment variables to the /usr/lib/ruby/gems/1.8/gems/mongrel_cluster-0.2.1/resources/mongrel_cluster<br />
file.</p>
<p>export MYLIB=somelib<br />
They are now being set when the mongrel_cluster service starts.</p>

		</li>

	
	
		<li class=" " id="comment-4624">
    <a href='http://travelinsurance.ijlo.info' title='Visit Marg'><img src='http://www.gravatar.com/avatar.php?gravatar_id=53c5616f00ec2b5c8b292a57d878fb13&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://travelinsurance.ijlo.info' rel='external nofollow' class='url'>Marg</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-4624" title="">February 21st, 2007 at 11:25am</a> </small>

			<p>To you on a site my calls of son often.I looked satisfied also to me.To me, satisfied, this which he was in you on a site.<br />
<a href='http://disability-insurance-claims-declination-letters.ijlo.info' rel="nofollow">disability insurance claims declination letters</a></p>

		</li>

	
	
		<li class="alt " id="comment-4765">
    <a href='http://clear-consult.com' title='Visit Casey Helbling'><img src='http://www.gravatar.com/avatar.php?gravatar_id=381f824e77336dceedd82772227a2f6d&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://clear-consult.com' rel='external nofollow' class='url'>Casey Helbling</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-4765" title="">March 1st, 2007 at 3:10pm</a> </small>

			<p>Richard (154) &#8212; I have been noticing timeouts and things too recently on my latest rails project <a href="http://nearbie.com" rel="nofollow">nearbie.com</a> &#8212; actually I have been receiving </p>
<blockquote><p>
&#8220;Proxy Error  The proxy server received an invalid response from an upstream server.  Reason: Error reading from remote server&#8221;
</p></blockquote>
<p>but it very much feels like a TimeOut issue since the server delays as it is processing an image (resizing a bunch of thumbnails).  I tried what this guy was saying but it didnt seem to help either.</p>
<p><a href="http://blog.pomozov.info/posts/apache-mongrel-and-proxy-error.html" rel="nofollow">http://blog.pomozov.info/posts/apache-mongrel-and-proxy-error.html</a></p>
<p>Any other thoughts would be greatly appreciated!</p>
<p>Thanks,<br />
Casey</p>

		</li>

	
	
		<li class=" " id="comment-4802">
    <a href='http://www.blaness.com/2007/03/02/restart-mongrel-cluster-on-apple-os-x-with-launchd/' title='Visit Blaness.com &raquo; Blog Archive &raquo; Restart Mongrel Cluster on Apple OS X with Launchd'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://www.blaness.com/2007/03/02/restart-mongrel-cluster-on-apple-os-x-with-launchd/' rel='external nofollow' class='url'>Blaness.com &raquo; Blog Archive &raquo; Restart Mongrel Cluster on Apple OS X with Launchd</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-4802" title="">March 2nd, 2007 at 10:21am</a> </small>

			<p>[...] that I have developing. I decided on a production environment based on Coda Hale&#8217;s &#8220;Time For A Grown-Up Server&#8221; setup. Fortunately MacPorts (formerly Darwinports) makes it extremely easy to setup Apache 2.2 and [...]</p>

		</li>

	
	
		<li class="alt " id="comment-5008">
    <a href='http://blog.brianguthrie.com/articles/2007/03/08/fun-with-hosts-virtual-and-otherwise' title='Visit Fun with hosts, virtual and otherwise'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://blog.brianguthrie.com/articles/2007/03/08/fun-with-hosts-virtual-and-otherwise' rel='external nofollow' class='url'>Fun with hosts, virtual and otherwise</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-5008" title="">March 8th, 2007 at 1:23am</a> </small>

			<p>[...] former is considerably easier to set up. But I followed these instructions to the letter, and many others, and I found that no matter what I did, all of the URLs worked fine within Mongrel and were [...]</p>

		</li>

	
	
		<li class=" " id="comment-5074">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=dc218395c242f9feb76c62aea1183874&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Amir</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-5074" title="">March 9th, 2007 at 12:04pm</a> </small>

			<p>I&#8217;m deploying from a Windows system, and the deployment doesn&#8217;t run as root (but as a normal Linux user). However, the chkconfig statements sets the mongrel_cluster to start as root.</p>
<p>So, after server boot, if I use capistrano to update, it cannot touch the mongrel_cluster.</p>
<p>Should I deploy as root? (I don&#8217;t like this idea of sending the root password on every deploy).<br />
Otherwise, how do I change the chkconfig of mongrel_cluster to run as my normal user instead of root?</p>
<p>Thanks,<br />
Amir</p>

		</li>

	
	
		<li class="alt " id="comment-5461">
    <a href='http://nonsens.joshu.se/?p=11' title='Visit nonsens &raquo; Time For A Grown-Up Server: Rails, Mongrel, Apache, Capistrano and You | Archives | codablog | Coda Hale'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://nonsens.joshu.se/?p=11' rel='external nofollow' class='url'>nonsens &raquo; Time For A Grown-Up Server: Rails, Mongrel, Apache, Capistrano and You | Archives | codablog | Coda Hale</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-5461" title="">March 17th, 2007 at 1:45pm</a> </small>

			<p>[...] Time For A Grown-Up Server: Rails, Mongrel, Apache, Capistrano and You [...]</p>

		</li>

	
	
		<li class=" " id="comment-5536">
    <a href='http://blog.wishlisting.com/?p=20' title='Visit Wishlisting Blog &raquo; Blog Archive &raquo; Deploying Ruby on Rails, Mongrel, and Pen on a MediaTemple (dv) 3.0 Server'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://blog.wishlisting.com/?p=20' rel='external nofollow' class='url'>Wishlisting Blog &raquo; Blog Archive &raquo; Deploying Ruby on Rails, Mongrel, and Pen on a MediaTemple (dv) 3.0 Server</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-5536" title="">March 19th, 2007 at 12:46pm</a> </small>

			<p>[...] I wanted to use Mongrel instead of FastCGI. [...]</p>

		</li>

	
	
		<li class="alt " id="comment-6115">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=68663ebaaa2c1be4ee5768d40ad84120&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Giuseppe</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-6115" title="">March 29th, 2007 at 2:09pm</a> </small>

			<p>Hi Coda, thanks once again for the effort.<br />
I got soooo close, but now I seem to be stuck on 403s.</p>
<p>* my apache2.2 (on Ubuntu) also serves non-rails pages, so I set up a separate virtual host for my rails app<br />
* 2 mongrels are properly running on ports 8300 and 8301 (the application runs fine if invoked from the LAN on either port with &#8220;address: 127.0.0.1&#8243; commented out in mongrel_cluster.yml)<br />
* I have fixed proxy.conf as koolb suggested on Feb 12<br />
* I have tried the following both in a separate file in conf.d, and inside the relevant vhost, as suggested in RimuHosting Bliki</p>
<p><code></p>
<p>  BalancerMember <a href="http://127.0.0.1:8300" rel="nofollow">http://127.0.0.1:8300</a><br />
  BalancerMember <a href="http://127.0.0.1:8301" rel="nofollow">http://127.0.0.1:8301</a></p>
<p></code></p>
<p>Still, if I try <a href="http://myapp.com" rel="nofollow">http://myapp.com</a> I get &#8220;403 Forbidden&#8221; errors, and myapp_errors_log reports the following:</p>
<p><code><br />
client denied by server configuration: proxy:balancer://mongrel_cluster/<br />
</code></p>
<p>Any clues of what I might be doing wrong? I could provide all relevant config files, but I do not want to clutter this space or abuse your patience&#8230; :-)</p>
<p>Cheers,<br />
Giuseppe</p>

		</li>

	
	
		<li class=" " id="comment-6116">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=68663ebaaa2c1be4ee5768d40ad84120&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Giuseppe</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-6116" title="">March 29th, 2007 at 2:12pm</a> </small>

			<p>er, my attempt at marking up my previous post resulted in a bit of code being eaten up. I meant:</p>
<p>  BalancerMember <a href="http://127.0.0.1:8300" rel="nofollow">http://127.0.0.1:8300</a><br />
  BalancerMember <a href="http://127.0.0.1:8301" rel="nofollow">http://127.0.0.1:8301</a></p>
<p>Thanks again,<br />
Giuseppe</p>

		</li>

	
	
		<li class="alt " id="comment-6227">
    <a href='http://lianza.org/' title='Visit Tom'><img src='http://www.gravatar.com/avatar.php?gravatar_id=a1eef56f2ad750679bc10243930cfdea&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://lianza.org/' rel='external nofollow' class='url'>Tom</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-6227" title="">March 30th, 2007 at 3:31pm</a> </small>

			<p>Hey Casey (#163).  I was seeing the same thing with my install and then found, inexplicably, that it went away when pen was run in the foreground (-f flag).</p>
<p>I added it to my troubleshooting section here:<br />
<a href="http://blog.wishlisting.com/?p=20" rel="nofollow">http://blog.wishlisting.com/?p=20</a></p>
<p>Hope it helps&#8230; and I&#8217;m even more hopeful that someone can figure out WHY it helps.</p>

		</li>

	
	
		<li class=" " id="comment-6693">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=82594e3b157070a85419792db5d038d7&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>tjc</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-6693" title="">April 4th, 2007 at 3:25pm</a> </small>

			<p>If you get 403 errors with corresponding apache log entries of &#8220;client denied by server configuration: proxy:balancer://&#8230;&#8221;, your mod_proxy config is blocking your local balancer config.</p>
<p>On Debian etch (and Ubuntu) look at /etc/apache2/mods-available/proxy.conf:</p>
<p><code><br />
                AddDefaultCharset off<br />
                Order deny,allow<br />
                Deny from all<br />
                #Allow from .example.com<br />
        </code></p>
<p>Rather than override that, add this to your Mongrel cluster proxy definition (along with the 127.0.0.1 lines:</p>
<p><code><br />
Order allow,deny<br />
Allow from all<br />
</code></p>
<p>Problem solved</p>

		</li>

	
	
		<li class="alt " id="comment-7181">
    <a href='http://laughingmeme.org/2007/04/12/some-ec2-fedora-rails-mongrel-memcached-links/' title='Visit Some EC2, Fedora, Rails, Mongrel, Memcached Links - Laughing Meme'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://laughingmeme.org/2007/04/12/some-ec2-fedora-rails-mongrel-memcached-links/' rel='external nofollow' class='url'>Some EC2, Fedora, Rails, Mongrel, Memcached Links - Laughing Meme</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-7181" title="">April 12th, 2007 at 10:28pm</a> </small>

			<p>[...] Time For A Grown-Up Server: Rails, Mongrel, Apache, Capistrano and You - never had much luck with Pen and co &#8212; Apache2&#8217;s proxying modules rawk! [...]</p>

		</li>

	
	
		<li class=" " id="comment-7584">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=670a654cb8d82cf7778baca5ec661cd0&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Olive</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-7584" title="">April 19th, 2007 at 6:07am</a> </small>

			<p>Thank your for this nice article, Coda. I think it help really a lot of user who have to start with Cap&#8217;</p>
<p>Could I ask you something happend on my server ?</p>
<p>What&#8217;s difference between task :deploy and task :cold_deploy about &#8220;restarting&#8221; Mongrel ? Because, on my server I have no problem with the restart from task :cold_deploy, but on error occurs with the restart from task :deploy&#8230;</p>
<p>As you could see here:<br />
executing task restart<br />
&#8230;<br />
executing &#8220;cd /var/www/rails&#8230; &amp;&amp; mongrel_rails cluster::stop&#8221;<br />
&#8230;<br />
Stopping 3 Mongrel servers&#8230;<br />
&#8230;/mongrel_rails:162:in `kill&#8217;<br />
 Operation not permitted</p>
<p>Any idea ?</p>

		</li>

	
	
		<li class="alt " id="comment-7820">
    <a href='http://blog.codeinmotion.com/index.php/2007/04/23/holy-grail-of-rails-servers/' title='Visit Cog Blog &raquo; Blog Archive &raquo; Holy Grail of Rails Servers'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://blog.codeinmotion.com/index.php/2007/04/23/holy-grail-of-rails-servers/' rel='external nofollow' class='url'>Cog Blog &raquo; Blog Archive &raquo; Holy Grail of Rails Servers</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-7820" title="">April 22nd, 2007 at 4:11pm</a> </small>

			<p>[...] found Coda Hale&#8217;s post on rails mongrel apache and capistrano very [...]</p>

		</li>

	
	
		<li class=" " id="comment-7959">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d27027515d14eef54aab571ecd54ca8c&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>m</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-7959" title="">April 24th, 2007 at 12:43am</a> </small>

			<p>Hi,</p>
<p>Thanks for the great write-up.</p>
<p>How can I change my rewrite-rules to allow http access to svn on the same server?</p>

		</li>

	
	
		<li class="alt " id="comment-7989">
    <a href='http://www.thegrave.nl' title='Visit Marcel de Graaf'><img src='http://www.gravatar.com/avatar.php?gravatar_id=e3fdf5493dc052674e0e9d136d2de0bc&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://www.thegrave.nl' rel='external nofollow' class='url'>Marcel de Graaf</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-7989" title="">April 24th, 2007 at 5:39am</a> </small>

			<p>Hey Coda, thanks a lot for your detailed and useful article, it really helped my setting up our new dedicated server for our Rails app.<br />
Thanks!</p>

		</li>

	
	
		<li class=" " id="comment-8859">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d5b88d0d1b1490337393891d88c817a1&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>koolb</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-8859" title="">April 29th, 2007 at 1:34pm</a> </small>

			<p>TJC! Thanks for the tip! Much better editing the proxy config there.</p>
<p>I didnt see mention of the use of the railsmachine gem but just about all this apache2 config is set by the railsmachine gem rule:</p>
<p>cap -a setup<br />
cap -a setup_servers<br />
cap -a cold_deploy</p>
<p>BTW, I have a script that takes a default Knoppix 5.1 disc and brings it to a state ready for deployment of your application.</p>

		</li>

	
	
		<li class="alt " id="comment-9214">
    <a href='http://jw.fi/' title='Visit Jan Wikholm'><img src='http://www.gravatar.com/avatar.php?gravatar_id=7fde569fd0ea9ab8b275cfac3f0c32de&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://jw.fi/' rel='external nofollow' class='url'>Jan Wikholm</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-9214" title="">May 3rd, 2007 at 2:54pm</a> </small>

			<p>You fokken rule!</p>
<p>This saved my night.</p>

		</li>

	
	
		<li class=" " id="comment-9249">
    <a href='http://losingmyjob.wordpress.com/2007/05/04/apache-22-mongrel-cluster/' title='Visit Losing My Job Apache 2.2 + Mongrel Cluster &laquo;'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://losingmyjob.wordpress.com/2007/05/04/apache-22-mongrel-cluster/' rel='external nofollow' class='url'>Losing My Job Apache 2.2 + Mongrel Cluster &laquo;</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-9249" title="">May 4th, 2007 at 9:56am</a> </small>

			<p>[...] some more searching and found that Coda Hale has the most elegant solution to the problem. I simplified his solution to the steps below. But before trying anything, you [...]</p>

		</li>

	
	
		<li class="alt " id="comment-9734">
    <a href='http://c2gobal.com' title='Visit Justin Turner'><img src='http://www.gravatar.com/avatar.php?gravatar_id=2c56ecdb9724aeca7459c768247005fa&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://c2gobal.com' rel='external nofollow' class='url'>Justin Turner</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-9734" title="">May 9th, 2007 at 7:04am</a> </small>

			<p>Thanks Coda,<br />
Excellent write up on a solid configuration.</p>

		</li>

	
	
		<li class=" " id="comment-9763">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d5b88d0d1b1490337393891d88c817a1&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>koolb</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-9763" title="">May 9th, 2007 at 1:08pm</a> </small>

			<p>Re: Setting up SVN on same server. </p>
<p>I use SVN on the same server as my rails demo box (the place where my apps live until payment is received. hehe).</p>
<p>Be sure to create an apache2 config for each host name. sites-available/default should be there already, eg (sites-available/svn,app1,app2)  for each host name (all resolving to the same external ip addy). </p>
<p>Put ONE and ONLY ONE NameVirtualHost 192.168.0.10 in ONLY your default host site config file (took me a while to &#8220;get&#8221; this).</p>
<p>In each other host site config (either a COPY of default or created from the railsmachine: cap -a setup_servers cmd): eg:<br />
sites-available/svn:</p>
<p>ServerName svn.mydomain.com<br />
&#8230;<br />
a2ensite svn</p>

		</li>

	
	
		<li class="alt " id="comment-10264">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=1fd071d46ee083d3f3116a23903c504f&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Navneet Aron</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-10264" title="">May 14th, 2007 at 10:18am</a> </small>

			<p>Thanks for an awesome post. It was very helpful. After successful deployment, I&#8217;m running into something unexpected.<br />
I&#8217;ve mongrel cluster with Apache2 proxy balancer. It seems Apache has cached some content and even if mongrel cluster is shut down, Apache serves up that content.  Even when Mongrel cluster is running, still the same STALE content is served.<br />
Any ideas on how this can be resolved? </p>
<p>Thanks<br />
Navneet</p>

		</li>

	
	
		<li class=" " id="comment-10894">
    <a href='http://usladha.wordpress.com/2007/05/30/links-for-2007-05-30/' title='Visit links for 2007-05-30 &laquo; J.Uma Shankar Ladha'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://usladha.wordpress.com/2007/05/30/links-for-2007-05-30/' rel='external nofollow' class='url'>links for 2007-05-30 &laquo; J.Uma Shankar Ladha</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-10894" title="">May 29th, 2007 at 6:19pm</a> </small>

			<p>[...] Time For A Grown-Up Server: Rails, Mongrel, Apache, Capistrano and You | Archives | codablog | Coda &#8230; talling sendfile, but it doesn’t help–Apache serves the static content, so the 20%-or-so boost on static files is never seen–and it can even cause some pretty severe stability issues. So. No sendfile, and if you’ve got it installed, uninstall it, (tags: rails apache rubyonrails capistrano howto performance) [...]</p>

		</li>

	
	
		<li class="alt " id="comment-13103">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=a08f9190686ee1129bb5c4fbb7fde24b&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Jeremy Walker</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-13103" title="">June 4th, 2007 at 2:24pm</a> </small>

			<p>Just to say thank you for this post, its invaluable.</p>

		</li>

	
	
		<li class=" " id="comment-14397">
    <a href='http://mernin.com/blog/?p=63' title='Visit Martello &raquo; Apache + Mongrel on Solaris'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://mernin.com/blog/?p=63' rel='external nofollow' class='url'>Martello &raquo; Apache + Mongrel on Solaris</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-14397" title="">June 8th, 2007 at 6:37am</a> </small>

			<p>[...] owe a great deal of thanks to this article posted by codehale on the same topic. The article you are reading here is a summation of [...]</p>

		</li>

	
	
		<li class="alt " id="comment-15047">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=874f31f4051be3fbdd2fae2d3bd6c79e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Valery Khamenya</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-15047" title="">June 20th, 2007 at 2:08pm</a> </small>

			<p>I ve got all this cool tutorial through. the only trouble: only a <a href="http://myapp.com/" rel="nofollow">http://myapp.com/</a> is proxied OK. Any other path supplied after &#8220;/&#8221; is not proxied. I guess smthing goes wrong with rewrite rules, but no idea what&#8230;.</p>

		</li>

	
	
		<li class=" " id="comment-15056">
    <a href='http://pauldowman.com/2007/06/20/ill-set-up-your-ruby-on-rails-server-for-you-for-free/' title='Visit Paul Dowman &raquo; Blog Archive &raquo; I&#8217;ll set up your Ruby on Rails server for you. For free.'><img src='http://www.gravatar.com/avatar.php?gravatar_id=6436e3d1e0ac332c52b253c94667cb5b&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://pauldowman.com/2007/06/20/ill-set-up-your-ruby-on-rails-server-for-you-for-free/' rel='external nofollow' class='url'>Paul Dowman &raquo; Blog Archive &raquo; I&#8217;ll set up your Ruby on Rails server for you. For free.</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-15056" title="">June 20th, 2007 at 5:39pm</a> </small>

			<p>[...] are you need almost the same configuration as me. As of this writing 1845 people have bookmarked Coda Hale&#8217;s excellent guide to setting up Mongrel + Apache on del.icio.us. The article has 187 comments. Why should so many people each have to do the same [...]</p>

		</li>

	
	
		<li class="alt " id="comment-15412">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=e76f0061183de3a104eca5a1b0076589&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Daniel</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-15412" title="">June 29th, 2007 at 12:33pm</a> </small>

			<p>Getting an error when I try to do the cold deploy - anyone have any ideas what I did wrong?</p>
<p>sudo  mongrel_rails cluster::start -C /var/www/spit_your_best_verse/current/config/mongrel_cluster.yml<br />
/usr/lib/ruby/gems/1.8/gems/mongrel_cluster-0.2.1/lib/mongrel_cluster/init.rb:23:in `merge!&#8217;: can&#8217;t convert String into Hash (TypeError)<br />
        from /usr/lib/ruby/gems/1.8/gems/mongrel_cluster-0.2.1/lib/mongrel_cluster/init.rb:23:in `read_options&#8217;<br />
        from /usr/lib/ruby/gems/1.8/gems/mongrel_cluster-0.2.1/lib/mongrel_cluster/init.rb:27:in `start&#8217;<br />
        from /usr/lib/ruby/gems/1.8/gems/mongrel_cluster-0.2.1/lib/mongrel_cluster/init.rb:95:in `run&#8217;<br />
        from /usr/lib/ruby/gems/1.8/gems/mongrel-1.0.1/lib/mongrel/command.rb:211:in `run&#8217;<br />
        from /usr/lib/ruby/gems/1.8/gems/mongrel-1.0.1/bin/mongrel_rails:243<br />
        from /usr/bin/mongrel_rails:16</p>

		</li>

	
	
		<li class=" " id="comment-15415">
    <a href='http://facts4.me.uk/blog/2007/06/29/links-for-2007-06-29/' title='Visit fact4s.me.uk weblog &raquo; Blog Archive &raquo; links for 2007-06-29'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://facts4.me.uk/blog/2007/06/29/links-for-2007-06-29/' rel='external nofollow' class='url'>fact4s.me.uk weblog &raquo; Blog Archive &raquo; links for 2007-06-29</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-15415" title="">June 29th, 2007 at 3:21pm</a> </small>

			<p>[...] Time For A Grown-Up Server: Rails, Mongrel, Apache, Capistrano and You | Archives | codablog | Coda &#8230; mongrel_rails cluster::configure -e production  -p 8000  -a 127.0.0.1  -N 3  -c /path/to/your/capistrano/setup&#8217;s/current (tags: mongrel rubyonrails apache2) [...]</p>

		</li>

	
	
		<li class="alt " id="comment-15432">
    <a href='http://www.julianonsoftware.com/?p=2102' title='Visit Julian On Software &raquo; Where are the locations of Ruby on Rails logs? (aka how do I find out what the error was in Rails)'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://www.julianonsoftware.com/?p=2102' rel='external nofollow' class='url'>Julian On Software &raquo; Where are the locations of Ruby on Rails logs? (aka how do I find out what the error was in Rails)</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-15432" title="">June 30th, 2007 at 12:22am</a> </small>

			<p>[...] Hale write a great piece on best practices for Mongrel / Apache integration and talks about Capistrano (the deployment framework).     &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0 [...]</p>

		</li>

	
	
		<li class=" " id="comment-16203">
    <a href='http://codeprostitute.com/2007/07/18/rails-deployment/' title='Visit Rails Deployment &laquo; Code Prostitute'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://codeprostitute.com/2007/07/18/rails-deployment/' rel='external nofollow' class='url'>Rails Deployment &laquo; Code Prostitute</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-16203" title="">July 17th, 2007 at 5:20pm</a> </small>

			<p>[...] Time For A Grown-Up Server: Rails, Mongrel, Apache, Capistrano and You [...]</p>

		</li>

	
	
		<li class="alt " id="comment-16454">
    <a href='http://www.clutterme.com' title='Visit Alex'><img src='http://www.gravatar.com/avatar.php?gravatar_id=75730c648d994f54cbfc84313576618e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://www.clutterme.com' rel='external nofollow' class='url'>Alex</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-16454" title="">July 24th, 2007 at 8:00am</a> </small>

			<p>Thanks for an excellent tutorial, Coda.  A year later it&#8217;s still very useful.</p>
<p>I wrote up some instructions for <a href="http://www.hahagreatidea.com/2007/07/capistrano-20-and-mongrel.html" rel="nofollow">adding Capistrano 2.0</a> to an existing Apache/Mongrel/Rails mix, if anyone is interested.</p>

		</li>

	
	
		<li class=" " id="comment-16715">
    <a href='http://pauldowman.com' title='Visit Paul Dowman'><img src='http://www.gravatar.com/avatar.php?gravatar_id=6436e3d1e0ac332c52b253c94667cb5b&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://pauldowman.com' rel='external nofollow' class='url'>Paul Dowman</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-16715" title="">July 30th, 2007 at 5:02pm</a> </small>

			<p>This has been really useful for me, thanks Coda! For Amazon EC2 users: I have created a public server image that is set up based on this article, for more info see:<br />
<a href="http://pauldowman.com/projects/ruby-on-rails-ec2/" rel="nofollow">http://pauldowman.com/projects/ruby-on-rails-ec2/</a></p>

		</li>

	
	
		<li class="alt " id="comment-16999">
    <a href='http://busha.net/archives/16' title='Visit busha.net &raquo; Blog Archive &raquo; Mongrel'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://busha.net/archives/16' rel='external nofollow' class='url'>busha.net &raquo; Blog Archive &raquo; Mongrel</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-16999" title="">August 6th, 2007 at 5:37pm</a> </small>

			<p>[...] very thoroughly. Check out  Mongrel&#8217;s site for more information. I would also recommend this guy&#8217;s site, but you&#8217;re smart enough to use google, I&#8217;m sure you can find your own [...]</p>

		</li>

	
	
		<li class=" " id="comment-17008">
    <a href='http://www.sthoughts.com/?p=329' title='Visit Rails: Apache 2.2 vs nginx 0.5.30 &raquo; stinger&#8217;s thoughts'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://www.sthoughts.com/?p=329' rel='external nofollow' class='url'>Rails: Apache 2.2 vs nginx 0.5.30 &raquo; stinger&#8217;s thoughts</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-17008" title="">August 7th, 2007 at 2:13am</a> </small>

			<p>[...] конфигуриране на Mongrel cluster, вижте страхотната статия на Coda Hale. За коректна Debian-базирана инсталация на Rails - вижте [...]</p>

		</li>

	
	
		<li class="alt " id="comment-17285">
    <a href='http://stingtao.info/?p=34' title='Visit 網路創業、web2.0技術、快樂生活 &raquo; Blog Archive &raquo; Ruby on Rails + Mongrel_cluster&#8230;續'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://stingtao.info/?p=34' rel='external nofollow' class='url'>網路創業、web2.0技術、快樂生活 &raquo; Blog Archive &raquo; Ruby on Rails + Mongrel_cluster&#8230;續</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-17285" title="">August 17th, 2007 at 9:44pm</a> </small>

			<p>[...] 1. <a href="http://blog.codahale.com/2006/06/19/time-for-a-grown-up-server-rails-mongrel-apache-capistrano-and-y.." rel="nofollow">http://blog.codahale.com/2006/06/19/time-for-a-grown-up-server-rails-mongrel-apache-capistrano-and-y..</a>. [...]</p>

		</li>

	
	
		<li class=" " id="comment-17329">
    <a href='http://blog.notedpath.com/2007/08/19/i-need-mod_proxy_balancer/' title='Visit A Noted Path &raquo; I need mod_proxy_balancer?'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://blog.notedpath.com/2007/08/19/i-need-mod_proxy_balancer/' rel='external nofollow' class='url'>A Noted Path &raquo; I need mod_proxy_balancer?</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-17329" title="">August 19th, 2007 at 4:10pm</a> </small>

			<p>[...] Time For a Grown-Up Server [...]</p>

		</li>

	
	
		<li class="alt " id="comment-17382">
    <a href='http://wildfalcon.com' title='Visit Laurie Young'><img src='http://www.gravatar.com/avatar.php?gravatar_id=9218dd1115bc620ec1ea79fd0368da8e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://wildfalcon.com' rel='external nofollow' class='url'>Laurie Young</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-17382" title="">August 22nd, 2007 at 2:00am</a> </small>

			<p>Thanks for the article, I had some strange problems with apache which I finally solved (with the help of a friend) so I thought I would put the fix here in case anyone else has the same problem. </p>
<p>Upon trying to start Apache I got the error &#8220;BalancerMember Can&#8217;t find &#8216;byrequests&#8217; lb method&#8221;. It turns out that you have to make sure you load mod_proxy, and mod_proxy_balancer. I only had mod_proxy loaded, which defines the &#8220;BalancerMemeber&#8221; directive (so I didn&#8217;t get Directive Not Found errors&#8221;, but doesn&#8217;t allow you to use it.</p>

		</li>

	
	
		<li class=" " id="comment-17397">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d733ce5e8b1b1f807f9886add07e9f7b&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>peter</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-17397" title="">August 22nd, 2007 at 9:29am</a> </small>

			<p>It all ran well until cap cold_deploy</p>
<p>cap cold_deploy<br />
the task `cold_deploy&#8217; does not exist</p>
<p>And there isn&#8217;t even a cold_deploy.rb in my filesystem.</p>
<p>Same with<br />
cap deploy<br />
the task `deploy&#8217; does not exist<br />
Although I edited the<br />
/var/lib/gems/1.8/gems/capistrano-2.0.0/lib/capistrano/recipes/deploy.rb</p>
<p>cap -T<br />
cap invoke # Invoke a single command on the remote servers.<br />
cap shell  # Begin an interactive Capistrano session.</p>
<p>Any Idea?</p>

		</li>

	
	
		<li class="alt " id="comment-17403">
    <a href='http://www.zorched.net/2007/08/22/mongrel-cluster-and-apache-need-memory/' title='Visit Mongrel Cluster and Apache Need Memory'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://www.zorched.net/2007/08/22/mongrel-cluster-and-apache-need-memory/' rel='external nofollow' class='url'>Mongrel Cluster and Apache Need Memory</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-17403" title="">August 22nd, 2007 at 11:19am</a> </small>

			<p>[...] mongrel instances are proxied behind Apache using mod_proxy_balance as described here. This setup works very well and is more and more becoming the defacto standard for deploying Rails [...]</p>

		</li>

	
	
		<li class=" " id="comment-17406">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d733ce5e8b1b1f807f9886add07e9f7b&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>peter</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-17406" title="">August 22nd, 2007 at 1:50pm</a> </small>

			<p>I found out I used capistrano-2.0.0.</p>
<p>I downloaded capistrano-1.4.1.gem from the sourceforge website and installed it after unbinstalling capistrano-2.0.0.</p>
<p>Now cap cold_deploy and cap deploy works.</p>

		</li>

	
	
		<li class="alt " id="comment-17495">
    <a href='http://www.dbnetworx.de' title='Visit Daniel'><img src='http://www.gravatar.com/avatar.php?gravatar_id=0e8ab320230f8ce7aeacf9910783850e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://www.dbnetworx.de' rel='external nofollow' class='url'>Daniel</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-17495" title="">August 26th, 2007 at 4:53am</a> </small>

			<p>Thanks for your great tutorial. I managed to get everything up and running. I had to do some things manually, because I couldn&#8217;t get Capistrano 2 work smoothly together with mongrel cluster and I have another problem. I missed something while configuring Apache, because when I browse through my application it won&#8217;t show any pictures in the images folder and it won&#8217;t link correctly to the stylesheets folder. Do you have any suggestions? Thanks for any help! Greets, Daniel</p>

		</li>

	
	
		<li class=" " id="comment-17554">
    <a href='http://www.mygreencorner.com' title='Visit Dugu'><img src='http://www.gravatar.com/avatar.php?gravatar_id=4ecafdcf5eeb4c1676188391a6cf24d7&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://www.mygreencorner.com' rel='external nofollow' class='url'>Dugu</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-17554" title="">August 28th, 2007 at 12:16am</a> </small>

			<p>Thanks for the tips. It was really easy to work things out. Cheers</p>

		</li>

	
	
		<li class="alt " id="comment-17605">
    <a href='http://www.supersaas.com' title='Visit JanM'><img src='http://www.gravatar.com/avatar.php?gravatar_id=c56a6c072fb05a943397faf1799aa118&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://www.supersaas.com' rel='external nofollow' class='url'>JanM</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-17605" title="">August 29th, 2007 at 12:49pm</a> </small>

			<p>About the apache.conf:<br />
I think this line has a superfluos &#8216;/&#8217; in the middle (but works apparently):<br />
RewriteCond %{DOCUMENT_ROOT}/%{REQUEST_FILENAME} !-f</p>
<p>also, you don&#8217;t need the ( and ) on this line, since you&#8217;re not referencing the match:<br />
RewriteRule ^/(.*)$ balancer://domain.com_cluster%{REQUEST_URI} [P,QSA,L]</p>

		</li>

	
	
		<li class=" " id="comment-17840">
    <a href='http://haru.homelinux.org/blogs/blog/2007/09/03/apache-and-mongrel/' title='Visit Apache and Mongrel at Haru&#8217;s Diary'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://haru.homelinux.org/blogs/blog/2007/09/03/apache-and-mongrel/' rel='external nofollow' class='url'>Apache and Mongrel at Haru&#8217;s Diary</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-17840" title="">September 3rd, 2007 at 11:00am</a> </small>

			<p>[...] to use Apache2 as a kind of Proxy for Mongrel. It turns out that there&#8217;s a great one over at CodaHale. So if you&#8217;re looking for something like I did, I would really recommend this [...]</p>

		</li>

	
	
		<li class="alt " id="comment-18240">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=580651179706e7773017e93d98e05738&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>jereme</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-18240" title="">September 11th, 2007 at 4:17pm</a> </small>

			<p>I’m running into a problem with the Apache2 setup. Every time I try and access the site I receive a “404 Not Found” page. I’m guessing the rewrite rules are not in effect, but have no clue how to make them work properly.</p>
<p>I&#8217;m trying to set up redMine in Ubuntu.</p>
<p>Any help is much appreciated!</p>

		</li>

	
	
		<li class=" " id="comment-18332">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=b57d96d989cfb46b67524bf5d5035820&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Scott</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-18332" title="">September 13th, 2007 at 2:48pm</a> </small>

			<p>Casey and Richard:<br />
I was having similar issues.  Finally figured out that I had to add<br />
Timeout AND ProxyTimeout to the Virtual Host.  So:</p>
<p>Timeout xx (seconds)<br />
ProxyTimeout xx (same number of seconds)</p>

		</li>

	
	
		<li class="alt " id="comment-18554">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=62220bfbf909539e529fee191346f9b1&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>phil</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-18554" title="">September 18th, 2007 at 1:47am</a> </small>

			<p>Thanks for this excellent walkthru.</p>
<p>I used it to setup Apache 2.2, Mongrel 1.0.1, Mongrel Cluster 1.0.2,<br />
Rails 1.2.3 on Debian Etch.</p>
<p>I used the following commands to enable all required modules for<br />
apache.</p>
<p><code><br />
a2enmod rewrite<br />
a2enmod deflate<br />
a2enmod proxy<br />
a2enmod proxy_balancer<br />
a2enmod proxy_http<br />
</code></p>
<p>It took me a while to figure the last one out, although I&#8217;ve to admit<br />
that the error message was quite precise:</p>
<p><code><br />
No protocol handler was valid for the URL /. If you are using a<br />
DSO version of mod_proxy, make sure the proxy submodules are included in the configuration using LoadModule.<br />
</code></p>
<p>In addition to the steps mentioned here I had to create two symlinks<br />
to make my system find mongrel&#8217;s executables</p>
<p><code><br />
ln -s /var/lib/gems/1.8/bin/mongrel_cluster_ctl /usr/bin/mongrel_cluster<br />
ln -s /var/lib/gems/1.8/bin/mongrel_rails /usr/bin/<br />
</code></p>
<p>I&#8217;m not sure this is the way it&#8217;s meant to be, but it worked for me.</p>
<p>I put my app&#8217;s config for apache in one file<br />
/etc/apache2/sites-available/myapp and enabled it issuing</p>
<p><code><br />
a2ensite myapp<br />
</code><code></p>
<p>Debian users might want to change the location of the logfiles, as<br />
well as the previous mentioned proxy section, adding</p>
<p></code><code><br />
Allow from all<br />
</code><code></p>
<p>to avoid 403 Errors.</p>
<p>On my freshly setup etch I also had to edit<br />
/etc/apache2/sites-available/default changing the asterisks of the<br />
first and second line to the machine's ipaddress, appending the ports<br />
(one NameVirtualHost for each port) due to the following error (I also<br />
did this for myapp):</p>
<p></code><code><br />
mixing * ports and non-* ports with a NameVirtualHost address is not<br />
supported, proceeding with undefined results<br />
</code></p>
<p>It now reads like this:</p>
<p><code><br />
NameVirtualHost xxx.xxx.xxx.xxx:80<br />
NameVirtualHost xxx.xxx.xxx.xxx:8080<br />
&lt;VirtualHost xxx.xxx.xxx.xxx:80&gt;<br />
...<br />
</code></p>
<p>I&#8217;m sure I forgot to mention something, sorry for that.</p>
<p>Oh, I changed the setup of the Mongrel Cluster from three to four<br />
workers, because for a dual core machine it just felt right to have a<br />
multiple of two, but I am now pro on that topic. ;)</p>

		</li>

	
	
		<li class=" " id="comment-18774">
    <a href='http://justbarebones.blogspot.com' title='Visit Chetan Patil'><img src='http://www.gravatar.com/avatar.php?gravatar_id=8f7969fb7e3431d73ff3ed946ea159c6&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://justbarebones.blogspot.com' rel='external nofollow' class='url'>Chetan Patil</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-18774" title="">September 23rd, 2007 at 2:02pm</a> </small>

			<p>Looks like my earlier comment didn&#8217;t get through&#8230;<br />
&#8212;&#8212;&#8212;&#8212;-<br />
Thanks for the writeup Coda. Very helpful.</p>
<p>To make the above setup more secure to deny .svn/* requests, add the following rewrite rule to myapp.common<br />
  &#8230;<br />
  # Uncomment for rewrite debugging<br />
  #RewriteLog logs/myapp_rewrite_log<br />
  #RewriteLogLevel 9 </p>
<p>  # Don&#8217;t allow any .svn accesses<br />
  RewriteRule ^(.*/)?\.svn/? - [F,L]<br />
  ErrorDocument 403 &#8220;Access Forbidden.&#8221;</p>
<p>  # Check for maintenance file and redirect all requests<br />
  RewriteCond %{DOCUMENT_ROOT}/system/maintenance.html -f<br />
  &#8230;</p>
<p>Of course, you can avoid having .svn directories in the released code by configuring Capistrano to use svn export instead of svn checkout. But I had an older setup that I don&#8217;t want to update to the new Capistrano version yet.</p>
<p>Adding </p>
<p>    Order allow,deny<br />
    Deny from all</p>
<p>didnt&#8217; help since the RewriteEngine was still matching the request and passing it on to the proxy. It took me some time to figure that out, so wanted to throw it out for others.</p>

		</li>

	
	
		<li class="alt " id="comment-18775">
    <a href='http://justbarebones.blogspot.com' title='Visit Chetan Patil'><img src='http://www.gravatar.com/avatar.php?gravatar_id=8f7969fb7e3431d73ff3ed946ea159c6&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://justbarebones.blogspot.com' rel='external nofollow' class='url'>Chetan Patil</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-18775" title="">September 23rd, 2007 at 2:05pm</a> </small>

			<p>Messed up the formatting:</p>
<p>The DirectoryMatch code that didn&#8217;t work is:</p>
<p>&lt;DirectoryMatch &#8220;^.*/\.svn/&#8221;&gt;<br />
   Order allow,deny<br />
   Deny from all<br />
&lt;/DirectoryMatch&gt;</p>

		</li>

	
	
		<li class=" " id="comment-18909">
    <a href='http://brianbruijn.wordpress.com/2007/09/27/rails-server-configuration/' title='Visit Rails server configuration &laquo; Technology Forward'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://brianbruijn.wordpress.com/2007/09/27/rails-server-configuration/' rel='external nofollow' class='url'>Rails server configuration &laquo; Technology Forward</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-18909" title="">September 26th, 2007 at 9:04pm</a> </small>

			<p>[...] <a href="http://blog.codahale.com/2006/06/19/time-for-a-grown-up-server-rails-mongrel-apache-capistrano-and-y.." rel="nofollow">http://blog.codahale.com/2006/06/19/time-for-a-grown-up-server-rails-mongrel-apache-capistrano-and-y..</a>. [...]</p>

		</li>

	
	
		<li class="alt " id="comment-18929">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=1aa71952210940003ca364458f47af83&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Christian Frugard</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-18929" title="">September 27th, 2007 at 2:46pm</a> </small>

			<p>I am using a Mongrel + Apache 2.2 configuration.  It works great, and I am able to rewrite the remote_user header so we dont have a login page (on intranet).  Problem is, when using Ajax calls, it any request parameters are lost on repeated, quick requests.  If the user waits more than about 5 seconds between requests, the request is fine; less than that, the paramters are lost.  This only happens when proxying through Apache.  Has anyone else seen this behavior?</p>

		</li>

	
	
		<li class=" " id="comment-19097">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=8e01a4d029c6073279ae7287665d5550&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>David Badawi</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-19097" title="">October 2nd, 2007 at 6:10pm</a> </small>

			<p>Incredibly useful tutorial. Thanks for taking the time to share and teach.</p>

		</li>

	
	
		<li class="alt " id="comment-19159">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=5176a374c44f0847d90b7f3e3c476f33&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>BruceH</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-19159" title="">October 4th, 2007 at 7:19am</a> </small>

			<p>On the security issue, what if I only want to secure the Rails app? Would the config for SSL change? And what if I wanted to leave a couple of Rails requests (let&#8217;s say all that reference a particular controller) open to the world (i.e. search and view), but the rest of the app (DB maintenance) pieces will be secured. How would that change the  config?</p>

		</li>

	
	
		<li class=" " id="comment-19160">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=5176a374c44f0847d90b7f3e3c476f33&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>BruceH</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-19160" title="">October 4th, 2007 at 7:20am</a> </small>

			<p>I meant to add that the static content would NOT be secured.</p>

		</li>

	
	
		<li class="alt " id="comment-19420">
    <a href='http://caiwangqin.wordpress.com/2007/10/13/links-for-2007-10-12/' title='Visit links for 2007-10-12 &laquo; Caiwangqin&#8217;s delicious bog'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://caiwangqin.wordpress.com/2007/10/13/links-for-2007-10-12/' rel='external nofollow' class='url'>links for 2007-10-12 &laquo; Caiwangqin&#8217;s delicious bog</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-19420" title="">October 12th, 2007 at 3:18pm</a> </small>

			<p>[...] Time For A Grown-Up Server: Rails, Mongrel, Apache, Capistrano and You | Archives | codablog | Coda &#8230; (tags: deploy rails mongrel capistrano) [...]</p>

		</li>

	
	
		<li class=" " id="comment-19929">
    <a href='http://viktortron.org' title='Visit viktor tron'><img src='http://www.gravatar.com/avatar.php?gravatar_id=654955d0e6716c845ebe450f583a69a7&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://viktortron.org' rel='external nofollow' class='url'>viktor tron</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-19929" title="">October 27th, 2007 at 12:39pm</a> </small>

			<p>update on comments 194<br />
check this out for a rails virtual appliance<br />
<a href="http://ec2onrails.rubyforge.org/" rel="nofollow">http://ec2onrails.rubyforge.org/</a></p>

		</li>

	
	
		<li class="alt " id="comment-20032">
    <a href='http://www.simplisticcomplexity.com/2006/08/18/clustered-mongrel-in-a-shared-environment/' title='Visit Simplistic Complexity &raquo; Clustered Mongrel In A Shared Environment'><img src='http://www.gravatar.com/avatar.php?gravatar_id=366472c969c9754ae2b8079e42fed1ca&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://www.simplisticcomplexity.com/2006/08/18/clustered-mongrel-in-a-shared-environment/' rel='external nofollow' class='url'>Simplistic Complexity &raquo; Clustered Mongrel In A Shared Environment</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-20032" title="">October 29th, 2007 at 12:40pm</a> </small>

			<p>[...] you&#8217;ve read Coda&#8217;s motivating post on getting this stack up and running, then some of this will be familiar to you. I&#8217;d suggest [...]</p>

		</li>

	
	
		<li class=" " id="comment-20033">
    <a href='http://www.simplisticcomplexity.com/2006/08/13/apache-2-2-mod_proxy_balancer-mongrel-on-ubuntu-6-06/' title='Visit Simplistic Complexity &raquo; Apache 2.2, mod_proxy_balancer, &#38; Mongrel on Ubuntu 6.06'><img src='http://www.gravatar.com/avatar.php?gravatar_id=366472c969c9754ae2b8079e42fed1ca&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://www.simplisticcomplexity.com/2006/08/13/apache-2-2-mod_proxy_balancer-mongrel-on-ubuntu-6-06/' rel='external nofollow' class='url'>Simplistic Complexity &raquo; Apache 2.2, mod_proxy_balancer, &#38; Mongrel on Ubuntu 6.06</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-20033" title="">October 29th, 2007 at 12:40pm</a> </small>

			<p>[...] comes strait from Coda, which came strait from Zed. And you listen to [...]</p>

		</li>

	
	
		<li class="alt " id="comment-20053">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=74e79baaeac998bce28439af40b74bdf&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Jónas Tryggvi</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-20053" title="">October 30th, 2007 at 2:31am</a> </small>

			<p>Hi and thanks for a great article. I used it as a reference while setting up my system, and everything works great! </p>
<p>BUT; when using Safari 3 on Windows on HTTPS parts of the web which is served by Apache 2.2, images start to randomly disappear. Any ideas on what is happening? This is probably a SSL/Apache issue, but I couldn&#8217;t find anything on it anywhere.</p>

		</li>

	
	
		<li class=" " id="comment-20683">
    <a href='http://www.guitargeorge.de' title='Visit guitargeorge'><img src='http://www.gravatar.com/avatar.php?gravatar_id=1fbe27946823ece0d1ab14639653f8de&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://www.guitargeorge.de' rel='external nofollow' class='url'>guitargeorge</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-20683" title="">November 7th, 2007 at 3:37pm</a> </small>

			<p>I&#8217;ve never heard about Capistrano before, but now i don&#8217;t wanna miss Capistrano.</p>

		</li>

	
	
		<li class="alt " id="comment-20773">
    <a href='http://www.paolocorti.net/public/wordpress/index.php/2007/11/08/ruby-on-rails-applications-with-mongrel-clusters-and-apache-on-ubuntu/' title='Visit Ruby on Rails applications with Mongrel cluster and Apache url rewriting on Ubuntu : Thinking in GIS'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://www.paolocorti.net/public/wordpress/index.php/2007/11/08/ruby-on-rails-applications-with-mongrel-clusters-and-apache-on-ubuntu/' rel='external nofollow' class='url'>Ruby on Rails applications with Mongrel cluster and Apache url rewriting on Ubuntu : Thinking in GIS</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-20773" title="">November 8th, 2007 at 8:06am</a> </small>

			<p>[...] blog.codahale.com kpumuk.info Bookmark [...]</p>

		</li>

	
	
		<li class=" " id="comment-21184">
    <a href='http://www.crackmac.com/?p=222' title='Visit &nbsp; Time For A Grown-Up Server: Rails, Mongrel, Apache, Capistrano and You | codablog | Coda Hale&nbsp;by&nbsp;CRACKMAC.COM'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://www.crackmac.com/?p=222' rel='external nofollow' class='url'>&nbsp; Time For A Grown-Up Server: Rails, Mongrel, Apache, Capistrano and You | codablog | Coda Hale&nbsp;by&nbsp;CRACKMAC.COM</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-21184" title="">November 16th, 2007 at 4:49pm</a> </small>

			<p>[...] Time For A Grown-Up Server: Rails, Mongrel, Apache, Capistrano and You | codablog | Coda Hale More and more Rails developers are finding out that deploying a Rails application isn’t as simple as upload and rename; Rails apps work best when running all the time, and many Rails programmers are moving from traditional, shared hosts, like Dreamhost, to virtual private servers, like Rimuhosting, which allow them full control and responsibility of production servers. [...]</p>

		</li>

	
	
		<li class="alt " id="comment-21756">
    <a href='http://taylordavis.com/blog/2007/11/28/links-for-2007-11-28/' title='Visit taylordavis.com &raquo; Blog Archive &raquo; links for 2007-11-28'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://taylordavis.com/blog/2007/11/28/links-for-2007-11-28/' rel='external nofollow' class='url'>taylordavis.com &raquo; Blog Archive &raquo; links for 2007-11-28</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-21756" title="">November 27th, 2007 at 7:34pm</a> </small>

			<p>[...] Time For A Grown-Up Server: Rails, Mongrel, Apache, Capistrano and You | Archives | codablog | Coda &#8230; (tags: rubyonrails reference) [...]</p>

		</li>

	
	
		<li class=" " id="comment-22114">
    <a href='http://unixmonkey.net/blog/?p=4' title='Visit Unixmonkey.net &raquo; Blog Archive &raquo; BigNerdRanch Ruby on Rails Retreat'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://unixmonkey.net/blog/?p=4' rel='external nofollow' class='url'>Unixmonkey.net &raquo; Blog Archive &raquo; BigNerdRanch Ruby on Rails Retreat</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-22114" title="">December 4th, 2007 at 7:42pm</a> </small>

			<p>[...] Lastly, we talked about deployment, and how Charles&#8217; preferred method for deployment is Apache+mongrel. We talked about Capistrano and the way it maintains symlinks to the current svn pulldown for versioning and easy rollback. An excellent article on deploying with apache and mongrel is Coda Hale&#8217;s Time for a Grown Up Server. [...]</p>

		</li>

	
	
		<li class="alt " id="comment-22133">
    <a href='http://www.paulcowles.com/2007/11/26/links-for-2007-11-26/' title='Visit &raquo; links for 2007-11-26 | Paul Cowles'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://www.paulcowles.com/2007/11/26/links-for-2007-11-26/' rel='external nofollow' class='url'>&raquo; links for 2007-11-26 | Paul Cowles</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-22133" title="">December 5th, 2007 at 12:16pm</a> </small>

			<p>[...] Time For A Grown-Up Server: Rails, Mongrel, Apache, Capistrano and You | Archives | codablog | Coda &#8230; talk of setting up mongrel clusters (tags: rails hosting) [...]</p>

		</li>

	
	
		<li class=" " id="comment-22236">
    <a href='http://stonie.homelinux.net:81/2007/12/17/der-stille-wechsel/' title='Visit Stonie&#8217;s Linux Sachen &raquo; Blog Archive &raquo; Ein stiller Wechsel'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://stonie.homelinux.net:81/2007/12/17/der-stille-wechsel/' rel='external nofollow' class='url'>Stonie&#8217;s Linux Sachen &raquo; Blog Archive &raquo; Ein stiller Wechsel</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-22236" title="">December 17th, 2007 at 11:56am</a> </small>

			<p>[...] hat sich das Ruby-basierte Typo als nicht sehr performant erwiesen. Dies obwohl ich ein Mongrel-Cluster-Setup ausprobiert hatte, dauerte das Rendering der Index-Seite teilweise über 40 Sekunden, wenn das [...]</p>

		</li>

	
	
		<li class="alt " id="comment-22697">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=e699fc43867029dcfa1f51b20f07f420&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>2dc</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-22697" title="">December 21st, 2007 at 2:05am</a> </small>

			<p>Hi,</p>
<p>Thanks for this howto.</p>
<p>I just have a problem with static files (images, css, &#8230;), they are rendered very slowly. I have messages like this for every static file in my log :</p>
<p>[21/Dec/2007:10:58:26 +0100] [myapp.com/sid#800f64c0][rid#80242a80/initial] (3) applying pattern &#8216;^/$&#8217; to uri &#8216;/images/logo.png&#8217;<br />
[21/Dec/2007:10:58:26 +0100] [myapp.com/sid#800f64c0][rid#80242a80/initial] (3) applying pattern &#8216;^([^.]+)$&#8217; to uri &#8216;/images/logo.png&#8217;<br />
[21/Dec/2007:10:58:26 +0100] [myapp.com/sid#800f64c0][rid#80242a80/initial] (3) applying pattern &#8216;^/(.*)$&#8217; to uri &#8216;/images/logo.png&#8217;<br />
[21/Dec/2007:10:58:26 +0100] [myapp.com/sid#800f64c0][rid#80242a80/initial] (4) RewriteCond: input=&#8217;/var/www/rails/myapp/public/images/logo.png&#8217; pattern=&#8217;!-f&#8217; =&gt; not-matched<br />
[21/Dec/2007:10:58:26 +0100] [myapp.com/sid#800f64c0][rid#80242a80/initial] (1) pass through /images/logo.png</p>
<p>Do you have any idea? :(</p>
<p>Thanks in advance!</p>

		</li>

	
	
		<li class=" " id="comment-22698">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=e699fc43867029dcfa1f51b20f07f420&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>2dc</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-22698" title="">December 21st, 2007 at 2:05am</a> </small>

			<p>Hi,</p>
<p>Thanks for this howto.</p>
<p>I just have a problem with static files (images, css, &#8230;), they are rendered very slowly. I have messages like this for every static file in my log :</p>
<p><code>[21/Dec/2007:10:58:26 +0100] [myapp.com/sid#800f64c0][rid#80242a80/initial] (3) applying pattern &#8216;^/$&#8217; to uri &#8216;/images/logo.png&#8217;<br />
[21/Dec/2007:10:58:26 +0100] [myapp.com/sid#800f64c0][rid#80242a80/initial] (3) applying pattern &#8216;^([^.]+)$&#8217; to uri &#8216;/images/logo.png&#8217;<br />
[21/Dec/2007:10:58:26 +0100] [myapp.com/sid#800f64c0][rid#80242a80/initial] (3) applying pattern &#8216;^/(.*)$&#8217; to uri &#8216;/images/logo.png&#8217;<br />
[21/Dec/2007:10:58:26 +0100] [myapp.com/sid#800f64c0][rid#80242a80/initial] (4) RewriteCond: input=&#8217;/var/www/rails/myapp/public/images/logo.png&#8217; pattern=&#8217;!-f&#8217; =&gt; not-matched<br />
[21/Dec/2007:10:58:26 +0100] [myapp.com/sid#800f64c0][rid#80242a80/initial] (1) pass through /images/logo.png</code></p>
<p>Do you have any idea? :(</p>
<p>Thanks in advance!</p>

		</li>

	
	
		<li class="alt " id="comment-24730">
    <a href='http://unixmonkey.net/?p=8' title='Visit Unixmonkey.net &raquo; Blog Archive &raquo; Setting up a production rails server step-by-step'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://unixmonkey.net/?p=8' rel='external nofollow' class='url'>Unixmonkey.net &raquo; Blog Archive &raquo; Setting up a production rails server step-by-step</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-24730" title="">January 5th, 2008 at 7:00am</a> </small>

			<p>[...] For Rails, there are lots of deployment strategies, some are tuned for compatibility with shared hosting (fastcgi), and some are built for speed and minimum configuration (Litespeed Nginx and Lighttpd), and some are built to leverage the strength and flexibility of stable and established server software (Apache+Mongrel). [...]</p>

		</li>

	
	
		<li class=" " id="comment-24762">
    <a href='http://www.socialtwister.com/2008/01/05/links-for-2008-01-05/' title='Visit links for 2008-01-05'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://www.socialtwister.com/2008/01/05/links-for-2008-01-05/' rel='external nofollow' class='url'>links for 2008-01-05</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-24762" title="">January 5th, 2008 at 12:19pm</a> </small>

			<p>[...] Time For A Grown-Up Server: Rails, Mongrel, Apache, Capistrano and You | Archives | codablog | Coda &#8230; (tags: capistrano deployment mongrel rails) [...]</p>

		</li>

	
	
		<li class="alt " id="comment-24797">
    <a href='http://www.ischroedi.de' title='Visit schroedi'><img src='http://www.gravatar.com/avatar.php?gravatar_id=909a70ada757f2fe491fbdb87231fa3f&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://www.ischroedi.de' rel='external nofollow' class='url'>schroedi</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-24797" title="">January 5th, 2008 at 7:11pm</a> </small>

			<p>The best Tutorial I ever read.</p>
<p>Great Stuff</p>

		</li>

	
	
		<li class=" " id="comment-25191">
    <a href='http://www.hotmediamess.com/2008/01/08/zed-shaw-holy-crap/' title='Visit Zed Shaw&#8212;Holy Crap | Hot Media Mess'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://www.hotmediamess.com/2008/01/08/zed-shaw-holy-crap/' rel='external nofollow' class='url'>Zed Shaw&#8212;Holy Crap | Hot Media Mess</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-25191" title="">January 8th, 2008 at 12:07am</a> </small>

			<p>[...] Thankfully, the sites I&#8217;ve deployed with RoR have caching in place, and essentially amount to a simple static HTML site for Apache to spew out (courtesy of this post). [...]</p>

		</li>

	
	
		<li class="alt " id="comment-25501">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=943e594aab9a882d54b439934b1447bc&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>maha</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-25501" title="">January 9th, 2008 at 9:52pm</a> </small>

			<p>am a newbie to ubuntu. iam totally lame about the concept. so will you kindly tell HOW To starting from apache2.2 and mainly the location of the folders containing the file. my task is to deploy a web server with apache2 with fastcgi &amp; ruby on rails &amp; mongrel &amp; mod_proxy_balancer.<br />
can you pls help me&#8230;</p>

		</li>

	
	
		<li class=" " id="comment-25664">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=50932e847e6a21e1d542cf5a207e8d8c&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>Carlos</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-25664" title="">January 11th, 2008 at 2:08am</a> </small>

			<p>works perfect!! thank you very much!!</p>

		</li>

	
	
		<li class="alt " id="comment-25865">
    <a href='http://www.ekohe.com' title='Visit Maxime'><img src='http://www.gravatar.com/avatar.php?gravatar_id=6719a2ee05da4c03415c86200d84eaab&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://www.ekohe.com' rel='external nofollow' class='url'>Maxime</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-25865" title="">January 11th, 2008 at 7:19pm</a> </small>

			<p>Very useful post. It helped me a lot.</p>
<p>Thanks!</p>
<p>Maxime</p>

		</li>

	
	
		<li class=" " id="comment-26261">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=0e6725122f700aa7a07a9cb94ceebce9&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>rufio</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-26261" title="">January 13th, 2008 at 5:52am</a> </small>

			<p>Hi, can I set up for more applications (domains). If Yes, do U know how? Many thanks!!!</p>

		</li>

	
	
		<li class="alt " id="comment-26798">
    <a href='http://www.gravatar.com' title='Create your own gravatar at gravatar.com!'><img src='http://www.gravatar.com/avatar.php?gravatar_id=dbb4d2e03089a8bf8994c2708e23bace&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite>G</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-26798" title="">January 16th, 2008 at 1:06am</a> </small>

			<p>Thanks for the article. It was helpful, especially the SSL section.</p>

		</li>

	
	
		<li class=" " id="comment-27053">
    <a href='http://samsaffron.com' title='Visit Sam Saffron'><img src='http://www.gravatar.com/avatar.php?gravatar_id=3dcae8378d46c244172a115c28ca49ce&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://samsaffron.com' rel='external nofollow' class='url'>Sam Saffron</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-27053" title="">January 16th, 2008 at 11:50pm</a> </small>

			<p>I second Ray on the x-javascript issue, My apache debian server has the same issue, it serves out javascript as x-javascript </p>
<p>Also, YSlow recommends adding expire tags which I did in the following way &#8230; </p>
<p>        ExpiresActive On<br />
        ExpiresByType text/css &#8220;access plus 1 month&#8221;<br />
        ExpiresByType text/javascript &#8220;access plus 1 month&#8221;<br />
        ExpiresByType application/x-javascript &#8220;access plus 1 month&#8221;<br />
        ExpiresByType image/png &#8220;access plus 1 week&#8221;</p>
<p>On another note I noticed this gravatar support is a performance hog, it may make sense to pre-cache images on the server &#8230;</p>

		</li>

	
	
		<li class="alt " id="comment-28174">
    <a href='http://jupiterit.com' title='Visit Brian Moschel'><img src='http://www.gravatar.com/avatar.php?gravatar_id=918c96074c0657986867594b9b32f113&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://jupiterit.com' rel='external nofollow' class='url'>Brian Moschel</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-28174" title="">January 23rd, 2008 at 3:29am</a> </small>

			<p>This tutorial got me most of the way through initial deployment.  Thanks for your hard work.  Another series of Deployment 101 articles that might be helpful is posted here:</p>
<p><a href="http://jupiterit.com/wordpress/?p=190" rel="nofollow">http://jupiterit.com/wordpress/?p=190</a></p>
<p>I documented all the problems I had with deployment and created a step by step guide for each stage.  Hope its helpful.</p>

		</li>

	
	
		<li class=" " id="comment-31061">
    <a href='http://slaptijack.com/tech-messages/tech-messages-2008-02-04/' title='Visit Tech Messages | 2008-02-04 | Slaptijack'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://slaptijack.com/tech-messages/tech-messages-2008-02-04/' rel='external nofollow' class='url'>Tech Messages | 2008-02-04 | Slaptijack</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-31061" title="">February 4th, 2008 at 4:34pm</a> </small>

			<p>[...] Time For A Grown-Up Server: Rails, Mongrel, Apache, Capistrano and You | Archives | codablog | Coda &#8230;Walk-through to help you get your Ruby on Rails application up and running as soon as possible. [...]</p>

		</li>

	
	
		<li class="alt " id="comment-31216">
    <a href='http://none' title='Visit nosyjoe'><img src='http://www.gravatar.com/avatar.php?gravatar_id=04dae278d0b6a2fe06a167b074e0490a&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://none' rel='external nofollow' class='url'>nosyjoe</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-31216" title="">February 5th, 2008 at 10:08am</a> </small>

			<p>to all who get the rrror message</p>
<p>!! Path to log file not valid: log/mongrel.log</p>
<p>In my case it helped when I added the following line to my mongrel_cluster.yml config file:</p>
<p>cwd: /home//current/</p>
<p>hope that helps!</p>

		</li>

	
	
		<li class=" " id="comment-31524">
    <a href='http://reader.heberts.net/tech-messages-2008-02-04/' title='Visit Scott&#8217;s Feed Reader &raquo; Blog Archive &raquo; Tech Messages | 2008-02-04'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://reader.heberts.net/tech-messages-2008-02-04/' rel='external nofollow' class='url'>Scott&#8217;s Feed Reader &raquo; Blog Archive &raquo; Tech Messages | 2008-02-04</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-31524" title="">February 7th, 2008 at 1:59am</a> </small>

			<p>[...] Time For A Grown-Up Server: Rails, Mongrel, Apache, Capistrano and You | Archives | codablog | Coda &#8230;Walk-through to help you get your Ruby on Rails application up and running as soon as possible. [...]</p>

		</li>

	
	
		<li class="alt " id="comment-31685">
    <a href='http://devuelosbaratos.es' title='Visit Vuelos'><img src='http://www.gravatar.com/avatar.php?gravatar_id=57e149f4ccba525c928fbfef46c18214&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://devuelosbaratos.es' rel='external nofollow' class='url'>Vuelos</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-31685" title="">February 8th, 2008 at 4:15pm</a> </small>

			<p>works perfect!! thank you very much!!</p>

		</li>

	
	
		<li class=" " id="comment-32304">
    <a href='http://www.fiid.net/?p=39' title='Visit Fiid&#8217;s Blog &raquo; Blog Archive &raquo; Rails: The Other Foot.'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://www.fiid.net/?p=39' rel='external nofollow' class='url'>Fiid&#8217;s Blog &raquo; Blog Archive &raquo; Rails: The Other Foot.</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-32304" title="">February 13th, 2008 at 1:51am</a> </small>

			<p>[...] reveal yet more information, including the &#8220;pack-of-mongrels&#8221; approach which is detailed on Coda Hale&#8217;s blog. Thanks to both of these guys for very succinctly laying out solutions and issues on rails [...]</p>

		</li>

	
	
		<li class="alt " id="comment-33617">
    <a href='http://www.glennfu.com/2008/02/01/deploying-ruby-on-rails-with-capistrano-on-dreamhost/' title='Visit Deploying Ruby on Rails with Capistrano on DreamHost &#8212; Glenn Fu'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://www.glennfu.com/2008/02/01/deploying-ruby-on-rails-with-capistrano-on-dreamhost/' rel='external nofollow' class='url'>Deploying Ruby on Rails with Capistrano on DreamHost &#8212; Glenn Fu</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-33617" title="">February 20th, 2008 at 1:00pm</a> </small>

			<p>[...] you don&#8217;t like the trouble caused by dealing with Ruby on Rails on DreamHost, check out this article for some ideas of good [...]</p>

		</li>

	
	
		<li class=" " id="comment-35042">
    <a href='http://dagobart.wordpress.com/2008/03/02/some-probably-useful-links-to-get-into-ruby-on-rails/' title='Visit some probably useful links to get into Ruby on Rails &laquo; Arnold Funken on social site building'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://dagobart.wordpress.com/2008/03/02/some-probably-useful-links-to-get-into-ruby-on-rails/' rel='external nofollow' class='url'>some probably useful links to get into Ruby on Rails &laquo; Arnold Funken on social site building</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-35042" title="">March 2nd, 2008 at 9:09am</a> </small>

			<p>[...] rails x apache [...]</p>

		</li>

	
	
		<li class="alt " id="comment-35071">
    <a href='http://krisselden.com/2007/02/25/rails-deployment/' title='Visit Kris&#8217; Blog &raquo; Blog Archive &raquo; Rails deployment'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://krisselden.com/2007/02/25/rails-deployment/' rel='external nofollow' class='url'>Kris&#8217; Blog &raquo; Blog Archive &raquo; Rails deployment</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-35071" title="">March 2nd, 2008 at 4:03pm</a> </small>

			<p>[...] Time For A Grown-Up Server: Rails, Mongrel, Apache, Capistrano and You [...]</p>

		</li>

	
	
		<li class=" " id="comment-38431">
    <a href='http://www.commonmediainc.com/2008/03/27/y-be-slow/' title='Visit Common Media, Inc. &raquo; Blog Archive &raquo; Y Be Slow?'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://www.commonmediainc.com/2008/03/27/y-be-slow/' rel='external nofollow' class='url'>Common Media, Inc. &raquo; Blog Archive &raquo; Y Be Slow?</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-38431" title="">March 27th, 2008 at 4:10pm</a> </small>

			<p>[...] are already compressed, so re-compression won&#8217;t help and might hurt.) If you&#8217;re using Coda Hale&#8217;s configuration for Apache and Mongrel (and many of us are) the code for compressing text components before download is already in your [...]</p>

		</li>

	
	
		<li class="alt " id="comment-38590">
    <a href='http://betweengo.com/ruby-on-rails/2008/03/28/configuring-capistrano-and-mongrel/' title='Visit betweenGo &raquo; Configuring Capistrano and Mongrel'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://betweengo.com/ruby-on-rails/2008/03/28/configuring-capistrano-and-mongrel/' rel='external nofollow' class='url'>betweenGo &raquo; Configuring Capistrano and Mongrel</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-38590" title="">March 28th, 2008 at 5:08pm</a> </small>

			<p>[...] Time For A Grown-Up Server: Rails, Mongrel, Apache, Capistrano and You [...]</p>

		</li>

	
	
		<li class=" " id="comment-39129">
    <a href='http://betweengo.com/ruby-on-rails/2008/03/31/configuring-apache-to-work-with-a-mongrel-cluster/' title='Visit betweenGo &raquo; Configuring Apache to work with a Mongrel Cluster'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://betweengo.com/ruby-on-rails/2008/03/31/configuring-apache-to-work-with-a-mongrel-cluster/' rel='external nofollow' class='url'>betweenGo &raquo; Configuring Apache to work with a Mongrel Cluster</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-39129" title="">March 31st, 2008 at 4:38pm</a> </small>

			<p>[...] Time For A Grown-Up Server: Rails, Mongrel, Apache, Capistrano and You [...]</p>

		</li>

	
	
		<li class="alt " id="comment-41446">
    <a href='http://simpson.mine.nu/?p=631' title='Visit Zone of Mr. Frosti &raquo; Blog Archive &raquo; How to setup a Hoard of Mongrels'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://simpson.mine.nu/?p=631' rel='external nofollow' class='url'>Zone of Mr. Frosti &raquo; Blog Archive &raquo; How to setup a Hoard of Mongrels</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-41446" title="">April 6th, 2008 at 8:08pm</a> </small>

			<p>[...] there isn&#8217;t much on the subject floating around out there. Problem #2 is what I did find was geared towards Capistrano (another layer of complexity I was hoping to avoid). Problem #3 is this seems to be even [...]</p>

		</li>

	
	
		<li class=" " id="comment-41849">
    <a href='http://james.newwebnews.com/controltimefromserver.html' title='Visit control time from server'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://james.newwebnews.com/controltimefromserver.html' rel='external nofollow' class='url'>control time from server</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-41849" title="">April 7th, 2008 at 9:22pm</a> </small>

			<p>[...]  [...]</p>

		</li>

	
	
		<li class="alt " id="comment-46985">
    <a href='http://yellosoft.us/' title='Visit Andrew Pennebaker'><img src='http://www.gravatar.com/avatar.php?gravatar_id=dfe88469b75efc87cbcbbbc2a975850a&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://yellosoft.us/' rel='external nofollow' class='url'>Andrew Pennebaker</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-46985" title="">April 23rd, 2008 at 7:07pm</a> </small>

			<p>Can you help me with a Ruby question? I&#8217;m not sure if it&#8217;s Ruby&#8217;s fault or Ubuntu&#8217;s fault, but I&#8217;m getting an error following your directions.</p>
<p>sudo gem install daemons gem_plugin mongrel mongrel_cluster &#8211;include-dependencies<br />
Need to update 1 gems from <a href="http://gems.rubyforge.org" rel="nofollow">http://gems.rubyforge.org</a><br />
.<br />
complete<br />
ERROR:  While executing gem &#8230; (Errno::EROFS)<br />
    Read-only file system - /var/lib/gems/1.8/source_cache</p>
<p>Upon subsequent attempts to install daemons or mongrel_cluster, I get the error:</p>
<p>sudo gem install mongrel_cluster &#8211;include-dependencies<br />
ERROR:  While executing gem &#8230; (Errno::EROFS)<br />
    Read-only file system - /root/.gem</p>

		</li>

	
	
		<li class=" " id="comment-47851">
    <a href='http://pezra.barelyenough.org/blog/2008/04/mod_proxy_balancer-is-a-two-timing-hussy/' title='Visit Peter Williams - mod_proxy_balancer Is A Two Timing Hussy'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://pezra.barelyenough.org/blog/2008/04/mod_proxy_balancer-is-a-two-timing-hussy/' rel='external nofollow' class='url'>Peter Williams - mod_proxy_balancer Is A Two Timing Hussy</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-47851" title="">April 28th, 2008 at 6:01am</a> </small>

			<p>[...] see what I mean lets start with what Google suggests. The reverse proxying gets setup something like [...]</p>

		</li>

	
	
		<li class="alt " id="comment-51413">
    <a href='http://nothing' title='Visit harbans'><img src='http://www.gravatar.com/avatar.php?gravatar_id=74603d94b60fe314cdf544fea649b745&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://nothing' rel='external nofollow' class='url'>harbans</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-51413" title="">May 7th, 2008 at 4:00am</a> </small>

			<p>hello friends, iam looking for an answer of my question regarding deploying of ror app on different servers. Question is that : can we deploy our app on different servers without using capistrano? How much work and what type of work have to be done to deploy such app?<br />
i will be thankful to you.</p>

		</li>

	
	
		<li class=" " id="comment-51638">
    <a href='http://nothing' title='Visit harbans'><img src='http://www.gravatar.com/avatar.php?gravatar_id=74603d94b60fe314cdf544fea649b745&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://nothing' rel='external nofollow' class='url'>harbans</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-51638" title="">May 8th, 2008 at 2:05am</a> </small>

			<p>Hello ,</p>
<p>My previous seminar went well. Now I have an another query, if you help me in this also.<br />
As there is a concept of remoting in .net,<br />
is this possible to deploy the components in ROR and to make these components communicate with each other as done in remoting concept?<br />
Is this possible in ROR?<br />
Please guide me.</p>
<p>Thanks<br />
Harbans</p>

		</li>

	
	
		<li class="alt " id="comment-55324">
    <a href='http://www.babbleon.co.uk/2008/05/passenger-mod_rails-vs-apachemongrel/' title='Visit Babble On &raquo; Blog Archive &raquo; Passenger (mod_rails) vs Apache/Mongrel'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://www.babbleon.co.uk/2008/05/passenger-mod_rails-vs-apachemongrel/' rel='external nofollow' class='url'>Babble On &raquo; Blog Archive &raquo; Passenger (mod_rails) vs Apache/Mongrel</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-55324" title="">May 24th, 2008 at 8:41am</a> </small>

			<p>[...] been a long time advocate of the Apache/Mongrel Rails ever since Coda Hale blessed us with it some time ago, I&#8217;ve not since paid a huge amount of attention to the alternative Rails [...]</p>

		</li>

	
	
		<li class=" " id="comment-55940">
    <a href='http://aikidev.com/blog/?p=11' title='Visit Aikidev.com &raquo; Amazon EC2 - Configuring web server'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://aikidev.com/blog/?p=11' rel='external nofollow' class='url'>Aikidev.com &raquo; Amazon EC2 - Configuring web server</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-55940" title="">May 27th, 2008 at 9:33am</a> </small>

			<p>[...] this blog post for information on configuring [...]</p>

		</li>

	
	
		<li class="alt " id="comment-56544">
    <a href='http://thebalance.metautonomo.us/2008/05/30/the-local_request-that-isnt/' title='Visit thebalance &raquo; Blog Archive &raquo; The local_request That Isn&#8217;t'><img src='http://www.gravatar.com/avatar.php?gravatar_id=d41d8cd98f00b204e9800998ecf8427e&amp;rating=R&amp;size=40&amp;default=http://blog.codahale.com/wp-content/gravatars/blank_gravatar.png' alt='' class='gravatar' width='40' height='40' /></a>
			<cite><a href='http://thebalance.metautonomo.us/2008/05/30/the-local_request-that-isnt/' rel='external nofollow' class='url'>thebalance &raquo; Blog Archive &raquo; The local_request That Isn&#8217;t</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-56544" title="">May 30th, 2008 at 7:39am</a> </small>

			<p>[...] on the same server as your mongrel_cluster using a configuration similar to the one outlined here, then request.remote_addr will always be 127.0.0.1, because the request is really coming from your [...]</p>

		</li>

	
	
	</ol>

 


	
	</div>
	
		<div id="sidebar">

      <div class="sideitem">
      <h2>email me</h2>
      <p><strong><em>coda dot hale at gmail dot com</em></strong></p>
    </div>
    <div class="sideitem">
      <h2>search</h2>
      <form method="get" id="searchform" action="/index.php">
<div><input type="text" value="" name="s" id="s" />
<input type="submit" id="searchsubmit" value="Search" />
</div>
</form>    </div>
    <div class="sideitem">
      <h2>last few posts</h2>
      <ul class="posts">
              <li><a href="http://blog.codahale.com/2008/07/16/libxml-ruby-is-back/">libxml-ruby is back!</a></li>
              <li><a href="http://blog.codahale.com/2007/12/20/rake-vs-rspec-fight/">Rake vs. RSpec! Fight!</a></li>
              <li><a href="http://blog.codahale.com/2007/12/17/nilclass-devourer-of-errors/">NilClass, Devourer Of Errors</a></li>
              <li><a href="http://blog.codahale.com/2007/07/18/rails-plugin-easier-indexes/">Rails Plugin: easier-indexes</a></li>
              <li><a href="http://blog.codahale.com/2007/07/12/wesabe-api-vs-quicksilver/">Wesabe API vs. Quicksilver</a></li>
            </ul>
    </div>
<div class="sideitem">
      <h2>last few comments</h2>
      <ul class="comments">
<li><a href='http://www.bendalton.com/technology/twitter-quicksilver-sweet/' rel='external nofollow' class='url'>Twitter + Quicksilver = Sweet. | Thoughts and Ideas</a> on <a href="http://blog.codahale.com/2007/01/15/tweet-twitter-quicksilver/#comment-58807">Tweet = Twitter + Quicksilver</a></li><li>anne on <a href="http://blog.codahale.com/2007/01/15/tweet-twitter-quicksilver/#comment-57143">Tweet = Twitter + Quicksilver</a></li><li>johny b bad on <a href="http://blog.codahale.com/2006/11/07/pound-vs-pen-because-you-need-a-load-balancing-proxy/#comment-56594">Pound vs. Pen: Because You Need A Load-Balancing Proxy</a></li><li><a href='http://thebalance.metautonomo.us/2008/05/30/the-local_request-that-isnt/' rel='external nofollow' class='url'>thebalance &raquo; Blog Archive &raquo; The local_request That Isn&#8217;t</a> on <a href="http://blog.codahale.com/2006/06/19/time-for-a-grown-up-server-rails-mongrel-apache-capistrano-and-you/#comment-56544">Time For A Grown-Up Server: Rails, Mongrel, Apache, Capistrano and You</a></li><li><a href='http://aikidev.com/blog/?p=11' rel='external nofollow' class='url'>Aikidev.com &raquo; Amazon EC2 - Configuring web server</a> on <a href="http://blog.codahale.com/2006/06/19/time-for-a-grown-up-server-rails-mongrel-apache-capistrano-and-you/#comment-55940">Time For A Grown-Up Server: Rails, Mongrel, Apache, Capistrano and You</a></li></ul>
</div>
    <div class="sideitem">
      <h2>archives</h2>
      <div><table id="wp-calendar" summary="Calendar">
	<caption>June 2006</caption>
	<thead>
	<tr>
		<th abbr="Sunday" scope="col" title="Sunday">S</th>
		<th abbr="Monday" scope="col" title="Monday">M</th>
		<th abbr="Tuesday" scope="col" title="Tuesday">T</th>
		<th abbr="Wednesday" scope="col" title="Wednesday">W</th>
		<th abbr="Thursday" scope="col" title="Thursday">T</th>
		<th abbr="Friday" scope="col" title="Friday">F</th>
		<th abbr="Saturday" scope="col" title="Saturday">S</th>
	</tr>
	</thead>

	<tfoot>
	<tr>
		<td abbr="May" colspan="3" id="prev"><a href="http://blog.codahale.com/2006/05/" title="View posts for May 2006">&laquo; May</a></td>
		<td class="pad">&nbsp;</td>
		<td abbr="July" colspan="3" id="next"><a href="http://blog.codahale.com/2006/07/" title="View posts for July 2006">Jul &raquo;</a></td>
	</tr>
	</tfoot>

	<tbody>
	<tr>
		<td colspan="4" class="pad">&nbsp;</td><td>1</td><td><a href="http://blog.codahale.com/2006/06/02/" title="BloglinesReader v0.2">2</a></td><td>3</td>
	</tr>
	<tr>
		<td>4</td><td>5</td><td>6</td><td><a href="http://blog.codahale.com/2006/06/07/" title="Alive! It&#8217;s alive! It&#8217;s ALIVE!">7</a></td><td>8</td><td>9</td><td>10</td>
	</tr>
	<tr>
		<td>11</td><td>12</td><td>13</td><td>14</td><td>15</td><td>16</td><td>17</td>
	</tr>
	<tr>
		<td>18</td><td><a href="http://blog.codahale.com/2006/06/19/" title="Time For A Grown-Up Server: Rails, Mongrel, Apache, Capistrano and You">19</a></td><td>20</td><td>21</td><td>22</td><td>23</td><td><a href="http://blog.codahale.com/2006/06/24/" title="Ruby Quiz #84: Pascal&#8217;s Triangle">24</a></td>
	</tr>
	<tr>
		<td><a href="http://blog.codahale.com/2006/06/25/" title="Yay! My first accepted patch!">25</a></td><td>26</td><td>27</td><td>28</td><td>29</td><td><a href="http://blog.codahale.com/2006/06/30/" title="Charlie Stross writes too much">30</a></td>
		<td class="pad" colspan="1">&nbsp;</td>
	</tr>
	</tbody>
	</table></div>
      <ul class="archives">
        	<li><a href='http://blog.codahale.com/2008/07/' title='July 2008'>July 2008</a></li>
	<li><a href='http://blog.codahale.com/2007/12/' title='December 2007'>December 2007</a></li>
	<li><a href='http://blog.codahale.com/2007/07/' title='July 2007'>July 2007</a></li>
	<li><a href='http://blog.codahale.com/2007/06/' title='June 2007'>June 2007</a></li>
	<li><a href='http://blog.codahale.com/2007/05/' title='May 2007'>May 2007</a></li>
	<li><a href='http://blog.codahale.com/2007/04/' title='April 2007'>April 2007</a></li>
	<li><a href='http://blog.codahale.com/2007/03/' title='March 2007'>March 2007</a></li>
	<li><a href='http://blog.codahale.com/2007/02/' title='February 2007'>February 2007</a></li>
	<li><a href='http://blog.codahale.com/2007/01/' title='January 2007'>January 2007</a></li>
	<li><a href='http://blog.codahale.com/2006/12/' title='December 2006'>December 2006</a></li>
	<li><a href='http://blog.codahale.com/2006/11/' title='November 2006'>November 2006</a></li>
	<li><a href='http://blog.codahale.com/2006/08/' title='August 2006'>August 2006</a></li>
	<li><a href='http://blog.codahale.com/2006/07/' title='July 2006'>July 2006</a></li>
	<li><a href='http://blog.codahale.com/2006/06/' title='June 2006'>June 2006</a></li>
	<li><a href='http://blog.codahale.com/2006/05/' title='May 2006'>May 2006</a></li>
	<li><a href='http://blog.codahale.com/2006/04/' title='April 2006'>April 2006</a></li>
	<li><a href='http://blog.codahale.com/2006/03/' title='March 2006'>March 2006</a></li>
	<li><a href='http://blog.codahale.com/2006/02/' title='February 2006'>February 2006</a></li>
	<li><a href='http://blog.codahale.com/2006/01/' title='January 2006'>January 2006</a></li>
	<li><a href='http://blog.codahale.com/2005/12/' title='December 2005'>December 2005</a></li>
	<li><a href='http://blog.codahale.com/2005/11/' title='November 2005'>November 2005</a></li>
	<li><a href='http://blog.codahale.com/2005/10/' title='October 2005'>October 2005</a></li>
	<li><a href='http://blog.codahale.com/2005/09/' title='September 2005'>September 2005</a></li>
      </ul>
    </div>
    <div class="sideitem">
      <h2>categories</h2>
      <ul class="categories">
        	<li class="cat-item cat-item-6"><a href="http://blog.codahale.com/category/bicycles/" title="Everything to do with the two-wheeled wonders">Bicycles</a> (11)
</li>
	<li class="cat-item cat-item-1"><a href="http://blog.codahale.com/category/misc/" title="...and, like, stuff and things">Miscellany</a> (36)
</li>
	<li class="cat-item cat-item-3"><a href="http://blog.codahale.com/category/programming/" title="View all posts filed under Programming">Programming</a> (64)
<ul class='children'>
	<li class="cat-item cat-item-14"><a href="http://blog.codahale.com/category/programming/applescript/" title="Byzantine glue code for your Mac and mine.">Applescript</a> (3)
</li>
	<li class="cat-item cat-item-12"><a href="http://blog.codahale.com/category/programming/ruby-and-rails/" title="Regarding the wonderful language Ruby and its best friend, Rails">Ruby and Rails</a> (49)
	<ul class='children'>
	<li class="cat-item cat-item-13"><a href="http://blog.codahale.com/category/programming/ruby-and-rails/ruby-quiz/" title="My answers to the Ruby Quiz question of the week">Ruby Quiz</a> (1)
</li>
	</ul>
</li>
	<li class="cat-item cat-item-11"><a href="http://blog.codahale.com/category/programming/wordpress/" title="View all posts filed under WordPress">WordPress</a> (2)
</li>
</ul>
</li>
	<li class="cat-item cat-item-4"><a href="http://blog.codahale.com/category/web-design/" title="View all posts filed under Web Design">Web Design</a> (15)
</li>
      </ul>
    </div>
      </div>
 

  <div id="footer">
    <p>Copyright &copy; 2005-2006 Coda Hale.</p>




</body>
</html>